{"version":3,"sources":["webpack:///core.js","webpack:///webpack/bootstrap b7c3671963940b8dcca7","webpack:///./src/core/rxeditor-command-proxy.js","webpack:///./src/core/nodes/rxnode.js","webpack:///./src/core/nodes/text-node.js","webpack:///./src/core/rules/common-rule.js","webpack:///./src/basic/rxcomponent.js","webpack:///./src/core.js","webpack:///./src/shell/init-editor.js","webpack:///./src/core/rxeditor.js","webpack:///./src/core/canvas.js","webpack:///./src/core/node-view.js","webpack:///./src/core/node-state.js","webpack:///./src/core/canvas-state.js","webpack:///./src/core/commands.js","webpack:///./src/core/node-label.js","webpack:///./src/core/node-toolbar.js","webpack:///./src/core/rx-cursor.js","webpack:///./src/core/mouse-follower.js","webpack:///./src/core/mini-editbar.js","webpack:///./src/core/node-parser.js","webpack:///./src/core/nodes/class-node.js","webpack:///./src/core/nodes/char-node.js","webpack:///./src/core/nodes/tag-node.js","webpack:///./src/core/rules/index.js","webpack:///./src/core/rules/container.js","webpack:///./src/core/rules/row.js","webpack:///./src/core/rules/col.js","webpack:///./src/core/rules/heading.js","webpack:///./src/core/node.js","webpack:///./src/basic/rxarray.js","webpack:///./src/basic/object-state.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","100","__webpack_exports__","_classCallCheck","instance","Constructor","TypeError","RXEditorCommandProxy","_createClass","defineProperties","target","props","length","descriptor","writable","key","protoProps","staticProps","pageId","this","window","addEventListener","event","data","handleMessage","focusNode","node","sendMessage","id","ruleName","meta","defaultMeta","optionsSchema","rule","htmlCode","unFocusNode","document","canvasMouseMove","screenX","screenY","canUndo","canRedo","commandSchema","innerHTML","json","message","loadedData","serveForRXEditor","assembleWithTheme","theme","toolbox","treeViewNodes","dragFromToolbox","item","endDragFromToolbox","rxNameId","changeCanvasState","state","nodeChanged","undo","redo","clearCanvas","changeTheme","focusNodeFromShell","duplicateNodeFromShell","removeNodeFromShell","requestHtmlCode","loadHtml","html","setInlineFile","file","canvasHeight","body","scrollHeight","parent","postMessage","101","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","value","setPrototypeOf","__proto__","RXNode","__WEBPACK_IMPORTED_MODULE_0__node__","__WEBPACK_IMPORTED_MODULE_1__text_node__","_get","receiver","Function","desc","getOwnPropertyDescriptor","undefined","getPrototypeOf","copy","JSON","parse","stringify","label","labelToCapitalize","replace","toUpperCase","model","baseMetaToModel","tag","classList","push","apply","assign","styles","attributes","setField","className","attrName","children","forEach","child","isTextNode","charNodes","isCharState","render","textNode","isCharNode","prev","previousSbiling","TextNode","text","char","changeCharNodeToTextNode","Node","102","__WEBPACK_IMPORTED_MODULE_0__char_node__","seedId","idSeed","make","view","$dom","parentDom","getParentViewDomElement","appendChild","createTextNode","parentDomElement","mouseFollower","nodes","CharNode","103","dropInMargin","editable","editMarginStyle","paddingX","paddingY","empertyMargin","rejectChildren","18","RXComponent","__WEBPACK_IMPORTED_MODULE_0__rxarray__","elementName","style","attrs","domOns","eventName","callback","removeEventListener","unshift","add","contains","remove","cssClass","parentElement","createElement","styleName","parentNode","destory","removeChild","RXArray","dom","display","refence","insertBefore","345","creatEditorCore","initEditor","346","rxEditor","RXEditor","347","getDefaultLang","lang","navigator","language","userLanguage","substr","getLocal","local","zhLocal","enLocal","__WEBPACK_IMPORTED_MODULE_0__canvas__","__WEBPACK_IMPORTED_MODULE_1__canvas_state__","__WEBPACK_IMPORTED_MODULE_2__basic_rxarray__","__WEBPACK_IMPORTED_MODULE_3__commands__","__WEBPACK_IMPORTED_MODULE_4__node_label__","__WEBPACK_IMPORTED_MODULE_5__node_toolbar__","__WEBPACK_IMPORTED_MODULE_6__rx_cursor__","__WEBPACK_IMPORTED_MODULE_7__mouse_follower__","__WEBPACK_IMPORTED_MODULE_8__mini_editbar__","__WEBPACK_IMPORTED_MODULE_9__rxeditor_command_proxy__","__WEBPACK_IMPORTED_MODULE_10__node_parser__","$t","CanvasState","commandManager","CommadManager","onCommandsChanged","parentId","canvas","oldParentId","commandProxy","commandExcuted","optionClasses","activedLabel","NodeLabel","focusedLabel","domOn","focusedNode","begindragLabel","toolbar","NodeToolbar","cursor","RxCursor","MouseFollower","miniEditbar","MiniEditbar","nodeParser","NodeParser","workspace","getElementById","Canvas","rxeditorReady","dropElement","watch","tongleOnCondition","showOutline","refreshPosition","clearDraggedoverStates","clearActiveStates","clearFocusAndEditStates","allToNormalState","movingCommand","draggedNode","parseNode","startNew","beginFollowMouse","responsive","screenWidth","code","doDrop","finishMoving","endFollowMouse","clearCharNodes","position","draggedToFoused","command","adoptFromToolbox","moveInTop","finish","moveIn","moveBefore","moveAfter","isActived","followMouse","takeOverDraggingByWorkspace","active","hide","oldState","newState","focusState","normalState","getNodeHtml","div","renderHtml","showMarginX","showMarginY","showLabel","getNodeById","duplicate","deleteNode","generateHTML","loadNodeHtml","loadCanvasHtml","codeId","element","fileType","type","rel","getElementsByTagName","script","348","activeState","parentViewDomElement","padding","stateChanged","acceptedChildren","width","rootDiv","jsonArray","toJson","viewNodes","toTreeViewNode","349","NodeView","parentDoment","oldDom","doRender","replaceChild","previewDom","renderStylesAndClasses","showAttributes","domElement","bindEvents","on","attributeName","setAttribute","350","NormalState","DragoverState","ActiveState","FocusState","DisableState","DraggedState","EditState","PreviewState","NodeState","onMousemove","onBegindrag","onMouseover","onMouseout","onClick","enter","leave","addtionToModel","for","draggable","judgeCharNodePostion","margin","clientWidth","srcElement","clientHeight","offsetX","offsetY","ratioY","ratioX","canAccept","inTop","inLeft","CanDropState","doDragover","changeToState","judgePosition","show","changeTextnodeToCharNode","stopPropagation","preventDefault","startMove","contenteditable","startEditText","finishEditText","351","__WEBPACK_IMPORTED_MODULE_0__basic_object_state__","__screenWidth","__preview","__showMarginX","__showMarginY","__showOutline","__showLabel","distributeEvent","preview","ObjectState","352","CommandMovable","oldParent","oldnNextSbiling","nextSbiling","targetParent","storeNewInfo","brother","newParent","newNextSbiling","makeExcuteSchema","removeFromParent","pushChild","makeUndoSchema","CommandNew","_CommandMovable","nextSblilingId","nodeId","CommandMove","_CommandMovable2","CommandDelete","CommandClone","clone","CommandChangeNode","newMeta","oldMeta","CommandTextEdit","oldChildren","chilid","newChildren","CommandLoadCanvasHtml","newHtml","CommandClearCanvas","CommandLoadNodeHtml","newNode","undoCommands","redoCommands","cmd","startCommand","excute","finished","newNodeData","textCommand","submitChanged","pop","353","__WEBPACK_IMPORTED_MODULE_0__basic_rxcomponent__","domAttr","followElement","offset","rect","getBoundingClientRect","left","x","y","top","height","354","SvgButton","title","svg","_RXComponent","svgArrowUp","svgMove","svgEdit","svgClone","svgRemove","duplicateBtn","up","begindragIcon","editButton","el","getSelection","collapse","focus","delete","355","classClasses","inRight","inBottom","outTop","outRight","outBottom","outLeft","charLeft","charRight","right","bottom","356","clientX","clientY","357","__WEBPACK_IMPORTED_MODULE_1__basic_object_state__","EditorState","__bold","__italic","__underline","__strikeThrough","__isLink","_ObjectState","set","bold","italic","underline","strikeThrough","isLink","BarButton","toString","selection","rangeCount","getRangeAt","startContainer","tagName","endContainer","boldBtn","execCommand","updateButtonsState","setInnerHTML","italicBtn","underlineBtn","strikeBtn","linkBtn","onpaste","plainText","clipboardData","getData","keyCode","watchOne","stateName","btn","removeCssClass","isShow","queryCommandState","358","__WEBPACK_IMPORTED_MODULE_0__nodes_class_node_js__","__WEBPACK_IMPORTED_MODULE_1__nodes_tag_node_js__","__WEBPACK_IMPORTED_MODULE_2__nodes_text_node_js__","__WEBPACK_IMPORTED_MODULE_3__rules__","__WEBPACK_IMPORTED_MODULE_4__rules_common_rule__","childNodes","paraseNode","nodeType","textContent","ClassNode","clssNode","parseClassNode","parseTagNode","copyClassList","childNode","parseAttributes","markDefaultMeta","attrValue","toLowerCase","rules","classRules","classes","setLabel","elTag","tagRules","tags","TagNode","commonRule","from","to","indexOf","359","__WEBPACK_IMPORTED_MODULE_0__rxnode_js__","360","__WEBPACK_IMPORTED_MODULE_0__node_js__","onmousemove","mousemove","onmouseover","mouseover","onmouseout","mouseout","361","362","container","row","col","heading","363","364","acceptChildren","365","366","46","__WEBPACK_IMPORTED_MODULE_0__node_view__","__WEBPACK_IMPORTED_MODULE_1__basic_rxarray__","__WEBPACK_IMPORTED_MODULE_2__node_state__","initStates","begindrag","onclick","nodeStateChanged","dragoverState","draggedState","disableState","editState","previewState","concat","refreshState","toViewModel","toHtmlModel","first","after","before","unshiftChild","last","insertAfter","containsInAccepted","containsInExcept","childRuleName","stateModel","getStateName","childView","changeNode","5","array","splice","condition","99","envetHandlers","attribute","callbackFunction","console","assert","distributeEventWithoutGlobal","handlers","handler"],"mappings":"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","file":"core.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/dist/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 345);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ 100:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return RXEditorCommandProxy; });\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar RXEditorCommandProxy = function () {\n  function RXEditorCommandProxy(pageId) {\n    var _this = this;\n\n    _classCallCheck(this, RXEditorCommandProxy);\n\n    this.pageId = pageId;\n    window.addEventListener(\"message\", function (event) {\n      if (_this.pageId === event.data.pageId) {\n        _this.handleMessage(event.data);\n      }\n    });\n\n    this.focusNode = function (node, pageId) {\n      _this.sendMessage({\n        name: 'focusNode',\n        pageId: pageId,\n        node: {\n          id: node.id,\n          ruleName: node.ruleName,\n          meta: node.meta,\n          defaultMeta: node.defaultMeta,\n          optionsSchema: node.rule.optionsSchema,\n          htmlCode: node.htmlCode\n        }\n      });\n    };\n\n    this.unFocusNode = function (node) {\n      _this.sendMessage({\n        name: 'unFocusNode',\n        id: node.id\n      });\n    };\n\n    document.addEventListener('mouseup', function (event) {\n      _this.sendMessage({\n        name: 'canvasMouseup'\n      });\n    });\n\n    document.addEventListener('mousemove', function (event) {\n      _this.canvasMouseMove(event);\n    });\n  }\n\n  _createClass(RXEditorCommandProxy, [{\n    key: 'canvasMouseMove',\n    value: function canvasMouseMove(event) {\n      this.sendMessage({\n        name: 'canvasMouseMove',\n        event: {\n          screenX: event.screenX,\n          screenY: event.screenY\n        }\n      });\n    }\n  }, {\n    key: 'rxeditorReady',\n    value: function rxeditorReady() {\n      this.sendMessage({\n        name: 'rxeditorReady'\n      });\n    }\n  }, {\n    key: 'commandExcuted',\n    value: function commandExcuted(canUndo, canRedo, commandSchema) {\n      this.sendMessage({\n        name: 'commandExcuted',\n        canUndo: canUndo,\n        canRedo: canRedo,\n        commandSchema: commandSchema\n      });\n    }\n  }, {\n    key: 'takeOverDraggingByWorkspace',\n    value: function takeOverDraggingByWorkspace() {\n      this.sendMessage({\n        name: 'takeOverDraggingByWorkspace'\n      });\n    }\n  }, {\n    key: 'saveCodeFiles',\n    value: function saveCodeFiles(innerHTML, json) {\n      this.sendMessage({\n        name: 'saveCodeFiles',\n        innerHTML: innerHTML,\n        json: json\n      });\n    }\n  }, {\n    key: 'handleMessage',\n    value: function handleMessage(message) {\n      //console.log('received:' + message.name + \":\" + message.rxNameId)\n      switch (message.name) {\n        case 'requestAssemble':\n          var loadedData = this.serveForRXEditor.assembleWithTheme(message.theme);\n          this.sendMessage({\n            name: 'replyAssemble',\n            toolbox: loadedData.toolbox,\n            treeViewNodes: loadedData.treeViewNodes\n          });\n          break;\n        case 'draggingFromToolbox':\n          this.serveForRXEditor.dragFromToolbox(message.item);\n          break;\n        case 'endDragFromToolbox':\n          this.serveForRXEditor.endDragFromToolbox(message.rxNameId);\n          break;\n        case 'changeCanvasState':\n          this.serveForRXEditor.changeCanvasState(message.state);\n          break;\n        case 'nodeChanged':\n          this.serveForRXEditor.nodeChanged(message.node);\n          break;\n        case 'undo':\n          this.serveForRXEditor.undo();\n          break;\n        case 'redo':\n          this.serveForRXEditor.redo();\n          break;\n        //case 'download':\n        //  this.serveForRXEditor.download()\n        //  break;\n        case 'clearCanvas':\n          this.serveForRXEditor.clearCanvas();\n          break;\n        case 'changeTheme':\n          this.serveForRXEditor.changeTheme(message.theme);\n          break;\n        case 'focusNodeFromShell':\n          this.serveForRXEditor.focusNodeFromShell(message.node);\n          break;\n        case 'duplicateNodeFromShell':\n          this.serveForRXEditor.duplicateNodeFromShell(message.id);\n          break;\n        case 'removeNodeFromShell':\n          this.serveForRXEditor.removeNodeFromShell(message.id);\n          break;\n        case 'requestHtmlCode':\n          var htmlCode = this.serveForRXEditor.requestHtmlCode();\n          this.sendMessage({\n            name: 'replyHtmlCode',\n            htmlCode: htmlCode\n          });\n          break;\n        case 'loadHtml':\n          this.serveForRXEditor.loadHtml(message.html, message.id);\n          break;\n        case 'setInlineFile':\n          this.serveForRXEditor.setInlineFile(message.file);\n          break;\n      }\n    }\n  }, {\n    key: 'sendMessage',\n    value: function sendMessage(message) {\n      message.pageId = this.pageId;\n      message.canvasHeight = document.body.scrollHeight;\n      window.parent.postMessage(message, '/');\n    }\n  }]);\n\n  return RXEditorCommandProxy;\n}();\n\n/***/ }),\n\n/***/ 101:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return RXNode; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__node__ = __webpack_require__(46);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__text_node__ = __webpack_require__(102);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\nvar RXNode = function (_Node) {\n  _inherits(RXNode, _Node);\n\n  function RXNode() {\n    _classCallCheck(this, RXNode);\n\n    return _possibleConstructorReturn(this, (RXNode.__proto__ || Object.getPrototypeOf(RXNode)).call(this));\n  }\n\n  _createClass(RXNode, [{\n    key: \"clone\",\n    value: function clone() {\n      var copy = _get(RXNode.prototype.__proto__ || Object.getPrototypeOf(RXNode.prototype), \"clone\", this).call(this);\n      copy.meta = JSON.parse(JSON.stringify(this.meta));\n      copy.defaultMeta = JSON.parse(JSON.stringify(this.defaultMeta));\n      copy.label = this.label;\n\n      return copy;\n    }\n  }, {\n    key: \"setLabel\",\n    value: function setLabel(label) {\n      this.label = label;\n      this.labelToCapitalize();\n      return this;\n    }\n  }, {\n    key: \"labelToCapitalize\",\n    value: function labelToCapitalize() {\n      var label = this.label;\n      this.label = label.replace(label[0], label[0].toUpperCase());\n    }\n  }, {\n    key: \"toViewModel\",\n    value: function toViewModel() {\n      var model = _get(RXNode.prototype.__proto__ || Object.getPrototypeOf(RXNode.prototype), \"toViewModel\", this).call(this);\n      this.baseMetaToModel(model);\n\n      if (this.meta.innerHTML) {\n        model.innerHTML = this.meta.innerHTML;\n      }\n\n      return model;\n    }\n  }, {\n    key: \"toHtmlModel\",\n    value: function toHtmlModel() {\n      var model = _get(RXNode.prototype.__proto__ || Object.getPrototypeOf(RXNode.prototype), \"toHtmlModel\", this).call(this);\n      this.baseMetaToModel(model);\n      return model;\n    }\n  }, {\n    key: \"baseMetaToModel\",\n    value: function baseMetaToModel(model) {\n      var meta = this.meta;\n      model.tag = meta.tag;\n      model.innerHTML = meta.innerHTML;\n      model.classList.push.apply(model.classList, meta.classList);\n      Object.assign(model.styles, meta.styles);\n      Object.assign(model.attributes, meta.attributes);\n    }\n  }, {\n    key: \"setTag\",\n    value: function setTag(tag) {\n      return this.setField('tag', tag);\n    }\n  }, {\n    key: \"addClass\",\n    value: function addClass(className) {\n      if (!className) {\n        return this;\n      }\n      this.meta.classList.push(className);\n      return this;\n    }\n  }, {\n    key: \"setAttribute\",\n    value: function setAttribute(attrName, value) {\n      this.meta.attributes[attrName] = value;\n      return this;\n    }\n  }, {\n    key: \"changeTextnodeToCharNode\",\n    value: function changeTextnodeToCharNode() {\n      var _this2 = this;\n\n      var children = [];\n      this.children.forEach(function (child) {\n        if (child.isTextNode) {\n          children.push.apply(children, child.charNodes());\n          _this2.isCharState = true;\n        } else {\n          children.push(child);\n        }\n      });\n\n      this.children = children;\n      this.render();\n    }\n  }, {\n    key: \"changeCharNodeToTextNode\",\n    value: function changeCharNodeToTextNode() {\n      var _this3 = this;\n\n      var children = [];\n      var textNode = null;\n      this.children.forEach(function (child) {\n        if (child.isCharNode) {\n          var prev = child.previousSbiling();\n          if (!prev || !prev.isCharNode) {\n            textNode = new __WEBPACK_IMPORTED_MODULE_1__text_node__[\"a\" /* TextNode */]('');\n            textNode.parent = _this3;\n            children.push(textNode);\n          }\n\n          textNode.text += child.char;\n        } else {\n          children.push(child);\n        }\n      });\n      this.children = children;\n      this.render();\n      this.isCharState = false;\n    }\n  }, {\n    key: \"clearCharNodes\",\n    value: function clearCharNodes() {\n      if (this.isCharState) {\n        this.changeCharNodeToTextNode();\n      }\n      _get(RXNode.prototype.__proto__ || Object.getPrototypeOf(RXNode.prototype), \"clearCharNodes\", this).call(this);\n    }\n  }]);\n\n  return RXNode;\n}(__WEBPACK_IMPORTED_MODULE_0__node__[\"a\" /* Node */]);\n\n/***/ }),\n\n/***/ 102:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return TextNode; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__char_node__ = __webpack_require__(360);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\nvar TextNode = function () {\n  function TextNode(text) {\n    _classCallCheck(this, TextNode);\n\n    this.text = text;\n    this.seedId();\n    this.isTextNode = true;\n  }\n\n  _createClass(TextNode, [{\n    key: \"seedId\",\n    value: function seedId() {\n      if (!TextNode.idSeed) TextNode.idSeed = 1;\n      TextNode.idSeed++;\n      this.id = \"text\" + TextNode.idSeed;\n    }\n  }, {\n    key: \"make\",\n    value: function make() {\n      return new TextNode(this.text);\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      var copy = this.make();\n      return copy;\n    }\n  }, {\n    key: \"getParentViewDomElement\",\n    value: function getParentViewDomElement() {\n      return this.parent.view.$dom;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      //this.view.render(this.toViewModel(), this.getParentViewDomElement())\n      var parentDom = this.getParentViewDomElement();\n      if (parentDom) {\n        parentDom.appendChild(document.createTextNode(this.text));\n      }\n    }\n  }, {\n    key: \"renderHtml\",\n    value: function renderHtml(parentDomElement) {\n      if (parentDomElement) {\n        parentDomElement.appendChild(document.createTextNode(this.text));\n      }\n    }\n  }, {\n    key: \"renderMouseFollower\",\n    value: function renderMouseFollower(parentDomElement) {\n      var mouseFollower = document.createTextNode(this.text);\n      parentDomElement.appendChild(mouseFollower);\n      return mouseFollower;\n    }\n  }, {\n    key: \"preview\",\n    value: function preview() {}\n  }, {\n    key: \"nodeChanged\",\n    value: function nodeChanged() {}\n  }, {\n    key: \"refreshState\",\n    value: function refreshState() {}\n  }, {\n    key: \"clearDraggedoverStates\",\n    value: function clearDraggedoverStates() {}\n  }, {\n    key: \"clearActiveStates\",\n    value: function clearActiveStates() {}\n  }, {\n    key: \"clearFocusAndEditStates\",\n    value: function clearFocusAndEditStates() {}\n  }, {\n    key: \"clearCharNodes\",\n    value: function clearCharNodes() {}\n  }, {\n    key: \"draggedToFoused\",\n    value: function draggedToFoused() {}\n  }, {\n    key: \"focusNode\",\n    value: function focusNode() {}\n  }, {\n    key: \"allToNormalState\",\n    value: function allToNormalState() {}\n  }, {\n    key: \"toTreeViewNode\",\n    value: function toTreeViewNode() {\n      return null;\n    }\n  }, {\n    key: \"getNodeById\",\n    value: function getNodeById() {}\n  }, {\n    key: \"charNodes\",\n    value: function charNodes() {\n      var nodes = [];\n      for (var i = 0; i < this.text.length; i++) {\n        nodes.push(new __WEBPACK_IMPORTED_MODULE_0__char_node__[\"a\" /* CharNode */](this.text[i], this.parent));\n      }\n      return nodes;\n    }\n  }]);\n\n  return TextNode;\n}();\n\n/***/ }),\n\n/***/ 103:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  dropInMargin: 10,\n  editable: true,\n  editMarginStyle: {\n    paddingX: '10px',\n    paddingY: '10px'\n  },\n  //没有子元素，显示空白\n  empertyMargin: false,\n  rejectChildren: ['col', 'thead', 'tbody', 'th', 'tr', 'td']\n});\n\n/***/ }),\n\n/***/ 18:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return RXComponent; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__rxarray__ = __webpack_require__(5);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\nvar RXComponent = function () {\n  function RXComponent() {\n    var elementName = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'div';\n\n    _classCallCheck(this, RXComponent);\n\n    this.children = [];\n    this.classList = [];\n    this.style = {};\n    this.attrs = {};\n    this.domOns = {};\n    this.elementName = elementName;\n  }\n\n  _createClass(RXComponent, [{\n    key: 'on',\n    value: function on(eventName, callback) {\n      this[eventName] = callback;\n      return this;\n    }\n  }, {\n    key: 'off',\n    value: function off(eventName) {\n      delete this[eventName];\n      return this;\n    }\n  }, {\n    key: 'domOn',\n    value: function domOn(name, callback) {\n      if (this.$dom) {\n        this.$dom.addEventListener(name, callback);\n      }\n      this.domOns[name] = callback;\n      return this;\n    }\n  }, {\n    key: 'domOff',\n    value: function domOff(name, callback) {\n      if (this.$dom) {\n        this.$dom.removeEventListener(name, callback);\n      }\n      delete this.domOns[name];\n      return this;\n    }\n  }, {\n    key: 'pushChild',\n    value: function pushChild(child) {\n      this.children.push(child);\n      return this;\n    }\n  }, {\n    key: 'unshiftChild',\n    value: function unshiftChild(child) {\n      this.children.unshift(child);\n      return this;\n    }\n  }, {\n    key: 'cssClass',\n    value: function cssClass(className) {\n      Object(__WEBPACK_IMPORTED_MODULE_0__rxarray__[\"a\" /* add */])(className, this.classList);\n      if (this.$dom) {\n        this.$dom.classList.add(className);\n      }\n      return this;\n    }\n  }, {\n    key: 'removeCssClass',\n    value: function removeCssClass(className) {\n      if (Object(__WEBPACK_IMPORTED_MODULE_0__rxarray__[\"d\" /* contains */])(className, this.classList)) {\n        Object(__WEBPACK_IMPORTED_MODULE_0__rxarray__[\"i\" /* remove */])(className, this.classList);\n        if (this.$dom && this.$dom.classList.contains(className)) {\n          this.$dom.classList.remove(className);\n        }\n      }\n      return this;\n    }\n  }, {\n    key: 'cssStyle',\n    value: function cssStyle(name, value) {\n      this.style[name] = value;\n      return this;\n    }\n  }, {\n    key: 'removeCssStyle',\n    value: function removeCssStyle(name) {\n      delete this.style[name];\n    }\n  }, {\n    key: 'domAttr',\n    value: function domAttr(name, value) {\n      this.attrs[name] = value;\n      return this;\n    }\n  }, {\n    key: 'removeDomAttr',\n    value: function removeDomAttr(name) {\n      delete this.attrs[name];\n      return this;\n    }\n  }, {\n    key: 'tongle',\n    value: function tongle(cssClass) {\n      if (Object(__WEBPACK_IMPORTED_MODULE_0__rxarray__[\"d\" /* contains */])(cssClass, this.classList)) {\n        Object(__WEBPACK_IMPORTED_MODULE_0__rxarray__[\"i\" /* remove */])(cssClass, this.classList);\n        if (this.$dom) {\n          Object(__WEBPACK_IMPORTED_MODULE_0__rxarray__[\"i\" /* remove */])(cssClass, this.$dom.classList);\n        }\n      } else {\n        Object(__WEBPACK_IMPORTED_MODULE_0__rxarray__[\"a\" /* add */])(cssClass, this.classList);\n        if (this.$dom) {\n          Object(__WEBPACK_IMPORTED_MODULE_0__rxarray__[\"a\" /* add */])(cssClass, this.$dom.classList);\n        }\n      }\n    }\n    //setInnerHTML(innerHTML){\n    //  this.innerHTML = innerHTML\n    //  return this\n    //}\n\n  }, {\n    key: 'render',\n    value: function render(parentElement) {\n      var _this = this;\n\n      this.$dom = document.createElement(this.elementName);\n      parentElement.appendChild(this.$dom);\n\n      if (this.innerHTML) {\n        this.$dom.innerHTML = this.innerHTML;\n      }\n\n      for (var styleName in this.style) {\n        this.$dom.style[styleName] = this.style[styleName];\n      }\n\n      this.classList.forEach(function (className) {\n        _this.$dom.classList.add(className);\n      });\n\n      for (var attrName in this.attrs) {\n        this.$dom[attrName] = this.attrs[attrName];\n      }\n\n      for (var eventName in this.domOns) {\n        this.$dom.addEventListener(eventName, this.domOns[eventName]);\n      }\n\n      this.children.forEach(function (child) {\n        child.render(_this.$dom);\n      });\n      return this;\n    }\n  }, {\n    key: 'refresh',\n    value: function refresh() {\n      if (this.$dom) {\n        var parentDomElement = this.$dom.parentNode;\n        this.destory();\n        this.render(parentDomElement);\n      }\n    }\n  }, {\n    key: 'setInnerHTML',\n    value: function setInnerHTML(innerHTML) {\n      this.innerHTML = innerHTML;\n      if (this.$dom) {\n        this.$dom.innerHTML = innerHTML;\n      }\n      return this;\n    }\n  }, {\n    key: 'destory',\n    value: function destory() {\n      this.$dom.parentNode.removeChild(this.$dom);\n      this.$dom = '';\n    }\n  }, {\n    key: 'removeChild',\n    value: function removeChild(node) {\n      Object(__WEBPACK_IMPORTED_MODULE_0__rxarray__[\"i\" /* remove */])(node, this.children);\n      if (this.$dom && node.$dom && this.$dom.contains(node.$dom)) {\n        this.$dom.removeChild(node.$dom);\n      }\n    }\n  }, {\n    key: 'clearChild',\n    value: function clearChild() {\n      this.children = new RXArray();\n    }\n  }, {\n    key: 'classClasses',\n    value: function classClasses() {\n      var dom = this.$dom;\n      if (dom) {\n        this.classList.forEach(function (cssClass) {\n          //console.log(cssClass)\n          dom.classList.remove(cssClass);\n        });\n      }\n      this.classList.length = 0;\n    }\n  }, {\n    key: 'show',\n    value: function show() {\n      this.style.display = 'flex';\n      if (this.$dom) {\n        this.$dom.style.display = 'flex';\n      }\n      return this;\n    }\n  }, {\n    key: 'isShow',\n    value: function isShow() {\n      return this.style.display !== 'none';\n    }\n  }, {\n    key: 'hide',\n    value: function hide() {\n      this.style.display = 'none';\n      if (this.$dom) {\n        this.$dom.style.display = 'none';\n      }\n      return this;\n    }\n  }, {\n    key: 'insertBefore',\n    value: function insertBefore(child, refence) {\n      Object(__WEBPACK_IMPORTED_MODULE_0__rxarray__[\"g\" /* insertBefore */])(child, refence, this.children);\n    }\n  }]);\n\n  return RXComponent;\n}();\n\n/***/ }),\n\n/***/ 345:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__shell_init_editor__ = __webpack_require__(346);\n\n\nwindow.creatEditorCore = function (pageId) {\n  Object(__WEBPACK_IMPORTED_MODULE_0__shell_init_editor__[\"a\" /* default */])(pageId);\n};\n\n/***/ }),\n\n/***/ 346:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = initEditor;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__core_rxeditor__ = __webpack_require__(347);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_rxeditor_command_proxy__ = __webpack_require__(100);\n\n\n//import loadElements from \"../elements/load-elements\"\n\nfunction initEditor(pageId) {\n  window.rxEditor = new __WEBPACK_IMPORTED_MODULE_0__core_rxeditor__[\"a\" /* RXEditor */](pageId);\n  window.RXEditorCommandProxy = __WEBPACK_IMPORTED_MODULE_1__core_rxeditor_command_proxy__[\"a\" /* RXEditorCommandProxy */];\n}\n\n/***/ }),\n\n/***/ 347:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return RXEditor; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__canvas__ = __webpack_require__(348);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__canvas_state__ = __webpack_require__(351);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__basic_rxarray__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__commands__ = __webpack_require__(352);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__node_label__ = __webpack_require__(353);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__node_toolbar__ = __webpack_require__(354);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__rx_cursor__ = __webpack_require__(355);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__mouse_follower__ = __webpack_require__(356);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__mini_editbar__ = __webpack_require__(357);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__rxeditor_command_proxy__ = __webpack_require__(100);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__node_parser__ = __webpack_require__(358);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction getDefaultLang() {\n  var lang = navigator.language || navigator.userLanguage;\n  lang = lang.substr(0, 2);\n  //目前只实现两个语言版本\n  if (lang !== 'zh') {\n    lang = 'en';\n  }\n  return lang;\n}\n\nvar enLocal = {\n  \"focus-parent\": \"Focus Parent\",\n  \"move\": \"Move\",\n  \"edit\": \"Edit\",\n  \"duplicate\": \"Duplicate\",\n  \"delete\": \"Delete\",\n  \"can-be-draged\": \"Can be draged\"\n};\n\nvar zhLocal = {\n  \"focus-parent\": \"选中父节点\",\n  \"move\": \"拖动\",\n  \"edit\": \"编辑\",\n  \"duplicate\": \"克隆\",\n  \"delete\": \"删除\",\n  \"can-be-draged\": \"可以拖动\"\n};\n\nfunction getLocal(id) {\n  var local = getDefaultLang() === 'zh' ? zhLocal : enLocal;\n  return local[id] ? local[id] : id;\n}\n\nvar RXEditor = function () {\n  function RXEditor(pageId) {\n    var _this = this;\n\n    _classCallCheck(this, RXEditor);\n\n    this.pageId = pageId;\n    window.$t = getLocal;\n    this.state = new __WEBPACK_IMPORTED_MODULE_1__canvas_state__[\"a\" /* CanvasState */]();\n    this.commandManager = new __WEBPACK_IMPORTED_MODULE_3__commands__[\"a\" /* CommadManager */]();\n    this.commandManager.onCommandsChanged = function (canUndo, canRedo, commandSchema) {\n      if (!commandSchema) return;\n      if (commandSchema.parentId === _this.canvas.id) {\n        commandSchema.parentId = '';\n      }\n      if (commandSchema.oldParentId === _this.canvas.id) {\n        commandSchema.oldParentId = '';\n      }\n      _this.commandProxy.commandExcuted(canUndo, canRedo, commandSchema);\n    };\n    this.optionClasses = [];\n    Object(__WEBPACK_IMPORTED_MODULE_2__basic_rxarray__[\"a\" /* add */])('rx-_-show-outline', this.optionClasses);\n    //this.optionClasses.add('show-label')\n    this.activedLabel = new __WEBPACK_IMPORTED_MODULE_4__node_label__[\"a\" /* NodeLabel */]();\n    this.focusedLabel = new __WEBPACK_IMPORTED_MODULE_4__node_label__[\"a\" /* NodeLabel */]();\n    this.focusedLabel.cssClass('focused');\n    this.focusedLabel.domOn('mousedown', function (event) {\n      if (rxEditor.focusedNode) {\n        rxEditor.focusedNode.begindragLabel(event);\n      }\n    });\n\n    this.toolbar = new __WEBPACK_IMPORTED_MODULE_5__node_toolbar__[\"a\" /* NodeToolbar */]();\n    this.cursor = new __WEBPACK_IMPORTED_MODULE_6__rx_cursor__[\"a\" /* RxCursor */]();\n    this.mouseFollower = new __WEBPACK_IMPORTED_MODULE_7__mouse_follower__[\"a\" /* MouseFollower */]();\n    this.miniEditbar = new __WEBPACK_IMPORTED_MODULE_8__mini_editbar__[\"a\" /* MiniEditbar */]();\n    this.nodeParser = new __WEBPACK_IMPORTED_MODULE_10__node_parser__[\"a\" /* NodeParser */]();\n  }\n\n  _createClass(RXEditor, [{\n    key: \"hangOn\",\n    value: function hangOn(id) {\n      var _this2 = this;\n\n      var commandProxy = new __WEBPACK_IMPORTED_MODULE_9__rxeditor_command_proxy__[\"a\" /* RXEditorCommandProxy */](this.pageId);\n      this.workspace = document.getElementById(id);\n      this.activedLabel.render(this.workspace);\n      this.focusedLabel.render(this.workspace);\n      this.toolbar.render(this.workspace);\n      this.cursor.render(this.workspace);\n      this.mouseFollower.render(this.workspace);\n      this.miniEditbar.render(this.workspace);\n      this.canvas = new __WEBPACK_IMPORTED_MODULE_0__canvas__[\"a\" /* Canvas */](this.workspace);\n      //this.canvas.children = this.load()\n      this.canvas.render();\n      commandProxy.serveForRXEditor = this;\n      this.commandProxy = commandProxy;\n\n      this.commandProxy.rxeditorReady();\n      document.addEventListener('mouseup', function (event) {\n        _this2.dropElement(event);\n      });\n\n      this.state.watch('changed', function (state) {\n        //this.allToNormalState()\n      });\n      this.state.watch('showOutline', function (state) {\n        Object(__WEBPACK_IMPORTED_MODULE_2__basic_rxarray__[\"j\" /* tongleOnCondition */])(state.showOutline, 'rx-_-show-outline', _this2.optionClasses);\n        _this2.render();\n      });\n      this.state.watch('showMarginX', function (state) {\n        _this2.render();\n      });\n      this.state.watch('showMarginY', function (state) {\n        _this2.render();\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      this.canvas.render();\n      this.toolbar.refreshPosition();\n      this.focusedLabel.refreshPosition();\n    }\n  }, {\n    key: \"clearDraggedoverStates\",\n    value: function clearDraggedoverStates() {\n      this.canvas.clearDraggedoverStates();\n    }\n  }, {\n    key: \"clearActiveStates\",\n    value: function clearActiveStates() {\n      this.canvas.clearActiveStates();\n    }\n  }, {\n    key: \"clearFocusAndEditStates\",\n    value: function clearFocusAndEditStates() {\n      this.canvas.clearFocusAndEditStates();\n    }\n  }, {\n    key: \"allToNormalState\",\n    value: function allToNormalState() {\n      this.canvas.allToNormalState();\n    }\n  }, {\n    key: \"dragFromToolbox\",\n    value: function dragFromToolbox(item) {\n      if (this.commandManager.movingCommand) return;\n      this.clearFocusAndEditStates();\n      var draggedNode = this.parseNode(item);\n      this.commandManager.startNew(draggedNode);\n      this.beginFollowMouse();\n      //this.clearFocusAndEditStates()\n    }\n  }, {\n    key: \"parseNode\",\n    value: function parseNode(item) {\n      var responsive = this.state.screenWidth;\n      return this.nodeParser.parse(item.code.replace('--responsive--', responsive == 'xs' ? '' : '-' + responsive))[0];\n      //return new BSContainer\n    }\n  }, {\n    key: \"dropElement\",\n    value: function dropElement(event) {\n      //this.clearDraggedoverStates()\n      this.doDrop(event);\n      this.commandManager.finishMoving();\n      this.endFollowMouse();\n      this.canvas.clearCharNodes();\n    }\n  }, {\n    key: \"doDrop\",\n    value: function doDrop(event) {\n      var position = this.cursor.position;\n      var node = this.cursor.node;\n      if (!node) {\n        this.canvas.draggedToFoused();\n        return;\n      }\n      this.canvas.clearFocusAndEditStates();\n      var command = this.commandManager.movingCommand;\n      if (command) {\n        if (position === 'in-left' || position === 'in-top') {\n          command.adoptFromToolbox(node);\n          command.moveInTop(node);\n          command.finish();\n        } else if (position === 'in-right' || position === 'in-bottom') {\n          command.adoptFromToolbox(node);\n          command.moveIn(node);\n          command.finish();\n        } else if (position === 'out-left' || position === 'out-top' || position === 'char-left') {\n          command.adoptFromToolbox(node);\n          command.moveBefore(node);\n          command.finish();\n        } else if (position === 'out-right' || position === 'out-bottom' || position === 'char-right') {\n          command.adoptFromToolbox(node);\n          command.moveAfter(node);\n          command.finish();\n        }\n      }\n    }\n  }, {\n    key: \"endDragFromToolbox\",\n    value: function endDragFromToolbox() {\n      this.commandManager.finishMoving();\n      this.endFollowMouse();\n    }\n  }, {\n    key: \"followMouse\",\n    value: function followMouse(event) {\n      var mouseFollower = this.mouseFollower;\n      if (mouseFollower.isActived) {\n        //mouseFollower.$dom.style.left =  this.followX(event)\n        //mouseFollower.$dom.style.top = this.followY(event)\n        this.mouseFollower.followMouse(event);\n        this.commandProxy.takeOverDraggingByWorkspace();\n      }\n    }\n  }, {\n    key: \"beginFollowMouse\",\n    value: function beginFollowMouse() {\n      if (this.commandManager.movingCommand) {\n        var draggedNode = this.commandManager.movingCommand.node;\n        this.mouseFollower.active(draggedNode.label);\n      }\n    }\n  }, {\n    key: \"endFollowMouse\",\n    value: function endFollowMouse() {\n      //if(this.mouseFollower && this.workspace.contains(this.mouseFollower.$dom)){\n      //  this.workspace.removeChild(this.mouseFollower.$dom)\n      //}\n      this.cursor.hide();\n      this.mouseFollower.hide();\n    }\n  }, {\n    key: \"nodeStateChanged\",\n    value: function nodeStateChanged(node, oldState, newState) {\n      if (newState === node.focusState && node.focusState !== node.normalState) {\n        node.htmlCode = this.getNodeHtml(node);\n        this.commandProxy.focusNode(node, this.pageId);\n      }\n      if (oldState === node.focusState && newState !== node.focusState) {\n        this.commandProxy.unFocusNode(node);\n      }\n    }\n  }, {\n    key: \"getNodeHtml\",\n    value: function getNodeHtml(node) {\n      var div = document.createElement('div');\n      node.renderHtml(div);\n      return div.innerHTML;\n    }\n  }, {\n    key: \"changeCanvasState\",\n    value: function changeCanvasState(state) {\n      this.state.screenWidth = state.screenWidth;\n      //this.state.preview = state.preview\n      //this.state.showEditMargin = state.showEditMargin\n      this.state.showMarginX = state.showMarginX;\n      this.state.showMarginY = state.showMarginY;\n      this.state.showOutline = state.showOutline;\n      this.state.showLabel = state.showLabel;\n    }\n  }, {\n    key: \"nodeChanged\",\n    value: function nodeChanged(node) {\n      //console.log(node)\n      this.canvas.nodeChanged(node);\n      this.render();\n    }\n  }, {\n    key: \"undo\",\n    value: function undo() {\n      this.allToNormalState();\n      this.commandManager.undo();\n      this.render();\n    }\n  }, {\n    key: \"redo\",\n    value: function redo() {\n      this.allToNormalState();\n      this.commandManager.redo();\n      this.render();\n    }\n\n    //download(){\n    //  let innerHTML = this.canvas.generateHTML()\n    //  let json = this.canvas.generateJson()\n    //  this.commandProxy.saveCodeFiles(innerHTML, json)\n    //  this.render()\n    //}\n\n  }, {\n    key: \"clearCanvas\",\n    value: function clearCanvas() {\n      this.commandManager.clearCanvas();\n      this.activedLabel.hide();\n      this.focusedLabel.hide();\n      this.toolbar.hide();\n      this.render();\n    }\n  }, {\n    key: \"focusNodeFromShell\",\n    value: function focusNodeFromShell(node) {\n      this.canvas.clearFocusAndEditStates();\n      this.canvas.focusNode(node);\n    }\n  }, {\n    key: \"duplicateNodeFromShell\",\n    value: function duplicateNodeFromShell(id) {\n      this.canvas.clearFocusAndEditStates();\n      var node = this.canvas.getNodeById(id);\n      this.commandManager.duplicate(node);\n    }\n  }, {\n    key: \"removeNodeFromShell\",\n    value: function removeNodeFromShell(id) {\n      this.canvas.clearFocusAndEditStates();\n      var node = this.canvas.getNodeById(id);\n      this.commandManager.deleteNode(node);\n    }\n  }, {\n    key: \"canvasMouseMove\",\n    value: function canvasMouseMove(event) {\n      this.commandProxy.canvasMouseMove(event);\n    }\n  }, {\n    key: \"requestHtmlCode\",\n    value: function requestHtmlCode() {\n      this.allToNormalState();\n      return this.canvas.generateHTML();\n    }\n  }, {\n    key: \"loadHtml\",\n    value: function loadHtml(html, id) {\n      var node = this.canvas.getNodeById(id);\n      if (node) {\n        this.commandManager.loadNodeHtml(node, html);\n      } else {\n        this.commandManager.loadCanvasHtml(html);\n      }\n\n      this.render();\n    }\n  }, {\n    key: \"setInlineFile\",\n    value: function setInlineFile(file) {\n      var codeId = file.name.replace('.', '-');\n      var element = document.getElementById(codeId);\n      if (element) {\n        element.innerHTML = file.code;\n        return;\n      }\n\n      if (file.fileType === 'style') {\n        var style = document.createElement('style');\n        style.type = 'text/css';\n        style.rel = 'stylesheet';\n        style.id = codeId;\n\n        style.appendChild(document.createTextNode(file.code));\n\n        var head = document.getElementsByTagName('head')[0];\n        head.appendChild(style);\n      }\n\n      if (file.fileType === 'javascript') {\n        var script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.id = codeId;\n        script.appendChild(document.createTextNode(file.code));\n        document.body.appendChild(script);\n      }\n    }\n  }]);\n\n  return RXEditor;\n}();\n\n/***/ }),\n\n/***/ 348:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Canvas; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__node__ = __webpack_require__(46);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\nvar Canvas = function (_Node) {\n  _inherits(Canvas, _Node);\n\n  function Canvas(workspace) {\n    _classCallCheck(this, Canvas);\n\n    var _this = _possibleConstructorReturn(this, (Canvas.__proto__ || Object.getPrototypeOf(Canvas)).call(this));\n\n    _this.activeState = _this.normalState;\n    _this.focusState = _this.normalState;\n    _this.parentViewDomElement = workspace;\n    _this.padding = '30px';\n\n    _this.stateChanged = function (oldState, newState) {};\n\n    _this.rule = { dropInMargin: 0 };\n    _this.rule.acceptedChildren = '';\n    _this.rule.rejectChildren = ['col', 'thead', 'tbody', 'th', 'tr', 'td'];\n    return _this;\n  }\n\n  _createClass(Canvas, [{\n    key: 'getParentViewDomElement',\n    value: function getParentViewDomElement() {\n      return this.parentViewDomElement;\n    }\n\n    /*preview(parentDomElement){\n      if(parentDomElement.contains(this.view.$dom)){\n        parentDomElement.removeChild(this.view.$dom)\n      }\n      return super.preview(parentDomElement)\n    }*/\n\n  }, {\n    key: 'toViewModel',\n    value: function toViewModel() {\n      var model = _get(Canvas.prototype.__proto__ || Object.getPrototypeOf(Canvas.prototype), 'toViewModel', this).call(this);\n      model.tag = 'div';\n      model.styles.width = \"100%\";\n      model.styles['min-height'] = \"calc(100vh)\";\n      model.styles.cursor = 'default';\n      model.styles['border'] = '0';\n      model.styles['padding'] = '10px';\n      model.classList.push('canvas');\n      model.toolbar = '';\n      model.label = '';\n      return model;\n    }\n  }, {\n    key: 'toPreviewModel',\n    value: function toPreviewModel() {\n      var model = _get(Canvas.prototype.__proto__ || Object.getPrototypeOf(Canvas.prototype), 'toPreviewModel', this).call(this);\n      model.tag = 'div';\n      return model;\n    }\n  }, {\n    key: 'generateHTML',\n    value: function generateHTML() {\n      var rootDiv = document.createElement('div');\n      this.children.forEach(function (child) {\n        child.renderHtml(rootDiv);\n      });\n      return rootDiv.innerHTML;\n    }\n  }, {\n    key: 'generateJson',\n    value: function generateJson() {\n      var jsonArray = [];\n      this.children.forEach(function (child) {\n        jsonArray.push(child.toJson());\n      });\n      return jsonArray;\n    }\n  }, {\n    key: 'generateTreeViewNodes',\n    value: function generateTreeViewNodes() {\n      var viewNodes = [];\n      this.children.forEach(function (child) {\n        viewNodes.push(child.toTreeViewNode());\n      });\n      return viewNodes;\n    }\n  }]);\n\n  return Canvas;\n}(__WEBPACK_IMPORTED_MODULE_0__node__[\"a\" /* Node */]);\n\n/***/ }),\n\n/***/ 349:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return NodeView; });\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar NodeView = function () {\n  function NodeView() {\n    _classCallCheck(this, NodeView);\n  }\n\n  _createClass(NodeView, [{\n    key: 'render',\n    value: function render(model, parentDoment) {\n      this.parentDoment = parentDoment;\n      //this.putDown(parentDoment)//防止canvas内节点重复添加\n      var oldDom = this.$dom;\n\n      this.$dom = document.createElement(model.tag);\n      this.doRender(model, parentDoment, this.$dom);\n      if (parentDoment.contains(oldDom)) {\n        parentDoment.replaceChild(this.$dom, oldDom);\n      } else {\n        parentDoment.appendChild(this.$dom);\n      }\n    }\n  }, {\n    key: 'renderHtml',\n    value: function renderHtml(model, parentDoment) {\n      //this.putDown(parentDoment)//防止canvas内节点重复添加\n      var previewDom = document.createElement(model.tag);\n      this.doRender(model, parentDoment, previewDom);\n      return previewDom;\n    }\n  }, {\n    key: 'refreshState',\n    value: function refreshState(model) {\n      if (this.$dom) {\n        //let y = this.$dom.getBoundingClientRect().y\n        this.$dom.classList.remove('rx-_-mouse-overed', 'rx-_-focused', 'rx-_-dragged', 'rx-_-dragover', 'rx-_-editing');\n        this.renderStylesAndClasses(model, this.$dom);\n        this.showAttributes(model, this.$dom);\n      }\n    }\n  }, {\n    key: 'doRender',\n    value: function doRender(model, parentDoment, domElement) {\n      domElement.innerHTML = model.innerHTML ? model.innerHTML : '';\n      this.renderStylesAndClasses(model, domElement);\n      this.bindEvents(domElement, model.on);\n      this.showAttributes(model, domElement);\n      //parentDoment.appendChild(domElement);\n    }\n  }, {\n    key: 'renderStylesAndClasses',\n    value: function renderStylesAndClasses(model, domElement) {\n      if (domElement) {\n        if (model.styles) {\n          for (var styleName in model.styles) {\n            domElement.style[styleName] = model.styles[styleName];\n          }\n        }\n\n        model.classList.forEach(function (className) {\n          if (className) {\n            domElement.classList.add(className);\n          }\n        });\n      }\n    }\n  }, {\n    key: 'showAttributes',\n    value: function showAttributes(model, domElement) {\n      for (var attributeName in model.attributes) {\n        if (model.attributes[attributeName]) {\n          domElement.setAttribute(attributeName, model.attributes[attributeName]);\n        }\n      }\n    }\n  }, {\n    key: 'bindEvents',\n    value: function bindEvents(element, on) {\n      for (var eventName in on) {\n        //element.addEventListener(eventName, on[eventName])\n        element[eventName] = on[eventName];\n      }\n    }\n  }, {\n    key: 'putDown',\n    value: function putDown() {\n      if (this.$dom) {\n        if (this.parentDoment.contains(this.$dom)) {\n          this.parentDoment.removeChild(this.$dom);\n        }\n      }\n    }\n  }]);\n\n  return NodeView;\n}();\n\n/***/ }),\n\n/***/ 350:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export NodeState */\n/* unused harmony export CanDropState */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"g\", function() { return NormalState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"d\", function() { return DragoverState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return ActiveState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"f\", function() { return FocusState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return DisableState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return DraggedState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"e\", function() { return EditState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"h\", function() { return PreviewState; });\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar NodeState = function () {\n  function NodeState(node) {\n    _classCallCheck(this, NodeState);\n\n    this.node = node;\n    this.classList = [];\n    this.styles = {};\n    this.attributes = {/*contenteditable:'false'*/};\n    this.onMousemove = function () {/*console.log('mouse move NodeState')*/};\n    this.onBegindrag = function () {};\n    this.onMouseover = function (event) {};\n    this.onMouseout = function () {};\n    //this.onMouseup = (event)=>{\n    //添加结束拖动代码\n    //}\n    this.onClick = function () {\n      rxEditor.clearFocusAndEditStates();\n    };\n    this.enter = function () {};\n    this.leave = function () {};\n  }\n\n  _createClass(NodeState, [{\n    key: 'stateModel',\n    value: function stateModel() {\n      var classList = [];\n      classList.push.apply(classList, this.classList);\n\n      var model = {\n        styles: Object.assign({}, this.styles),\n        classList: classList,\n        attributes: Object.assign({}, this.attributes)\n      };\n\n      this.addtionToModel(model);\n      return model;\n    }\n  }, {\n    key: 'addtionToModel',\n    value: function addtionToModel(model) {\n      model.classList.push.apply(model.classList, rxEditor.optionClasses);\n      var node = this.node;\n      if (rxEditor.state.showMarginX && node.rule.editMarginStyle || node.children.length === 0 && node.rule.empertyMargin) {\n        model.styles['padding-left'] = node.rule.editMarginStyle ? node.rule.editMarginStyle.paddingX : 0;\n        model.styles['padding-right'] = node.rule.editMarginStyle ? node.rule.editMarginStyle.paddingX : 0;\n      }\n      if (rxEditor.state.showMarginY && node.rule.editMarginStyle || node.children.length === 0 && node.rule.empertyMargin) {\n        model.styles['padding-top'] = node.rule.editMarginStyle ? node.rule.editMarginStyle.paddingY : 0;\n        model.styles['padding-bottom'] = node.rule.editMarginStyle ? node.rule.editMarginStyle.paddingY : 0;\n      }\n\n      //添加for后，编辑时无法选中\n      if (model.attributes.for) {\n        model.attributes.for = '';\n      }\n\n      model.attributes.draggable = \"false\";\n\n      return model;\n    }\n  }, {\n    key: 'judgePosition',\n    value: function judgePosition(event) {\n      var draggedNode = rxEditor.commandManager.movingCommand.node;\n      if (this.node.isCharNode) {\n        return this.judgeCharNodePostion(event);\n      }\n      var margin = this.node.rule.dropInMargin;\n      margin = margin ? margin : 0;\n\n      var clientWidth = event.srcElement.clientWidth;\n      var clientHeight = event.srcElement.clientHeight;\n      var offsetX = event.offsetX;\n      var offsetY = event.offsetY;\n      var ratioY = offsetY / clientHeight;\n      var ratioX = offsetX / clientWidth;\n\n      if (margin > 0 && (this.node.parent && this.node.parent.canAccept(draggedNode) || !this.node.parent)) {\n        //左上角小方块区域\n        if (offsetY < margin && offsetX < margin) {\n          return ratioY < ratioX ? 'out-top' : 'out-left';\n        }\n\n        //右上角小方块区域\n        if (offsetY < margin && clientWidth - offsetX < margin) {\n          return ratioY < 1 - ratioX ? 'out-top' : 'out-right';\n        }\n\n        //右下角小方块\n        if (clientHeight - offsetY < margin && clientWidth - offsetX < margin) {\n          return 1 - ratioY < 1 - ratioX ? 'out-bottom' : 'out-right';\n        }\n\n        //左下角小方块\n        if (clientHeight - offsetY < margin && offsetX < margin) {\n          return 1 - ratioY < ratioX ? 'out-bottom' : 'out-left';\n        }\n\n        if (offsetY < margin) {\n          return 'out-top';\n        }\n\n        if (offsetX < margin) {\n          return 'out-left';\n        }\n\n        if (clientHeight - offsetY < margin) {\n          return 'out-bottom';\n        }\n\n        if (clientWidth - offsetX < margin) {\n          return 'out-right';\n        }\n      }\n\n      if (this.node.canAccept(draggedNode)) {\n        if (this.inTop(event) && this.inLeft(event)) {\n          return ratioY < ratioX ? 'in-top' : 'in-left';\n        }\n        if (this.inTop(event) && !this.inLeft(event)) {\n          return ratioY < 1 - ratioX ? 'in-top' : 'in-right';\n        }\n        if (!this.inTop(event) && this.inLeft(event)) {\n          return 1 - ratioY < ratioX ? 'in-bottom' : 'in-left';\n        }\n        if (!this.inTop(event) && !this.inLeft(event)) {\n          return 1 - ratioY < 1 - ratioX ? 'in-bottom' : 'in-right';\n        }\n      }\n    }\n  }, {\n    key: 'judgeCharNodePostion',\n    value: function judgeCharNodePostion(event) {\n      return this.inLeft(event) ? 'char-left' : 'char-right';\n    }\n\n    //-dropInMargin 边界里面，算是拖入内部，外面算是拖入外部\n\n  }, {\n    key: 'inTop',\n    value: function inTop(event) {\n      //位于上半部\n      if (event.srcElement.clientHeight > event.offsetY * 2) {\n        return true;\n      }\n      return false;\n    }\n  }, {\n    key: 'inLeft',\n    value: function inLeft(event) {\n      //位于左半部部\n      if (event.srcElement.clientWidth > event.offsetX * 2) {\n        return true;\n      }\n      return false;\n    }\n  }]);\n\n  return NodeState;\n}();\n\nvar CanDropState = function (_NodeState) {\n  _inherits(CanDropState, _NodeState);\n\n  function CanDropState(node) {\n    _classCallCheck(this, CanDropState);\n\n    var _this = _possibleConstructorReturn(this, (CanDropState.__proto__ || Object.getPrototypeOf(CanDropState)).call(this, node));\n\n    _this.onMousemove = function (event) {\n      _this.doDragover(event);\n      rxEditor.followMouse(event);\n    };\n    //this.onMouseup = (event)=>{\n    //  this.doDrop(event)\n    //}\n    _this.onClick = function (event) {\n      rxEditor.clearFocusAndEditStates();\n      _this.node.changeToState('focusState');\n    };\n    return _this;\n  }\n\n  _createClass(CanDropState, [{\n    key: 'doDragover',\n    value: function doDragover(event) {\n      var command = rxEditor.commandManager.movingCommand;\n      if (command) {\n        var position = this.judgePosition(event);\n        if (position) {\n          this.node.changeToState('dragoverState');\n          rxEditor.cursor.show(this.judgePosition(event), this.node);\n        }\n      }\n    }\n  }]);\n\n  return CanDropState;\n}(NodeState);\n\nvar NormalState = function (_CanDropState) {\n  _inherits(NormalState, _CanDropState);\n\n  function NormalState(node) {\n    _classCallCheck(this, NormalState);\n\n    var _this2 = _possibleConstructorReturn(this, (NormalState.__proto__ || Object.getPrototypeOf(NormalState)).call(this, node));\n\n    _this2.onMouseover = function (event) {\n      if (!rxEditor.commandManager.movingCommand) {\n        rxEditor.clearActiveStates();\n        _this2.node.changeToState('activeState');\n      }\n    };\n    return _this2;\n  }\n\n  return NormalState;\n}(CanDropState);\n\nvar DragoverState = function (_CanDropState2) {\n  _inherits(DragoverState, _CanDropState2);\n\n  function DragoverState(node) {\n    _classCallCheck(this, DragoverState);\n\n    var _this3 = _possibleConstructorReturn(this, (DragoverState.__proto__ || Object.getPrototypeOf(DragoverState)).call(this, node));\n\n    _this3.classList.push('rx-_-dragover');\n    _this3.enter = function () {\n      node.changeTextnodeToCharNode();\n      if (!_this3.node.isCharNode) {\n        rxEditor.activedLabel.show(node.label, node, 1);\n      }\n    };\n    _this3.leave = function () {\n      rxEditor.activedLabel.hide();\n    };\n    _this3.onMouseout = function () {\n      _this3.node.changeToState('normalState');\n    };\n    return _this3;\n  }\n\n  return DragoverState;\n}(CanDropState);\n\nvar ActiveState = function (_CanDropState3) {\n  _inherits(ActiveState, _CanDropState3);\n\n  function ActiveState(node) {\n    _classCallCheck(this, ActiveState);\n\n    var _this4 = _possibleConstructorReturn(this, (ActiveState.__proto__ || Object.getPrototypeOf(ActiveState)).call(this, node));\n\n    _this4.classList.push('rx-_-mouse-overed');\n    _this4.enter = function () {\n      rxEditor.activedLabel.show(node.label, node, 1);\n    };\n    _this4.leave = function () {\n      rxEditor.activedLabel.hide();\n    };\n    _this4.onMouseout = function () {\n      //console.log('mouse out')\n      _this4.node.changeToState('normalState');\n    };\n    _this4.onMouseover = function (event) {\n      if (!rxEditor.commandManager.movingCommand) {\n        rxEditor.clearActiveStates();\n        _this4.node.changeToState('activeState');\n      }\n    };\n    return _this4;\n  }\n\n  return ActiveState;\n}(CanDropState);\n\nvar FocusState = function (_CanDropState4) {\n  _inherits(FocusState, _CanDropState4);\n\n  function FocusState(node) {\n    _classCallCheck(this, FocusState);\n\n    var _this5 = _possibleConstructorReturn(this, (FocusState.__proto__ || Object.getPrototypeOf(FocusState)).call(this, node));\n\n    _this5.classList.push('rx-_-focused');\n    _this5.enter = function () {\n      var dom = node.view.$dom;\n      rxEditor.focusedLabel.show(node.label, node, 2);\n      rxEditor.toolbar.show(node);\n      rxEditor.focusedNode = node;\n    };\n    _this5.leave = function () {\n      rxEditor.focusedLabel.hide();\n      rxEditor.toolbar.hide();\n      rxEditor.focusedNode = '';\n    };\n    _this5.onClick = function (event) {\n      event.stopPropagation();\n    };\n\n    _this5.onBegindrag = function (event) {\n      //if(this.node.draggable){\n      _this5.preventDefault;\n      rxEditor.commandManager.startMove(_this5.node);\n      rxEditor.beginFollowMouse(event);\n      _this5.node.changeToState('draggedState');\n      //}\n    };\n    return _this5;\n  }\n\n  return FocusState;\n}(CanDropState);\n\nvar DisableState = function (_NodeState2) {\n  _inherits(DisableState, _NodeState2);\n\n  function DisableState(node) {\n    _classCallCheck(this, DisableState);\n\n    var _this6 = _possibleConstructorReturn(this, (DisableState.__proto__ || Object.getPrototypeOf(DisableState)).call(this, node));\n\n    _this6.onMousemove = function (event) {\n      event.preventDefault();\n      rxEditor.followMouse(event);\n      //console.log('mouse move DisableState')\n    };\n    _this6.onMouseout = function (event) {\n      event.preventDefault();\n    };\n    return _this6;\n  }\n\n  return DisableState;\n}(NodeState);\n\nvar DraggedState = function (_DisableState) {\n  _inherits(DraggedState, _DisableState);\n\n  function DraggedState(node) {\n    _classCallCheck(this, DraggedState);\n\n    var _this7 = _possibleConstructorReturn(this, (DraggedState.__proto__ || Object.getPrototypeOf(DraggedState)).call(this, node));\n\n    _this7.classList.push('rx-_-dragged');\n    _this7.enter = function () {\n      document.body.classList.add('one-element-dragged');\n    };\n    _this7.leave = function () {\n      document.body.classList.remove('one-element-dragged');\n    };\n    return _this7;\n  }\n\n  return DraggedState;\n}(DisableState);\n\nvar EditState = function (_FocusState) {\n  _inherits(EditState, _FocusState);\n\n  function EditState(node) {\n    _classCallCheck(this, EditState);\n\n    var _this8 = _possibleConstructorReturn(this, (EditState.__proto__ || Object.getPrototypeOf(EditState)).call(this, node));\n\n    _this8.classList.push('rx-_-editing');\n    _this8.enter = function () {\n      _this8.attributes.contenteditable = 'true';\n      var dom = node.view.$dom;\n      rxEditor.focusedLabel.show(node.label, node, 2);\n      rxEditor.toolbar.show(node);\n      rxEditor.focusedNode = node;\n      rxEditor.miniEditbar.show(_this8.node.view.$dom);\n      rxEditor.commandManager.startEditText(node);\n      node.render();\n    };\n\n    _this8.leave = function () {\n      rxEditor.focusedLabel.hide();\n      rxEditor.toolbar.hide();\n      rxEditor.focusedNode = '';\n      rxEditor.miniEditbar.hide();\n\n      rxEditor.commandManager.finishEditText();\n      _this8.node.render();\n    };\n    return _this8;\n  }\n\n  return EditState;\n}(FocusState);\n\nvar PreviewState = function (_NodeState3) {\n  _inherits(PreviewState, _NodeState3);\n\n  function PreviewState(node) {\n    _classCallCheck(this, PreviewState);\n\n    var _this9 = _possibleConstructorReturn(this, (PreviewState.__proto__ || Object.getPrototypeOf(PreviewState)).call(this, node));\n\n    _this9.onClick = function () {};\n    return _this9;\n  }\n\n  _createClass(PreviewState, [{\n    key: 'addtionToModel',\n    value: function addtionToModel(model) {\n      return model;\n    }\n  }]);\n\n  return PreviewState;\n}(NodeState);\n\n/***/ }),\n\n/***/ 351:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return CanvasState; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__basic_object_state__ = __webpack_require__(99);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\nvar CanvasState = function (_ObjectState) {\n  _inherits(CanvasState, _ObjectState);\n\n  function CanvasState() {\n    _classCallCheck(this, CanvasState);\n\n    var _this = _possibleConstructorReturn(this, (CanvasState.__proto__ || Object.getPrototypeOf(CanvasState)).call(this));\n\n    _this.__screenWidth = 'md';\n    _this.__preview = false;\n    _this.__showMarginX = true;\n    _this.__showMarginY = true;\n    _this.__showOutline = true;\n    _this.__showLabel = true;\n\n    return _this;\n  }\n\n  _createClass(CanvasState, [{\n    key: 'screenWidth',\n    get: function get() {\n      return this.__screenWidth;\n    },\n    set: function set(screenWidth) {\n      if (this.__screenWidth == screenWidth) {\n        return;\n      }\n      this.__screenWidth = screenWidth;\n      this.distributeEvent('screenWidth');\n    }\n  }, {\n    key: 'preview',\n    get: function get() {\n      return this.__preview;\n    },\n    set: function set(preview) {\n      if (this.__preview == preview) {\n        return;\n      }\n      this.__preview = preview;\n      this.distributeEvent('preview');\n    }\n  }, {\n    key: 'showMarginX',\n    get: function get() {\n      return this.__showMarginX;\n    },\n    set: function set(showMarginX) {\n      if (this.__showMarginX == showMarginX) {\n        return;\n      }\n      this.__showMarginX = showMarginX;\n      this.distributeEvent('showMarginX');\n    }\n  }, {\n    key: 'showMarginY',\n    get: function get() {\n      return this.__showMarginY;\n    },\n    set: function set(showMarginY) {\n      if (this.__showMarginY == showMarginY) {\n        return;\n      }\n      this.__showMarginY = showMarginY;\n      this.distributeEvent('showMarginY');\n    }\n  }, {\n    key: 'showOutline',\n    get: function get() {\n      return this.__showOutline;\n    },\n    set: function set(showOutline) {\n      if (this.__showOutline == showOutline) {\n        return;\n      }\n      this.__showOutline = showOutline;\n      this.distributeEvent('showOutline');\n    }\n  }, {\n    key: 'showLabel',\n    get: function get() {\n      return this.__showLabel;\n    },\n    set: function set(showLabel) {\n      if (this.__showLabel == showLabel) {\n        return;\n      }\n      this.__showLabel = showLabel;\n      this.distributeEvent('showLabel');\n    }\n  }]);\n\n  return CanvasState;\n}(__WEBPACK_IMPORTED_MODULE_0__basic_object_state__[\"a\" /* ObjectState */]);\n\n/***/ }),\n\n/***/ 352:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return CommadManager; });\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction insterAfter(newElement, targetElement) {\n  var parent = targetElement.parentNode;\n  if (parent.lastChild == targetElement) {\n    parent.appendChild(newElement);\n  } else {\n    parent.insertBefore(newElement, targetElement.nextSibling);\n  }\n}\n\nvar CommandMovable = function () {\n  function CommandMovable(node) {\n    _classCallCheck(this, CommandMovable);\n\n    this.node = node;\n    this.oldParent = node.parent;\n    this.oldnNextSbiling = node.nextSbiling();\n  }\n\n  _createClass(CommandMovable, [{\n    key: 'moveInTop',\n    value: function moveInTop(targetParent) {\n      this.node.moveInTop(targetParent);\n      this.storeNewInfo();\n    }\n  }, {\n    key: 'moveBefore',\n    value: function moveBefore(brother) {\n      this.node.moveBefore(brother);\n      this.storeNewInfo();\n    }\n  }, {\n    key: 'moveAfter',\n    value: function moveAfter(brother) {\n      this.node.moveAfter(brother);\n      this.storeNewInfo();\n    }\n  }, {\n    key: 'moveIn',\n    value: function moveIn(targetParent) {\n      this.node.moveIn(targetParent);\n      this.storeNewInfo();\n    }\n  }, {\n    key: 'storeNewInfo',\n    value: function storeNewInfo() {\n      this.newParent = this.node.parent;\n      this.newNextSbiling = this.node.nextSbiling();\n    }\n  }, {\n    key: 'adoptFromToolbox',\n    value: function adoptFromToolbox(parent) {\n      var draggedNode = this.node;\n      if (draggedNode && !draggedNode.parent && parent.canAccept(draggedNode)) {\n        draggedNode.parent = parent;\n        draggedNode.render();\n        draggedNode.changeToState('draggedState');\n      }\n    }\n  }, {\n    key: 'finish',\n    value: function finish() {\n      var draggedNode = this.node;\n      if (draggedNode.parent) {\n        draggedNode.parent.changeToState('normalState');\n      }\n      this.makeExcuteSchema();\n    }\n  }, {\n    key: 'excute',\n    value: function excute() {\n      this.node.removeFromParent();\n      if (this.newNextSbiling) {\n        this.node.moveBefore(this.newNextSbiling);\n      } else if (this.newParent) {\n        this.newParent.pushChild(this.node);\n      }\n      this.makeExcuteSchema();\n    }\n  }, {\n    key: 'undo',\n    value: function undo() {\n      this.node.removeFromParent();\n      if (this.oldnNextSbiling) {\n        this.node.moveBefore(this.oldnNextSbiling);\n      } else if (this.oldParent) {\n        this.oldParent.pushChild(this.node);\n      }\n\n      this.makeUndoSchema();\n    }\n  }]);\n\n  return CommandMovable;\n}();\n\nvar CommandNew = function (_CommandMovable) {\n  _inherits(CommandNew, _CommandMovable);\n\n  function CommandNew(node) {\n    _classCallCheck(this, CommandNew);\n\n    return _possibleConstructorReturn(this, (CommandNew.__proto__ || Object.getPrototypeOf(CommandNew)).call(this, node));\n  }\n\n  _createClass(CommandNew, [{\n    key: 'makeExcuteSchema',\n    value: function makeExcuteSchema() {\n      this.commandSchema = {\n        command: 'new',\n        node: this.node.toTreeViewNode(),\n        parentId: this.node.parent ? this.node.parent.id : '',\n        nextSblilingId: this.node.nextSbiling() ? this.node.nextSbiling().id : ''\n      };\n    }\n  }, {\n    key: 'makeUndoSchema',\n    value: function makeUndoSchema() {\n      this.commandSchema = {\n        command: 'delete',\n        nodeId: this.node.id\n      };\n    }\n  }]);\n\n  return CommandNew;\n}(CommandMovable);\n\nvar CommandMove = function (_CommandMovable2) {\n  _inherits(CommandMove, _CommandMovable2);\n\n  function CommandMove(node) {\n    _classCallCheck(this, CommandMove);\n\n    return _possibleConstructorReturn(this, (CommandMove.__proto__ || Object.getPrototypeOf(CommandMove)).call(this, node));\n  }\n\n  _createClass(CommandMove, [{\n    key: 'makeExcuteSchema',\n    value: function makeExcuteSchema() {\n      this.commandSchema = {\n        command: 'move',\n        nodeId: this.node.id,\n        oldParentId: this.oldParent ? this.oldParent.id : '',\n        parentId: this.node.parent ? this.node.parent.id : '',\n        nextSblilingId: this.node.nextSbiling() ? this.node.nextSbiling().id : ''\n      };\n    }\n  }, {\n    key: 'makeUndoSchema',\n    value: function makeUndoSchema() {\n      this.commandSchema = {\n        command: 'move',\n        nodeId: this.node.id,\n        oldParentId: this.newParent ? this.newParent.id : '',\n        parentId: this.node.parent ? this.node.parent.id : '',\n        nextSblilingId: this.node.nextSbiling() ? this.node.nextSbiling().id : ''\n      };\n    }\n  }]);\n\n  return CommandMove;\n}(CommandMovable);\n\nvar CommandDelete = function () {\n  function CommandDelete(node) {\n    _classCallCheck(this, CommandDelete);\n\n    this.node = node;\n    this.oldParent = node.parent;\n    this.oldnNextSbiling = this.node.nextSbiling();\n  }\n\n  _createClass(CommandDelete, [{\n    key: 'excute',\n    value: function excute() {\n      this.node.removeFromParent();\n      this.makeExcuteSchema();\n    }\n  }, {\n    key: 'undo',\n    value: function undo() {\n      if (this.oldnNextSbiling) {\n        this.node.moveBefore(this.oldnNextSbiling);\n      } else {\n        this.oldParent.pushChild(this.node);\n      }\n      this.makeUndoSchema();\n    }\n  }, {\n    key: 'makeExcuteSchema',\n    value: function makeExcuteSchema() {\n      this.commandSchema = {\n        command: 'delete',\n        nodeId: this.node.id\n      };\n    }\n  }, {\n    key: 'makeUndoSchema',\n    value: function makeUndoSchema() {\n      this.commandSchema = {\n        command: 'new',\n        node: this.node.toTreeViewNode(),\n        parentId: this.node.parent ? this.node.parent.id : '',\n        nextSblilingId: this.node.nextSbiling() ? this.node.nextSbiling().id : ''\n      };\n    }\n  }]);\n\n  return CommandDelete;\n}();\n\nvar CommandClone = function () {\n  function CommandClone(node) {\n    _classCallCheck(this, CommandClone);\n\n    this.node = node;\n    this.copy = node.clone();\n  }\n\n  _createClass(CommandClone, [{\n    key: 'excute',\n    value: function excute() {\n      this.copy.moveAfter(this.node);\n      this.makeExcuteSchema();\n    }\n  }, {\n    key: 'undo',\n    value: function undo() {\n      this.copy.removeFromParent();\n      this.makeUndoSchema();\n    }\n  }, {\n    key: 'makeExcuteSchema',\n    value: function makeExcuteSchema() {\n      this.commandSchema = {\n        command: 'new',\n        node: this.copy.toTreeViewNode(),\n        parentId: this.copy.parent ? this.copy.parent.id : '',\n        nextSblilingId: this.copy.nextSbiling() ? this.copy.nextSbiling().id : ''\n      };\n    }\n  }, {\n    key: 'makeUndoSchema',\n    value: function makeUndoSchema() {\n      this.commandSchema = {\n        command: 'delete',\n        nodeId: this.copy.id\n      };\n    }\n  }]);\n\n  return CommandClone;\n}();\n\nvar CommandChangeNode = function () {\n  function CommandChangeNode(node, newMeta) {\n    _classCallCheck(this, CommandChangeNode);\n\n    this.node = node;\n    this.oldMeta = JSON.parse(JSON.stringify(node.meta));\n    this.newMeta = JSON.parse(JSON.stringify(newMeta));\n  }\n\n  _createClass(CommandChangeNode, [{\n    key: 'excute',\n    value: function excute() {\n      this.node.meta = JSON.parse(JSON.stringify(this.newMeta));\n      this.makeExcuteSchema();\n    }\n  }, {\n    key: 'undo',\n    value: function undo() {\n      this.node.meta = JSON.parse(JSON.stringify(this.oldMeta));\n      this.makeUndoSchema();\n    }\n  }, {\n    key: 'makeExcuteSchema',\n    value: function makeExcuteSchema() {\n      this.commandSchema = {\n        command: 'change',\n        nodeId: this.node.id,\n        meta: this.node.meta\n      };\n    }\n  }, {\n    key: 'makeUndoSchema',\n    value: function makeUndoSchema() {\n      this.commandSchema = {\n        command: 'change',\n        nodeId: this.node.id,\n        meta: this.node.meta\n      };\n    }\n  }]);\n\n  return CommandChangeNode;\n}();\n\nvar CommandTextEdit = function () {\n  function CommandTextEdit(node) {\n    _classCallCheck(this, CommandTextEdit);\n\n    this.node = node;\n    this.oldChildren = this.node.children;\n\n    this.node.children.forEach(function (chilid) {\n      chilid.preview();\n    });\n  }\n\n  _createClass(CommandTextEdit, [{\n    key: 'finish',\n    value: function finish() {\n      var _this3 = this;\n\n      this.node.children = rxEditor.nodeParser.parse(this.node.view.$dom.innerHTML);\n\n      this.node.children.forEach(function (child) {\n        child.parent = _this3.node;\n      });\n      this.newChildren = this.node.children;\n    }\n  }, {\n    key: 'excute',\n    value: function excute() {\n      this.node.children = this.newChildren;\n      this.makeExcuteSchema();\n    }\n  }, {\n    key: 'undo',\n    value: function undo() {\n      this.node.children = this.oldChildren;\n      this.makeUndoSchema();\n    }\n  }, {\n    key: 'makeExcuteSchema',\n    value: function makeExcuteSchema() {\n      this.commandSchema = {\n        command: 'textEdit',\n        nodeId: this.node.id,\n        node: this.node.toTreeViewNode()\n      };\n    }\n  }, {\n    key: 'makeUndoSchema',\n    value: function makeUndoSchema() {\n      this.commandSchema = {\n        command: 'textEdit',\n        nodeId: this.node.id,\n        node: this.node.toTreeViewNode()\n      };\n    }\n  }]);\n\n  return CommandTextEdit;\n}();\n\nvar CommandLoadCanvasHtml = function () {\n  function CommandLoadCanvasHtml(newHtml) {\n    var _this4 = this;\n\n    _classCallCheck(this, CommandLoadCanvasHtml);\n\n    this.node = rxEditor.canvas;\n    this.oldChildren = this.node.children;\n    this.node.children = rxEditor.nodeParser.parse(newHtml);\n    this.node.children.forEach(function (child) {\n      child.parent = _this4.node;\n    });\n    this.newChildren = this.node.children;\n  }\n\n  _createClass(CommandLoadCanvasHtml, [{\n    key: 'excute',\n    value: function excute() {\n      this.node.children = this.newChildren;\n      this.makeExcuteSchema();\n    }\n  }, {\n    key: 'undo',\n    value: function undo() {\n      this.node.children = this.oldChildren;\n      this.makeUndoSchema();\n    }\n  }, {\n    key: 'makeExcuteSchema',\n    value: function makeExcuteSchema() {\n      this.commandSchema = {\n        command: 'loadCanvasNodes',\n        nodes: this.node.toTreeViewNode().children\n      };\n    }\n  }, {\n    key: 'makeUndoSchema',\n    value: function makeUndoSchema() {\n      this.commandSchema = {\n        command: 'loadCanvasNodes',\n        nodes: this.node.toTreeViewNode().children\n      };\n    }\n  }]);\n\n  return CommandLoadCanvasHtml;\n}();\n\nvar CommandClearCanvas = function () {\n  function CommandClearCanvas() {\n    _classCallCheck(this, CommandClearCanvas);\n\n    this.node = rxEditor.canvas;\n    this.oldChildren = this.node.children;\n    this.node.children = [];\n    this.newChildren = this.node.children;\n  }\n\n  _createClass(CommandClearCanvas, [{\n    key: 'excute',\n    value: function excute() {\n      this.node.children = this.newChildren;\n      this.makeExcuteSchema();\n    }\n  }, {\n    key: 'undo',\n    value: function undo() {\n      this.node.children = this.oldChildren;\n      this.makeUndoSchema();\n    }\n  }, {\n    key: 'makeExcuteSchema',\n    value: function makeExcuteSchema() {\n      this.commandSchema = {\n        command: 'loadCanvasNodes',\n        nodes: this.node.toTreeViewNode().children\n      };\n    }\n  }, {\n    key: 'makeUndoSchema',\n    value: function makeUndoSchema() {\n      this.commandSchema = {\n        command: 'loadCanvasNodes',\n        nodes: this.node.toTreeViewNode().children\n      };\n    }\n  }]);\n\n  return CommandClearCanvas;\n}();\n\nvar CommandLoadNodeHtml = function () {\n  function CommandLoadNodeHtml(node, newHtml) {\n    var _this5 = this;\n\n    _classCallCheck(this, CommandLoadNodeHtml);\n\n    this.node = node;\n    this.oldChildren = this.node.children;\n    this.oldMeta = this.node.meta;\n    this.node.children = [];\n    var nodes = rxEditor.nodeParser.parse(newHtml);\n    if (nodes.length > 0) {\n      var newNode = nodes[0];\n      newNode.children.forEach(function (child) {\n        child.parent = _this5.node;\n        _this5.node.children.push(child);\n      });\n      this.node.meta = newNode.meta;\n    }\n    this.newMeta = this.node.meta;\n    this.newChildren = this.node.children;\n  }\n\n  _createClass(CommandLoadNodeHtml, [{\n    key: 'excute',\n    value: function excute() {\n      this.node.children = this.newChildren;\n      this.node.meta = this.newMeta;\n      this.makeExcuteSchema();\n    }\n  }, {\n    key: 'undo',\n    value: function undo() {\n      this.node.children = this.oldChildren;\n      this.node.meta = this.oldMeta;\n      this.makeUndoSchema();\n    }\n  }, {\n    key: 'makeExcuteSchema',\n    value: function makeExcuteSchema() {\n      this.commandSchema = {\n        command: 'loadNode',\n        nodeId: this.node.id,\n        node: this.node.toTreeViewNode()\n      };\n    }\n  }, {\n    key: 'makeUndoSchema',\n    value: function makeUndoSchema() {\n      this.commandSchema = {\n        command: 'loadNode',\n        nodeId: this.node.id,\n        node: this.node.toTreeViewNode()\n      };\n    }\n  }]);\n\n  return CommandLoadNodeHtml;\n}();\n\nvar CommadManager = function () {\n  function CommadManager() {\n    _classCallCheck(this, CommadManager);\n\n    this.undoCommands = [];\n    this.redoCommands = [];\n    this.onCommandsChanged = function (canUndo, canRedo) {};\n  }\n\n  _createClass(CommadManager, [{\n    key: 'getDraggedNode',\n    value: function getDraggedNode() {\n      if (this.movingCommand) {\n        return this.movingCommand.node;\n      }\n    }\n  }, {\n    key: 'startNew',\n    value: function startNew(node) {\n      var cmd = new CommandNew(node);\n      this.startCommand(cmd);\n    }\n  }, {\n    key: 'startMove',\n    value: function startMove(node) {\n      var cmd = new CommandMove(node);\n      this.startCommand(cmd);\n    }\n  }, {\n    key: 'duplicate',\n    value: function duplicate(node) {\n      var cmd = new CommandClone(node);\n      cmd.excute();\n      this.finished(cmd);\n      cmd.node.changeToState('normalState');\n      cmd.copy.changeToState('focusState');\n    }\n  }, {\n    key: 'changeNode',\n    value: function changeNode(node, newNodeData) {\n      //node.meta = newNodeData.meta\n      var cmd = new CommandChangeNode(node, newNodeData.meta);\n      cmd.excute();\n      this.finished(cmd);\n    }\n  }, {\n    key: 'deleteNode',\n    value: function deleteNode(node) {\n      var cmd = new CommandDelete(node);\n      cmd.excute();\n      this.finished(cmd);\n      rxEditor.toolbar.hide();\n      rxEditor.focusedLabel.hide();\n    }\n  }, {\n    key: 'loadNodeHtml',\n    value: function loadNodeHtml(node, html) {\n      var cmd = new CommandLoadNodeHtml(node, html);\n      cmd.excute();\n      this.finished(cmd);\n    }\n  }, {\n    key: 'loadCanvasHtml',\n    value: function loadCanvasHtml(html) {\n      var cmd = new CommandLoadCanvasHtml(html);\n      cmd.excute();\n      this.finished(cmd);\n    }\n  }, {\n    key: 'clearCanvas',\n    value: function clearCanvas() {\n      var cmd = new CommandClearCanvas();\n      cmd.excute();\n      this.finished(cmd);\n    }\n  }, {\n    key: 'startCommand',\n    value: function startCommand(command) {\n      this.movingCommand = command;\n    }\n  }, {\n    key: 'finishMoving',\n    value: function finishMoving() {\n\n      if (this.movingCommand && this.movingCommand.node.parent) {\n        //this.movingCommand.finish()\n        this.finished(this.movingCommand);\n        this.movingCommand.node.changeToState('focusState');\n      }\n      this.movingCommand = '';\n    }\n  }, {\n    key: 'startEditText',\n    value: function startEditText(node) {\n      this.textCommand = new CommandTextEdit(node);\n    }\n  }, {\n    key: 'finishEditText',\n    value: function finishEditText() {\n      this.textCommand.finish();\n      this.finished(this.textCommand);\n      this.textCommand = '';\n    }\n  }, {\n    key: 'finished',\n    value: function finished(command) {\n      this.undoCommands.push(command);\n      this.redoCommands.length = 0;\n      this.submitChanged(command);\n    }\n  }, {\n    key: 'undo',\n    value: function undo() {\n      var command = this.undoCommands.pop();\n      command.undo();\n      this.redoCommands.push(command);\n      this.submitChanged(command);\n    }\n  }, {\n    key: 'redo',\n    value: function redo() {\n      var command = this.redoCommands.pop();\n      command.excute();\n      this.undoCommands.push(command);\n      this.submitChanged(command);\n    }\n  }, {\n    key: 'submitChanged',\n    value: function submitChanged(command) {\n      this.onCommandsChanged(this.undoCommands.length > 0, this.redoCommands.length > 0, command.commandSchema);\n    }\n  }]);\n\n  return CommadManager;\n}();\n\n/***/ }),\n\n/***/ 353:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return NodeLabel; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__basic_rxcomponent__ = __webpack_require__(18);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\nvar NodeLabel = function (_RXComponent) {\n  _inherits(NodeLabel, _RXComponent);\n\n  function NodeLabel() {\n    _classCallCheck(this, NodeLabel);\n\n    var _this = _possibleConstructorReturn(this, (NodeLabel.__proto__ || Object.getPrototypeOf(NodeLabel)).call(this));\n\n    _this.cssClass('node-label');\n    _this.domAttr('title', $t('can-be-draged'));\n    _this.hide();\n    document.addEventListener('scroll', function (event) {\n      _this.refreshPosition();\n    });\n    window.addEventListener('resize', function (event) {\n      _this.refreshPosition();\n    });\n    return _this;\n  }\n\n  _createClass(NodeLabel, [{\n    key: 'refreshPosition',\n    value: function refreshPosition() {\n      this.followElement(this.node, this.offset);\n    }\n  }, {\n    key: 'show',\n    value: function show(label, node, offset) {\n      this.node = node;\n      this.offset = offset;\n      if (!node || !node.view.$dom) return;\n      _get(NodeLabel.prototype.__proto__ || Object.getPrototypeOf(NodeLabel.prototype), 'setInnerHTML', this).call(this, label);\n      this.followElement(node, offset);\n      return _get(NodeLabel.prototype.__proto__ || Object.getPrototypeOf(NodeLabel.prototype), 'show', this).call(this);\n    }\n  }, {\n    key: 'followElement',\n    value: function followElement(node, offset) {\n      if (!node || !node.view || !node.view.$dom) return;\n      var domElement = node.view.$dom;\n      var rect = domElement.getBoundingClientRect();\n      if (this.$dom) {\n        this.$dom.style.left = rect.x + 'px';\n        if (rect.y < 20) {\n          this.$dom.style.top = rect.y + rect.height + offset + 'px';\n        } else {\n          this.$dom.style.top = rect.y - 15 - offset + 'px';\n        }\n      }\n    }\n  }]);\n\n  return NodeLabel;\n}(__WEBPACK_IMPORTED_MODULE_0__basic_rxcomponent__[\"a\" /* RXComponent */]);\n\n/***/ }),\n\n/***/ 354:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return NodeToolbar; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__basic_rxcomponent__ = __webpack_require__(18);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\nvar SvgButton = function (_RXComponent) {\n  _inherits(SvgButton, _RXComponent);\n\n  function SvgButton(title, svg, on, callback) {\n    _classCallCheck(this, SvgButton);\n\n    var _this = _possibleConstructorReturn(this, (SvgButton.__proto__ || Object.getPrototypeOf(SvgButton)).call(this));\n\n    _this.cssClass('rx-button');\n    _this.domAttr('title', title);\n    _this.innerHTML = svg;\n    _this.domOn(on, callback);\n    return _this;\n  }\n\n  return SvgButton;\n}(__WEBPACK_IMPORTED_MODULE_0__basic_rxcomponent__[\"a\" /* RXComponent */]);\n\nvar svgArrowUp = '<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"arrow-up\" class=\"svg-inline--fa fa-arrow-up fa-w-14\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"><path fill=\"currentColor\" d=\"M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z\"></path></svg>';\n\nvar svgMove = '<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"arrows-alt\" class=\"svg-inline--fa fa-arrows-alt fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M352.201 425.775l-79.196 79.196c-9.373 9.373-24.568 9.373-33.941 0l-79.196-79.196c-15.119-15.119-4.411-40.971 16.971-40.97h51.162L228 284H127.196v51.162c0 21.382-25.851 32.09-40.971 16.971L7.029 272.937c-9.373-9.373-9.373-24.569 0-33.941L86.225 159.8c15.119-15.119 40.971-4.411 40.971 16.971V228H228V127.196h-51.23c-21.382 0-32.09-25.851-16.971-40.971l79.196-79.196c9.373-9.373 24.568-9.373 33.941 0l79.196 79.196c15.119 15.119 4.411 40.971-16.971 40.971h-51.162V228h100.804v-51.162c0-21.382 25.851-32.09 40.97-16.971l79.196 79.196c9.373 9.373 9.373 24.569 0 33.941L425.773 352.2c-15.119 15.119-40.971 4.411-40.97-16.971V284H284v100.804h51.23c21.382 0 32.09 25.851 16.971 40.971z\"></path></svg>';\n\nvar svgEdit = '<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"far\" data-icon=\"edit\" class=\"svg-inline--fa fa-edit fa-w-18\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 576 512\"><path fill=\"currentColor\" d=\"M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z\"></path></svg>';\n\nvar svgClone = '<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"far\" data-icon=\"clone\" class=\"svg-inline--fa fa-clone fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M464 0H144c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h320c26.51 0 48-21.49 48-48v-48h48c26.51 0 48-21.49 48-48V48c0-26.51-21.49-48-48-48zM362 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h42v224c0 26.51 21.49 48 48 48h224v42a6 6 0 0 1-6 6zm96-96H150a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h308a6 6 0 0 1 6 6v308a6 6 0 0 1-6 6z\"></path></svg>';\n\nvar svgRemove = '<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"far\" data-icon=\"trash-alt\" class=\"svg-inline--fa fa-trash-alt fa-w-14\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"><path fill=\"currentColor\" d=\"M268 416h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12zM432 80h-82.41l-34-56.7A48 48 0 0 0 274.41 0H173.59a48 48 0 0 0-41.16 23.3L98.41 80H16A16 16 0 0 0 0 96v16a16 16 0 0 0 16 16h16v336a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128h16a16 16 0 0 0 16-16V96a16 16 0 0 0-16-16zM171.84 50.91A6 6 0 0 1 177 48h94a6 6 0 0 1 5.15 2.91L293.61 80H154.39zM368 464H80V128h288zm-212-48h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12z\"></path></svg>';\n\nvar NodeToolbar = function (_RXComponent2) {\n  _inherits(NodeToolbar, _RXComponent2);\n\n  function NodeToolbar() {\n    _classCallCheck(this, NodeToolbar);\n\n    var _this2 = _possibleConstructorReturn(this, (NodeToolbar.__proto__ || Object.getPrototypeOf(NodeToolbar)).call(this));\n\n    _this2.cssClass('node-toolbar');\n    _this2.hide();\n\n    _this2.duplicateBtn = new SvgButton($t('duplicate'), svgClone, 'click', function () {\n      if (rxEditor.focusedNode) {\n        rxEditor.focusedNode.duplicate(event);\n      }\n    });\n\n    _this2.pushChild(new SvgButton($t('focus-parent'), svgArrowUp, 'click', function () {\n      if (rxEditor.focusedNode) {\n        rxEditor.focusedNode.up(event);\n      }\n    }));\n    _this2.pushChild(new SvgButton($t('move'), svgMove, 'mousedown', function (event) {\n      if (rxEditor.focusedNode) {\n        rxEditor.focusedNode.begindragIcon(event);\n      }\n    })\n    //.cssStyle('cursor', 'move')\n    );\n    _this2.editButton = new SvgButton($t('edit'), svgEdit, 'mousedown', function (event) {\n      rxEditor.focusedNode.changeToState('editState');\n    });\n\n    _this2.editButton.domOn('mouseup', function (event) {\n      //move cusor to end\n      var el = rxEditor.focusedNode.view.$dom;\n      var sel = window.getSelection();\n      sel.collapse(el, 1);\n      el.focus();\n    });\n    _this2.pushChild(_this2.editButton);\n    _this2.pushChild(_this2.duplicateBtn);\n    _this2.pushChild(new SvgButton($t('delete'), svgRemove, 'click', function () {\n      if (rxEditor.focusedNode) {\n        rxEditor.focusedNode.delete(event);\n      }\n    }));\n\n    document.addEventListener('scroll', function (event) {\n      _this2.refreshPosition();\n    });\n    window.addEventListener('resize', function (event) {\n      _this2.refreshPosition();\n    });\n    return _this2;\n  }\n\n  _createClass(NodeToolbar, [{\n    key: 'refreshPosition',\n    value: function refreshPosition() {\n      this.followElement(this.node);\n    }\n  }, {\n    key: 'show',\n    value: function show(node) {\n      this.node = node;\n      if (!node || !node.view.$dom) return;\n      this.followElement(node);\n      if (this.node.rule.editable) {\n        this.editButton.show();\n      } else {\n        this.editButton.hide();\n      }\n      //if(this.node.forbidDuplicate){\n      //  this.duplicateBtn.hide()\n      //}\n      //else{\n      //  this.duplicateBtn.show()\n      //}\n      return _get(NodeToolbar.prototype.__proto__ || Object.getPrototypeOf(NodeToolbar.prototype), 'show', this).call(this);\n    }\n  }, {\n    key: 'followElement',\n    value: function followElement(node) {\n      if (!node || !node.view || !node.view.$dom) return;\n      var domElement = node.view.$dom;\n      var rect = domElement.getBoundingClientRect();\n      var offsetX = this.node.rule.editable ? 0 : 25;\n      if (this.$dom) {\n        var x = rect.x + rect.width - 120;\n        x = x < 0 ? 0 : x;\n        this.$dom.style.left = x + offsetX + 'px';\n        if (rect.y < 26) {\n          this.$dom.style.top = rect.y + rect.height + 'px';\n        } else {\n          this.$dom.style.top = rect.y - 26 + 'px';\n        }\n      }\n    }\n  }]);\n\n  return NodeToolbar;\n}(__WEBPACK_IMPORTED_MODULE_0__basic_rxcomponent__[\"a\" /* RXComponent */]);\n\n/***/ }),\n\n/***/ 355:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return RxCursor; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__basic_rxcomponent__ = __webpack_require__(18);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\nvar RxCursor = function (_RXComponent) {\n  _inherits(RxCursor, _RXComponent);\n\n  function RxCursor() {\n    _classCallCheck(this, RxCursor);\n\n    var _this = _possibleConstructorReturn(this, (RxCursor.__proto__ || Object.getPrototypeOf(RxCursor)).call(this));\n\n    _this.cssClass('rx-cursor');\n    _this.cssClass('out');\n    _this.hide();\n    return _this;\n  }\n\n  _createClass(RxCursor, [{\n    key: 'hide',\n    value: function hide() {\n      this.position = '';\n      this.node = null;\n      _get(RxCursor.prototype.__proto__ || Object.getPrototypeOf(RxCursor.prototype), 'hide', this).call(this);\n    }\n  }, {\n    key: 'show',\n    value: function show(position, node) {\n      this.position = position;\n      this.node = node;\n      if (!node || !node.view.$dom) return;\n      this.classClasses();\n      this.cssClass('rx-cursor');\n      this.cssClass(position);\n      this.node = node;\n      if (position === 'in-top') {\n        this.inTop(node);\n      }\n\n      if (position === 'in-right') {\n        this.inRight(node);\n      }\n\n      if (position === 'in-bottom') {\n        this.inBottom(node);\n      }\n\n      if (position === 'in-left') {\n        this.inLeft(node);\n      }\n\n      if (position === 'out-top') {\n        this.outTop(node);\n      }\n\n      if (position === 'out-right') {\n        this.outRight(node);\n      }\n\n      if (position === 'out-bottom') {\n        this.outBottom(node);\n      }\n\n      if (position === 'out-left') {\n        this.outLeft(node);\n      }\n\n      if (position === 'char-left') {\n        this.charLeft(node);\n      }\n\n      if (position === 'char-right') {\n        this.charRight(node);\n      }\n\n      return _get(RxCursor.prototype.__proto__ || Object.getPrototypeOf(RxCursor.prototype), 'show', this).call(this);\n    }\n  }, {\n    key: 'outTop',\n    value: function outTop(node) {\n      var domElement = node.view.$dom;\n      var rect = domElement.getBoundingClientRect();\n      if (this.$dom) {\n        this.$dom.style.left = rect.left + 'px';\n        this.$dom.style.top = rect.top - 2 + 'px';\n        this.$dom.style.width = rect.width + 'px';\n        this.$dom.style.height = '4px';\n      }\n    }\n  }, {\n    key: 'outRight',\n    value: function outRight(node) {\n      var domElement = node.view.$dom;\n      var rect = domElement.getBoundingClientRect();\n      if (this.$dom) {\n        this.$dom.style.left = rect.right - 2 + 'px';\n        this.$dom.style.right = \"auto\";\n        this.$dom.style.top = rect.top + 'px';\n        this.$dom.style.width = '4px';\n        this.$dom.style.height = rect.height + 'px';\n      }\n    }\n  }, {\n    key: 'outBottom',\n    value: function outBottom(node) {\n      var domElement = node.view.$dom;\n      var rect = domElement.getBoundingClientRect();\n      if (this.$dom) {\n        this.$dom.style.left = rect.x + 'px';\n        this.$dom.style.top = rect.bottom - 2 + 'px';\n        this.$dom.style.bottom = 'auto';\n        this.$dom.style.width = rect.width + 'px';\n        this.$dom.style.height = '4px';\n      }\n    }\n  }, {\n    key: 'outLeft',\n    value: function outLeft(node) {\n      var domElement = node.view.$dom;\n      var rect = domElement.getBoundingClientRect();\n      if (this.$dom) {\n        this.$dom.style.left = rect.left - 2 + 'px';\n        this.$dom.style.right = 'auto';\n        this.$dom.style.top = rect.top + 'px';\n        this.$dom.style.width = '4px';\n        this.$dom.style.height = rect.height + 'px';\n      }\n    }\n  }, {\n    key: 'charRight',\n    value: function charRight(node) {\n      var domElement = node.view.$dom;\n      var rect = domElement.getBoundingClientRect();\n      if (this.$dom) {\n        this.$dom.style.left = rect.right - 2 + 'px';\n        this.$dom.style.right = \"auto\";\n        this.$dom.style.top = rect.top + 'px';\n        this.$dom.style.width = '4px';\n        this.$dom.style.height = rect.height + 'px';\n      }\n    }\n  }, {\n    key: 'charLeft',\n    value: function charLeft(node) {\n      var domElement = node.view.$dom;\n      var rect = domElement.getBoundingClientRect();\n      if (this.$dom) {\n        this.$dom.style.left = rect.left - 2 + 'px';\n        this.$dom.style.right = 'auto';\n        this.$dom.style.top = rect.top + 'px';\n        this.$dom.style.width = '4px';\n        this.$dom.style.height = rect.height + 'px';\n      }\n    }\n\n    /**/\n\n  }, {\n    key: 'inTop',\n    value: function inTop(node) {\n      var domElement = node.view.$dom;\n      var rect = domElement.getBoundingClientRect();\n      if (this.$dom) {\n        this.$dom.style.left = rect.left + 'px';\n        this.$dom.style.top = rect.top + 1 + 'px';\n        this.$dom.style.width = rect.width + 'px';\n        this.$dom.style.height = '4px';\n      }\n    }\n  }, {\n    key: 'inRight',\n    value: function inRight(node) {\n      var domElement = node.view.$dom;\n      var rect = domElement.getBoundingClientRect();\n      if (this.$dom) {\n        this.$dom.style.left = rect.right - 4 + 'px';\n        this.$dom.style.right = \"auto\";\n        this.$dom.style.top = rect.top + 'px';\n        this.$dom.style.width = '4px';\n        this.$dom.style.height = rect.height + 'px';\n      }\n    }\n  }, {\n    key: 'inBottom',\n    value: function inBottom(node) {\n      var domElement = node.view.$dom;\n      var rect = domElement.getBoundingClientRect();\n      if (this.$dom) {\n        this.$dom.style.left = rect.x + 'px';\n        this.$dom.style.top = rect.bottom - 4 + 'px';\n        this.$dom.style.bottom = 'auto';\n        this.$dom.style.width = rect.width + 'px';\n        this.$dom.style.height = '4px';\n      }\n    }\n  }, {\n    key: 'inLeft',\n    value: function inLeft(node) {\n      var domElement = node.view.$dom;\n      var rect = domElement.getBoundingClientRect();\n      if (this.$dom) {\n        this.$dom.style.left = rect.left + 'px';\n        this.$dom.style.right = 'auto';\n        this.$dom.style.top = rect.top + 'px';\n        this.$dom.style.width = '4px';\n        this.$dom.style.height = rect.height + 'px';\n      }\n    }\n  }, {\n    key: 'followElement',\n    value: function followElement(node) {\n      var domElement = node.view.$dom;\n      var rect = domElement.getBoundingClientRect();\n      if (this.$dom) {\n        this.$dom.style.left = rect.x + 'px';\n        this.$dom.style.top = rect.height / 2 + 'px';\n        //if(rect.y < 20){\n        //  this.$dom.style.top = (rect.y + rect.height) + 'px'\n        //}\n        //else{\n        //  this.$dom.style.top = (rect.y - 15 - offset) + 'px'\n        //}\n\n        this.$dom.style.width = rect.width + 'px';\n      }\n    }\n  }]);\n\n  return RxCursor;\n}(__WEBPACK_IMPORTED_MODULE_0__basic_rxcomponent__[\"a\" /* RXComponent */]);\n\n/***/ }),\n\n/***/ 356:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return MouseFollower; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__basic_rxcomponent__ = __webpack_require__(18);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\nvar MouseFollower = function (_RXComponent) {\n  _inherits(MouseFollower, _RXComponent);\n\n  function MouseFollower() {\n    _classCallCheck(this, MouseFollower);\n\n    var _this = _possibleConstructorReturn(this, (MouseFollower.__proto__ || Object.getPrototypeOf(MouseFollower)).call(this));\n\n    _this.cssClass('mouse-follower');\n    _this.hide();\n    return _this;\n  }\n\n  _createClass(MouseFollower, [{\n    key: \"active\",\n    value: function active(text) {\n      _get(MouseFollower.prototype.__proto__ || Object.getPrototypeOf(MouseFollower.prototype), \"setInnerHTML\", this).call(this, text);\n      this.isActived = true;\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      this.isActived = false;\n      _get(MouseFollower.prototype.__proto__ || Object.getPrototypeOf(MouseFollower.prototype), \"hide\", this).call(this);\n    }\n  }, {\n    key: \"followMouse\",\n    value: function followMouse(event) {\n      this.$dom.style.left = event.clientX;\n      this.$dom.style.top = event.clientY;\n      _get(MouseFollower.prototype.__proto__ || Object.getPrototypeOf(MouseFollower.prototype), \"show\", this).call(this);\n    }\n  }]);\n\n  return MouseFollower;\n}(__WEBPACK_IMPORTED_MODULE_0__basic_rxcomponent__[\"a\" /* RXComponent */]);\n\n/***/ }),\n\n/***/ 357:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return MiniEditbar; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__basic_rxcomponent__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__basic_object_state__ = __webpack_require__(99);\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\nvar EditorState = function (_ObjectState) {\n  _inherits(EditorState, _ObjectState);\n\n  function EditorState() {\n    _classCallCheck(this, EditorState);\n\n    var _this = _possibleConstructorReturn(this, (EditorState.__proto__ || Object.getPrototypeOf(EditorState)).call(this));\n\n    _this.__bold = false;\n    _this.__italic = false;\n    _this.__underline = false;\n    _this.__strikeThrough = false;\n    _this.__isLink = false;\n    return _this;\n  }\n\n  _createClass(EditorState, [{\n    key: \"bold\",\n    get: function get() {\n      return this.__bold;\n    },\n    set: function set(bold) {\n      if (this.__bold == bold) {\n        return;\n      }\n      this.__bold = bold;\n      this.distributeEvent('bold');\n    }\n  }, {\n    key: \"italic\",\n    get: function get() {\n      return this.__italic;\n    },\n    set: function set(italic) {\n      if (this.__italic == italic) {\n        return;\n      }\n      this.__italic = italic;\n      this.distributeEvent('italic');\n    }\n  }, {\n    key: \"underline\",\n    get: function get() {\n      return this.__underline;\n    },\n    set: function set(underline) {\n      if (this.__underline == underline) {\n        return;\n      }\n      this.__underline = underline;\n      this.distributeEvent('underline');\n    }\n  }, {\n    key: \"strikeThrough\",\n    get: function get() {\n      return this.__strikeThrough;\n    },\n    set: function set(strikeThrough) {\n      if (this.__strikeThrough == strikeThrough) {\n        return;\n      }\n      this.__strikeThrough = strikeThrough;\n      this.distributeEvent('strikeThrough');\n    }\n  }, {\n    key: \"isLink\",\n    get: function get() {\n      return this.__isLink;\n    },\n    set: function set(isLink) {\n      if (this.__isLink == isLink) {\n        return;\n      }\n      this.__isLink = isLink;\n      this.distributeEvent('isLink');\n    }\n  }]);\n\n  return EditorState;\n}(__WEBPACK_IMPORTED_MODULE_1__basic_object_state__[\"a\" /* ObjectState */]);\n\nvar BarButton = function (_RXComponent) {\n  _inherits(BarButton, _RXComponent);\n\n  function BarButton(title, callback) {\n    _classCallCheck(this, BarButton);\n\n    var _this2 = _possibleConstructorReturn(this, (BarButton.__proto__ || Object.getPrototypeOf(BarButton)).call(this));\n\n    _this2.cssClass('mini-button');\n    _this2.domAttr('title', title);\n    _this2.domOn('click', callback);\n    return _this2;\n  }\n\n  return BarButton;\n}(__WEBPACK_IMPORTED_MODULE_0__basic_rxcomponent__[\"a\" /* RXComponent */]);\n\nvar isLink = function isLink() {\n  if (window.getSelection().toString !== '') {\n    var selection = window.getSelection();\n    selection = selection.rangeCount > 0 ? selection.getRangeAt(0) : '';\n    if (selection) {\n      if (selection.startContainer.parentNode.tagName === 'A' || selection.endContainer.parentNode.tagName === 'A') {\n        return true;\n      } else {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  }\n};\n\nvar MiniEditbar = function (_RXComponent2) {\n  _inherits(MiniEditbar, _RXComponent2);\n\n  function MiniEditbar() {\n    _classCallCheck(this, MiniEditbar);\n\n    var _this3 = _possibleConstructorReturn(this, (MiniEditbar.__proto__ || Object.getPrototypeOf(MiniEditbar)).call(this));\n\n    _this3.cssClass('mini-editbar');\n    _this3.hide();\n    _this3.state = new EditorState();\n\n    _this3.domOn('mousedown', function (event) {\n      event.preventDefault();\n    });\n\n    var boldBtn = new BarButton('Bold', function () {\n      document.execCommand('bold', false, null);\n      _this3.updateButtonsState();\n    }).cssClass('icon-button').setInnerHTML('<b>B</b>');\n\n    _this3.pushChild(boldBtn);\n\n    var italicBtn = new BarButton('Italic', function () {\n      document.execCommand('italic', false, null);\n      _this3.state.italic = !_this3.state.italic;\n    }).cssClass('icon-button').setInnerHTML('<i>I</i>');\n    _this3.pushChild(italicBtn);\n\n    var underlineBtn = new BarButton('Underline', function () {\n      document.execCommand('underline', false, null);\n      _this3.updateButtonsState();\n    }).cssClass('icon-button').setInnerHTML('<u>U</u>');\n    _this3.pushChild(underlineBtn);\n\n    var strikeBtn = new BarButton('Strike', function () {\n      document.execCommand('strikeThrough', false, null);\n      _this3.updateButtonsState();\n    }).cssClass('icon-button').setInnerHTML('<strike>S</strike>');\n    _this3.pushChild(strikeBtn);\n\n    var linkBtn = new BarButton('Link', function () {\n      if (_this3.state.isLink) {\n        document.execCommand('unlink', false, null);\n      } else {\n        document.execCommand('createLink', false, '#');\n      }\n      _this3.updateButtonsState();\n    }).cssClass('icon-button').setInnerHTML('<div style=\"transform:rotate(45deg)\">⫘</div>');\n    _this3.pushChild(linkBtn);\n\n    document.onpaste = function (event) {\n      var plainText = event.clipboardData.getData('text/plain').replace(/[\\r\\n]/g, \"<br>\");\n      document.execCommand('insertHTML', false, plainText);\n      return false;\n    };\n\n    document.addEventListener('keydown', function (event) {\n      if (event.keyCode === 13) {\n        document.execCommand('insertHTML', false, '<br>');\n        event.preventDefault();\n        return false;\n      }\n    });\n\n    /*let codeBtn = new BarButton('Switch Code Editor', ()=>{\n        this.updateButtonsState()\n      })\n      .cssClass('icon-button')\n      .setInnerHTML('<div\"><></div>')\n    this.pushChild( codeBtn )\n    let btnInsert = new BarButton('Bootstrap Styles', ()=>{\n      })\n      .cssClass('mini-styles')\n      .setInnerHTML('Insert <span>▾</span>')\n    this.pushChild( btnInsert )*/\n\n    _this3.watchOne('bold', boldBtn);\n    _this3.watchOne('italic', italicBtn);\n    _this3.watchOne('underline', underlineBtn);\n    _this3.watchOne('strikeThrough', strikeBtn);\n    _this3.watchOne('isLink', linkBtn);\n    document.addEventListener('scroll', function (event) {\n      _this3.followElement(_this3.domElement);\n    });\n    window.addEventListener('resize', function (event) {\n      _this3.followElement(_this3.domElement);\n    });\n    return _this3;\n  }\n\n  _createClass(MiniEditbar, [{\n    key: \"watchOne\",\n    value: function watchOne(stateName, btn) {\n      var _this4 = this;\n\n      this.state.watch(stateName, function () {\n        if (_this4.state[stateName]) {\n          btn.cssClass('active');\n        } else {\n          btn.removeCssClass('active');\n        }\n      });\n    }\n  }, {\n    key: \"show\",\n    value: function show(followElement) {\n      var _this5 = this;\n\n      if (!followElement) return;\n      this.followElement(followElement);\n      this.updateButtonsState();\n      document.addEventListener(\"selectionchange\", function (event) {\n        _this5.updateButtonsState();\n      });\n      return _get(MiniEditbar.prototype.__proto__ || Object.getPrototypeOf(MiniEditbar.prototype), \"show\", this).call(this);\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      var _this6 = this;\n\n      document.removeEventListener(\"selectionchange\", function (event) {\n        _this6.updateButtonsState();\n      });\n      return _get(MiniEditbar.prototype.__proto__ || Object.getPrototypeOf(MiniEditbar.prototype), \"hide\", this).call(this);\n    }\n  }, {\n    key: \"updateButtonsState\",\n    value: function updateButtonsState() {\n      if (!this.isShow()) {\n        return;\n      }\n      this.state.bold = document.queryCommandState('bold');\n      this.state.italic = document.queryCommandState('italic');\n      this.state.underline = document.queryCommandState('underline');\n      this.state.strikeThrough = document.queryCommandState('strikeThrough');\n      this.state.isLink = isLink();\n    }\n  }, {\n    key: \"followElement\",\n    value: function followElement(domElement) {\n      if (!domElement) return;\n      this.domElement = domElement;\n      var rect = domElement.getBoundingClientRect();\n      var height = 32;\n      if (this.$dom) {\n        this.$dom.style.left = rect.x - 1 + 'px';\n        if (rect.y < height) {\n          this.$dom.style.top = rect.y + rect.height + 'px';\n        } else {\n          this.$dom.style.top = rect.y - height + 'px';\n        }\n      }\n    }\n  }]);\n\n  return MiniEditbar;\n}(__WEBPACK_IMPORTED_MODULE_0__basic_rxcomponent__[\"a\" /* RXComponent */]);\n\n/***/ }),\n\n/***/ 358:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return NodeParser; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__nodes_class_node_js__ = __webpack_require__(359);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__nodes_tag_node_js__ = __webpack_require__(361);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__nodes_text_node_js__ = __webpack_require__(102);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__rules__ = __webpack_require__(362);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__rules_common_rule__ = __webpack_require__(103);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\n\n\n\nvar NodeParser = function () {\n  function NodeParser() {\n    _classCallCheck(this, NodeParser);\n\n    this.$dom = document.createElement('div');\n  }\n\n  _createClass(NodeParser, [{\n    key: 'parse',\n    value: function parse(html) {\n      this.$dom.innerHTML = html;\n\n      //console.log(this.$dom.childNodes)\n      var nodes = [];\n      for (var i = 0; i < this.$dom.childNodes.length; i++) {\n        var node = this.paraseNode(this.$dom.childNodes[i]);\n        if (node) {\n          nodes.push(node);\n        }\n      }\n      return nodes;\n    }\n  }, {\n    key: 'paraseNode',\n    value: function paraseNode(element, parent) {\n      var node;\n      if (element.nodeType === 3) {\n        var text = element.textContent; //.trim()\n        if (!text) {\n          return '';\n        }\n        var _node = new __WEBPACK_IMPORTED_MODULE_2__nodes_text_node_js__[\"a\" /* TextNode */](text);\n        _node.parent = parent;\n        return _node;\n      }\n\n      //暂不处理注释\n      if (element.nodeType === 8) {\n        return '';\n      }\n\n      if (element.classList.contains('container')) {\n        node = new __WEBPACK_IMPORTED_MODULE_0__nodes_class_node_js__[\"a\" /* ClassNode */]('container');\n      }\n\n      var clssNode = this.parseClassNode(element);\n      node = clssNode ? clssNode : this.parseTagNode(element);\n\n      this.copyClassList(element.classList, node.meta.classList);\n      for (var i = 0; i < element.childNodes.length; i++) {\n        var child = element.childNodes[i];\n\n        var childNode = this.paraseNode(child, node);\n        if (childNode) {\n          node.children.push(childNode);\n        }\n      }\n\n      this.parseAttributes(node, element);\n      node.markDefaultMeta();\n\n      node.parent = parent;\n\n      return node;\n    }\n  }, {\n    key: 'parseAttributes',\n    value: function parseAttributes(node, element) {\n      var attrs = element.attributes;\n      for (var i = 0; i < attrs.length; i++) {\n        var attrName = attrs[i]['nodeName'];\n        var attrValue = attrs[i]['nodeValue'];\n        if (attrName.toLowerCase() !== \"class\") {\n          node.meta.attributes[attrName] = attrValue;\n        }\n      }\n    }\n  }, {\n    key: 'parseClassNode',\n    value: function parseClassNode(element) {\n      for (var ruleName in __WEBPACK_IMPORTED_MODULE_3__rules__[\"a\" /* default */].classRules) {\n        var rule = __WEBPACK_IMPORTED_MODULE_3__rules__[\"a\" /* default */].classRules[ruleName];\n        rule.classes = rule.classes ? rule.classes : [ruleName];\n\n        for (var i = 0; i < rule.classes.length; i++) {\n          var cssClass = rule.classes[i].toLowerCase();\n          if (element.classList.contains(cssClass)) {\n            var node = new __WEBPACK_IMPORTED_MODULE_0__nodes_class_node_js__[\"a\" /* ClassNode */](cssClass);\n            node.meta.tag = element.tagName.toLowerCase();\n            node.setLabel(rule.label ? rule.label : ruleName);\n            node.ruleName = ruleName;\n            node.rule = rule;\n            return node;\n          }\n        }\n      }\n    }\n  }, {\n    key: 'parseTagNode',\n    value: function parseTagNode(element) {\n      var node;\n      var elTag = element.tagName.toLowerCase();\n      for (var ruleName in __WEBPACK_IMPORTED_MODULE_3__rules__[\"a\" /* default */].tagRules) {\n        var rule = __WEBPACK_IMPORTED_MODULE_3__rules__[\"a\" /* default */].tagRules[ruleName];\n        rule.tags = rule.tags ? rule.tags : [ruleName];\n        for (var i = 0; i < rule.tags.length; i++) {\n          var tag = rule.tags[i];\n          if (elTag === tag.toLowerCase()) {\n            node = new __WEBPACK_IMPORTED_MODULE_1__nodes_tag_node_js__[\"a\" /* TagNode */](tag);\n            node.setLabel(rule.label ? rule.label : ruleName);\n            node.ruleName = ruleName;\n            node.rule = rule;\n            return node;\n          }\n        }\n      }\n      node = new __WEBPACK_IMPORTED_MODULE_1__nodes_tag_node_js__[\"a\" /* TagNode */](elTag);\n      node.ruleName = elTag;\n      node.rule = Object.assign({}, __WEBPACK_IMPORTED_MODULE_4__rules_common_rule__[\"a\" /* default */]);\n      return node;\n    }\n  }, {\n    key: 'copyClassList',\n    value: function copyClassList(from, to) {\n      from.forEach(function (cssClass) {\n        if (cssClass.indexOf('rx-_-') !== 0) {\n          to.push(cssClass);\n        }\n      });\n    }\n  }]);\n\n  return NodeParser;\n}();\n\n/***/ }),\n\n/***/ 359:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return ClassNode; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__rxnode_js__ = __webpack_require__(101);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__basic_rxarray__ = __webpack_require__(5);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\nvar ClassNode = function (_RXNode) {\n  _inherits(ClassNode, _RXNode);\n\n  function ClassNode(cssClass) {\n    _classCallCheck(this, ClassNode);\n\n    //add(cssClass, this.meta.classList)\n    var _this = _possibleConstructorReturn(this, (ClassNode.__proto__ || Object.getPrototypeOf(ClassNode)).call(this));\n\n    _this.cssClass = cssClass;\n    return _this;\n  }\n\n  _createClass(ClassNode, [{\n    key: \"make\",\n    value: function make() {\n      return new ClassNode(this.cssClass);\n    }\n  }]);\n\n  return ClassNode;\n}(__WEBPACK_IMPORTED_MODULE_0__rxnode_js__[\"a\" /* RXNode */]);\n\n/***/ }),\n\n/***/ 360:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return CharNode; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__node_js__ = __webpack_require__(46);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__basic_rxarray__ = __webpack_require__(5);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\nvar CharNode = function (_Node) {\n  _inherits(CharNode, _Node);\n\n  function CharNode(char, parent) {\n    _classCallCheck(this, CharNode);\n\n    var _this = _possibleConstructorReturn(this, (CharNode.__proto__ || Object.getPrototypeOf(CharNode)).call(this));\n\n    _this.parent = parent;\n    _this.char = char;\n    _this.isCharNode = true;\n    _this.rule = {};\n    _this.rule.acceptedChildren = [];\n    _this.rule.editMarginStyle = {};\n    _this.rule.dropInMargin = 5;\n    return _this;\n  }\n\n  _createClass(CharNode, [{\n    key: 'make',\n    value: function make() {\n      return new CharNode();\n    }\n  }, {\n    key: 'changeTextnodeToCharNode',\n    value: function changeTextnodeToCharNode() {}\n  }, {\n    key: 'toViewModel',\n    value: function toViewModel() {\n      return {\n        styles: {},\n        classList: ['char-node'],\n        attributes: {},\n        innerHTML: this.char,\n        tag: 'span',\n        on: {\n          onmousemove: this.mousemove,\n          onmouseover: this.mouseover,\n          onmouseout: this.mouseout\n          //onclick:this.onclick,\n        }\n      };\n    }\n  }]);\n\n  return CharNode;\n}(__WEBPACK_IMPORTED_MODULE_0__node_js__[\"a\" /* Node */]);\n\n/***/ }),\n\n/***/ 361:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return TagNode; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__rxnode_js__ = __webpack_require__(101);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\nvar TagNode = function (_RXNode) {\n  _inherits(TagNode, _RXNode);\n\n  function TagNode(tag) {\n    _classCallCheck(this, TagNode);\n\n    var _this = _possibleConstructorReturn(this, (TagNode.__proto__ || Object.getPrototypeOf(TagNode)).call(this));\n\n    _this.meta.tag = tag;\n    _this.label = tag;\n    _this.labelToCapitalize();\n    return _this;\n  }\n\n  _createClass(TagNode, [{\n    key: 'make',\n    value: function make() {\n      var node = new TagNode(this.meta.tag);\n      node.label = this.label;\n      return node;\n    }\n  }]);\n\n  return TagNode;\n}(__WEBPACK_IMPORTED_MODULE_0__rxnode_js__[\"a\" /* RXNode */]);\n\n/***/ }),\n\n/***/ 362:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__container__ = __webpack_require__(363);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__row__ = __webpack_require__(364);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__col__ = __webpack_require__(365);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__heading__ = __webpack_require__(366);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__common_rule__ = __webpack_require__(103);\n\n\n\n\n\n\n//ruleName:\n// -container\n// -row\n// -col\n// -heading\n\n//用于判断的规则token， 全部小写，不接受大写\n//Label为空，表示label使用类名字\n//- label:''\n//空表示所有都接受，空数组表示都不接受\n//- acceptedChildren : '',\n//空和空数组都表示所有都不排除\n//- rejectChildren : '',\n//在这个边界内算是拖入内部\n//  '--responsive--' 需要根据屏幕大小被替换成 '','-sm', '-md', '-lg', '-xl'\n//classes 为空表示单一类命，跟ID一致\n//tags 为空表示tag，跟ID一致\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  classRules: {\n    \"container\": __WEBPACK_IMPORTED_MODULE_0__container__[\"a\" /* default */],\n    \"row\": __WEBPACK_IMPORTED_MODULE_1__row__[\"a\" /* default */],\n    \"col\": __WEBPACK_IMPORTED_MODULE_2__col__[\"a\" /* default */],\n    \"w-100\": Object.assign({}, __WEBPACK_IMPORTED_MODULE_4__common_rule__[\"a\" /* default */]),\n    \"alert\": Object.assign({}, __WEBPACK_IMPORTED_MODULE_4__common_rule__[\"a\" /* default */])\n  },\n\n  tagRules: {\n    heading: __WEBPACK_IMPORTED_MODULE_3__heading__[\"a\" /* default */]\n  }\n});\n\n/***/ }),\n\n/***/ 363:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  dropInMargin: 10,\n  editable: false,\n  editMarginStyle: {\n    paddingX: '30px',\n    paddingY: '30px'\n  },\n  //没有子元素，显示空白\n  empertyMargin: true,\n\n  rejectChildren: ['col', 'thead', 'tbody', 'th', 'tr', 'td']\n});\n\n/***/ }),\n\n/***/ 364:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  dropInMargin: 10,\n  editable: false,\n  editMarginStyle: {\n    paddingX: '20px',\n    paddingY: '20px'\n  },\n  //没有子元素，显示空白\n  empertyMargin: true,\n  acceptChildren: ['col', 'w-100']\n});\n\n/***/ }),\n\n/***/ 365:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  label: 'column',\n  dropInMargin: 10,\n  editable: true,\n  editMarginStyle: {\n    paddingX: '20px',\n    paddingY: '20px'\n  },\n  //没有子元素，显示空白\n  empertyMargin: true,\n  classes: ['col', 'col-1', 'col-2', 'col-3', 'col-4', 'col-5', 'col-6', 'col-7', 'col-8', 'col-9', 'col-10', 'col-11', 'col-12', 'col-sm', 'col-sm-1', 'col-sm-2', 'col-sm-3', 'col-sm-4', 'col-sm-5', 'col-sm-6', 'col-sm-7', 'col-sm-8', 'col-sm-9', 'col-sm-10', 'col-sm-11', 'col-sm-12', 'col-md', 'col-md-1', 'col-md-2', 'col-md-3', 'col-md-4', 'col-md-5', 'col-md-6', 'col-md-7', 'col-md-8', 'col-md-9', 'col-md-10', 'col-md-11', 'col-md-12', 'col-lg', 'col-lg-1', 'col-lg-2', 'col-lg-3', 'col-lg-4', 'col-lg-5', 'col-lg-6', 'col-lg-7', 'col-lg-8', 'col-lg-9', 'col-lg-10', 'col-lg-11', 'col-lg-12', 'col-xl', 'col-xl-1', 'col-xl-2', 'col-xl-3', 'col-xl-4', 'col-xl-5', 'col-xl-6', 'col-xl-7', 'col-xl-8', 'col-xl-9', 'col-xl-10', 'col-xl-11', 'col-xl-12'],\n  rejectChildren: ['col', 'thead', 'tbody', 'th', 'tr', 'td']\n});\n\n/***/ }),\n\n/***/ 366:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  label: \"Heading\",\n  tags: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'],\n  editable: true,\n  editMarginStyle: {\n    paddingX: '5px',\n    paddingY: '5px'\n  }\n});\n\n/***/ }),\n\n/***/ 46:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Node; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__node_view__ = __webpack_require__(349);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__basic_rxarray__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__node_state__ = __webpack_require__(350);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\n\nfunction insterAfterDom(newElement, targetElement) {\n  var parent = targetElement.parentNode;\n  if (parent.lastChild == targetElement) {\n    parent.appendChild(newElement);\n  } else {\n    parent.insertBefore(newElement, targetElement.nextSibling);\n  }\n}\n\nvar Node = function () {\n  function Node() {\n    var _this = this;\n\n    _classCallCheck(this, Node);\n\n    this.seedId();\n    //this.mouseFollowerWidth =  '200px'\n    this.children = [];\n    this.view = new __WEBPACK_IMPORTED_MODULE_0__node_view__[\"a\" /* NodeView */]();\n\n    //基础数据，持久化也是这部分数据\n    this.meta = {\n      tag: 'div',\n      classList: [],\n      styles: {},\n      attributes: {}\n    };\n\n    this.defaultMeta = {\n      tag: 'div',\n      classList: [],\n      styles: {},\n      attributes: {}\n    };\n\n    this.initStates();\n\n    this.mouseFollower = {\n      offsetX: 10,\n      offsetY: 0\n    };\n\n    this.begindrag = function (event) {\n      event.stopPropagation();\n      _this.state.onBegindrag(event);\n    };\n\n    this.begindragLabel = function (event) {\n      if (_this.view.$dom) {\n        _this.mouseFollower.offsetX = event.offsetX;\n        _this.mouseFollower.offsetY = -18 + event.offsetY;\n      }\n      _this.begindrag(event);\n    };\n\n    this.begindragIcon = function (event) {\n      if (_this.view.$dom) {\n        _this.mouseFollower.offsetX = _this.view.$dom.clientWidth - 96 + event.offsetX;\n        _this.mouseFollower.offsetY = -24 + event.offsetY;\n      }\n      _this.begindrag(event);\n    };\n\n    this.mousemove = function (event) {\n      event.stopPropagation();\n      _this.state.onMousemove(event);\n      rxEditor.canvasMouseMove(event);\n    };\n    this.mouseover = function (event) {\n      event.stopPropagation();\n      _this.state.onMouseover(event);\n    };\n    this.mouseout = function (event) {\n      event.stopPropagation();\n      _this.state.onMouseout(event);\n    };\n\n    this.onclick = function (event) {\n      event.stopPropagation();\n      _this.state.onClick(event);\n    };\n\n    this.duplicate = function () {\n      _this.changeToState('normalState');\n      rxEditor.commandManager.duplicate(_this);\n      rxEditor.render();\n    };\n\n    this.up = function (event) {\n      if (_this.parent) {\n        _this.changeToState('normalState');\n        _this.parent.changeToState('focusState');\n        event.stopPropagation();\n      }\n    };\n\n    this.delete = function () {\n      //if(confirm(\"Are you sure to delete?\")){\n      _this.changeToState('normalState');\n      rxEditor.commandManager.deleteNode(_this);\n      rxEditor.render();\n      //}\n    };\n\n    this.stateChanged = function (oldState, newState) {\n      oldState.leave();\n      newState.enter();\n      rxEditor.nodeStateChanged(_this, oldState, newState);\n    };\n  }\n\n  _createClass(Node, [{\n    key: \"seedId\",\n    value: function seedId() {\n      if (!Node.idSeed) Node.idSeed = 1;\n      Node.idSeed++;\n      this.id = Node.idSeed;\n    }\n  }, {\n    key: \"initStates\",\n    value: function initStates() {\n      this.normalState = new __WEBPACK_IMPORTED_MODULE_2__node_state__[\"g\" /* NormalState */](this);\n      this.activeState = new __WEBPACK_IMPORTED_MODULE_2__node_state__[\"a\" /* ActiveState */](this);\n      this.focusState = new __WEBPACK_IMPORTED_MODULE_2__node_state__[\"f\" /* FocusState */](this);\n      this.dragoverState = new __WEBPACK_IMPORTED_MODULE_2__node_state__[\"d\" /* DragoverState */](this);\n      this.draggedState = new __WEBPACK_IMPORTED_MODULE_2__node_state__[\"c\" /* DraggedState */](this);\n      this.disableState = new __WEBPACK_IMPORTED_MODULE_2__node_state__[\"b\" /* DisableState */](this);\n      this.editState = new __WEBPACK_IMPORTED_MODULE_2__node_state__[\"e\" /* EditState */](this);\n      this.previewState = new __WEBPACK_IMPORTED_MODULE_2__node_state__[\"h\" /* PreviewState */](this);\n      this.state = this.normalState;\n    }\n  }, {\n    key: \"markDefaultMeta\",\n    value: function markDefaultMeta() {\n      this.defaultMeta.tag = this.meta.tag;\n      this.defaultMeta.classList = this.meta.classList.concat();\n      this.defaultMeta.attributes = Object.assign({}, this.meta.attributes);\n      this.defaultMeta.styles = Object.assign({}, this.meta.styles);\n    }\n  }, {\n    key: \"changeToState\",\n    value: function changeToState(stateName) {\n      if (this.state === this[stateName]) return;\n      var oldState = this.state;\n      this.state = this[stateName];\n      this.refreshState();\n      this.stateChanged(oldState, this[stateName]);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      this.view.render(this.toViewModel(), this.getParentViewDomElement());\n      this.children.forEach(function (child) {\n        child.render();\n      });\n    }\n  }, {\n    key: \"renderHtml\",\n    value: function renderHtml(parentDomElement) {\n      var dom = this.view.renderHtml(this.toHtmlModel(), parentDomElement);\n      this.children.forEach(function (child) {\n        child.renderHtml(dom);\n      });\n\n      parentDomElement.appendChild(dom);\n      return dom;\n    }\n  }, {\n    key: \"refreshState\",\n    value: function refreshState() {\n      this.view.refreshState(this.toViewModel());\n      this.children.forEach(function (child) {\n        child.refreshState();\n      });\n    }\n  }, {\n    key: \"clearDraggedoverStates\",\n    value: function clearDraggedoverStates() {\n      if (this.state === this.dragoverState) {\n        this.changeToState('normalState');\n      }\n      this.children.forEach(function (child) {\n        child.clearDraggedoverStates();\n      });\n    }\n  }, {\n    key: \"clearActiveStates\",\n    value: function clearActiveStates() {\n      if (this.state === this.activeState) {\n        this.changeToState('normalState');\n      }\n      this.children.forEach(function (child) {\n        child.clearActiveStates();\n      });\n    }\n  }, {\n    key: \"clearFocusAndEditStates\",\n    value: function clearFocusAndEditStates() {\n      if (this.state === this.focusState || this.state === this.editState) {\n        this.changeToState('normalState');\n      }\n      this.children.forEach(function (child) {\n        child.clearFocusAndEditStates();\n      });\n    }\n  }, {\n    key: \"allToNormalState\",\n    value: function allToNormalState() {\n      this.changeToState('normalState');\n      this.children.forEach(function (child) {\n        child.allToNormalState();\n      });\n    }\n  }, {\n    key: \"draggedToFoused\",\n    value: function draggedToFoused() {\n      if (this.state === this.draggedState) {\n        this.changeToState('focusState');\n      }\n      this.children.forEach(function (child) {\n        child.draggedToFoused();\n      });\n    }\n  }, {\n    key: \"getParentViewDomElement\",\n    value: function getParentViewDomElement() {\n      return this.parent.view.$dom;\n    }\n  }, {\n    key: \"firstChild\",\n    value: function firstChild() {\n      return Object(__WEBPACK_IMPORTED_MODULE_1__basic_rxarray__[\"e\" /* first */])(this.children);\n    }\n  }, {\n    key: \"nextSbiling\",\n    value: function nextSbiling() {\n      if (this.parent) {\n        return Object(__WEBPACK_IMPORTED_MODULE_1__basic_rxarray__[\"b\" /* after */])(this, this.parent.children);\n      }\n    }\n  }, {\n    key: \"previousSbiling\",\n    value: function previousSbiling() {\n      if (this.parent) {\n        return Object(__WEBPACK_IMPORTED_MODULE_1__basic_rxarray__[\"c\" /* before */])(this, this.parent.children);\n      }\n    }\n  }, {\n    key: \"moveInTop\",\n    value: function moveInTop(targetParent) {\n      if (Object(__WEBPACK_IMPORTED_MODULE_1__basic_rxarray__[\"e\" /* first */])(targetParent.children) !== this) {\n        this.removeFromParent();\n        targetParent.unshiftChild(this);\n        targetParent.render();\n      }\n    }\n  }, {\n    key: \"moveIn\",\n    value: function moveIn(targetParent) {\n      if (Object(__WEBPACK_IMPORTED_MODULE_1__basic_rxarray__[\"h\" /* last */])(targetParent.children) !== this) {\n        this.removeFromParent();\n        targetParent.pushChild(this);\n        targetParent.render();\n      }\n    }\n  }, {\n    key: \"moveBefore\",\n    value: function moveBefore(brother) {\n      if (Object(__WEBPACK_IMPORTED_MODULE_1__basic_rxarray__[\"c\" /* before */])(brother, this.children) !== this) {\n        this.removeFromParent();\n        this.parent = brother.parent;\n        Object(__WEBPACK_IMPORTED_MODULE_1__basic_rxarray__[\"g\" /* insertBefore */])(this, brother, brother.parent.children);\n        this.parent.render();\n      }\n    }\n  }, {\n    key: \"moveAfter\",\n    value: function moveAfter(brother) {\n      if (Object(__WEBPACK_IMPORTED_MODULE_1__basic_rxarray__[\"b\" /* after */])(brother, this.children) !== this) {\n        this.removeFromParent();\n        this.parent = brother.parent;\n        Object(__WEBPACK_IMPORTED_MODULE_1__basic_rxarray__[\"f\" /* insertAfter */])(this, brother, brother.parent.children);\n        this.parent.render();\n      }\n    }\n  }, {\n    key: \"removeFromParent\",\n    value: function removeFromParent() {\n      if (this.parent) {\n        Object(__WEBPACK_IMPORTED_MODULE_1__basic_rxarray__[\"i\" /* remove */])(this, this.parent.children);\n        this.parent.render();\n      }\n    }\n  }, {\n    key: \"unshiftChild\",\n    value: function unshiftChild(child) {\n      child.parent = this;\n      this.children.unshift(child);\n      return this;\n    }\n  }, {\n    key: \"pushChild\",\n    value: function pushChild(child) {\n      child.parent = this;\n      Object(__WEBPACK_IMPORTED_MODULE_1__basic_rxarray__[\"a\" /* add */])(child, this.children);\n      return this;\n    }\n  }, {\n    key: \"insertAfterSelf\",\n    value: function insertAfterSelf(brother) {\n      brother.parent = this.parent;\n      Object(__WEBPACK_IMPORTED_MODULE_1__basic_rxarray__[\"f\" /* insertAfter */])(brother, this, this.parent.children);\n      return this;\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      var copy = this.make();\n      // /console.log(copy)\n      copy.rule = JSON.parse(JSON.stringify(this.rule));\n      copy.ruleName = this.ruleName;\n      this.children.forEach(function (child) {\n        copy.pushChild(child.clone());\n      });\n      return copy;\n    }\n  }, {\n    key: \"canAccept\",\n    value: function canAccept(child) {\n      var acceptedChildren = this.rule ? this.rule.acceptedChildren : '';\n      if (acceptedChildren && acceptedChildren.length == 0) {\n        return false;\n      }\n\n      if (acceptedChildren && !this.containsInAccepted(child)) {\n        return false;\n      }\n\n      if (!acceptedChildren && this.containsInExcept(child)) {\n        return false;\n      }\n      return true;\n    }\n  }, {\n    key: \"containsInAccepted\",\n    value: function containsInAccepted(child) {\n      var childRuleName = child.ruleName;\n      var acceptedChildren = this.rule ? this.rule.acceptedChildren : '';\n      for (var i = 0; i < acceptedChildren.length; i++) {\n        if (acceptedChildren[i] === childRuleName) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n  }, {\n    key: \"containsInExcept\",\n    value: function containsInExcept(child) {\n      var childRuleName = child.ruleName;\n      var rejectChildren = this.rule ? this.rule.rejectChildren : '';\n      if (rejectChildren) {\n        for (var i = 0; i < rejectChildren.length; i++) {\n          if (rejectChildren[i] === childRuleName) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    }\n  }, {\n    key: \"toViewModel\",\n    value: function toViewModel() {\n      var model = this.state.stateModel();\n\n      model.on = {\n        onmousemove: this.mousemove,\n        onmouseover: this.mouseover,\n        onmouseout: this.mouseout,\n        //onmouseup:this.mouseup,\n        onclick: this.onclick\n      };\n\n      return model;\n    }\n  }, {\n    key: \"toHtmlModel\",\n    value: function toHtmlModel() {\n      return {\n        styles: {},\n        classList: [], //new RXArray,\n        attributes: {}\n      };\n    }\n  }, {\n    key: \"toTreeViewNode\",\n    value: function toTreeViewNode() {\n      var view = {\n        label: this.label,\n        tag: this.meta.tag,\n        id: this.id,\n        state: this.getStateName(),\n        children: []\n      };\n\n      this.children.forEach(function (child) {\n        var childView = child.toTreeViewNode();\n        if (childView) {\n          view.children.push(childView);\n        }\n      });\n\n      return view;\n    }\n  }, {\n    key: \"getStateName\",\n    value: function getStateName() {\n      if (this.state === this.normalState) {\n        return 'normalState';\n      }\n      if (this.state === this.activeState) {\n        return 'activeState';\n      }\n      if (this.state === this.focusState) {\n        return 'focusState';\n      }\n      if (this.state === this.dragoverState) {\n        return 'dragoverState';\n      }\n      if (this.state === this.draggedState) {\n        return 'draggedState';\n      }\n      if (this.state === this.disableState) {\n        return 'disableState';\n      }\n    }\n  }, {\n    key: \"nodeChanged\",\n    value: function nodeChanged(node) {\n      if (this.id === node.id) {\n        rxEditor.commandManager.changeNode(this, node);\n        return;\n      }\n\n      this.children.forEach(function (child) {\n        child.nodeChanged(node);\n      });\n    }\n  }, {\n    key: \"focusNode\",\n    value: function focusNode(node) {\n      if (node.id === this.id) {\n        this.changeToState('focusState');\n      } else {\n        this.changeToState('normalState');\n      }\n      this.children.forEach(function (child) {\n        child.focusNode(node);\n      });\n    }\n  }, {\n    key: \"clearCharNodes\",\n    value: function clearCharNodes() {\n      this.children.forEach(function (child) {\n        child.clearCharNodes();\n      });\n    }\n  }, {\n    key: \"getNodeById\",\n    value: function getNodeById(id) {\n      if (id === this.id) {\n        return this;\n      }\n\n      for (var i in this.children) {\n        var node = this.children[i].getNodeById(id);\n        if (node) {\n          return node;\n        }\n      }\n    }\n  }, {\n    key: \"preview\",\n    value: function preview() {\n      this.changeToState('previewState');\n      this.children.forEach(function (child) {\n        child.preview();\n      });\n    }\n  }]);\n\n  return Node;\n}();\n\n/***/ }),\n\n/***/ 5:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"e\"] = first;\n/* harmony export (immutable) */ __webpack_exports__[\"h\"] = last;\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = before;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = after;\n/* harmony export (immutable) */ __webpack_exports__[\"g\"] = insertBefore;\n/* harmony export (immutable) */ __webpack_exports__[\"f\"] = insertAfter;\n/* harmony export (immutable) */ __webpack_exports__[\"i\"] = remove;\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = add;\n/* harmony export (immutable) */ __webpack_exports__[\"d\"] = contains;\n/* harmony export (immutable) */ __webpack_exports__[\"j\"] = tongleOnCondition;\n/* unused harmony export clear */\nfunction first(array) {\n  if (array.length > 0) {\n    return array[0];\n  }\n}\n\nfunction last(array) {\n  if (array.length > 0) {\n    return array[array.length - 1];\n  }\n}\n\nfunction before(refence, array) {\n  for (var i = 0; i < array.length; i++) {\n    if (array[i] === refence && i > 0) {\n      return array[i - 1];\n    }\n  }\n}\n\nfunction after(refence, array) {\n  for (var i = 0; i < array.length; i++) {\n    if (array[i] === refence && i < array.length) {\n      return array[i + 1];\n    }\n  }\n}\n\nfunction insertBefore(child, refence, array) {\n  for (var i = 0; i < array.length; i++) {\n    if (array[i] === refence) {\n      array.splice(i, 0, child);\n      return;\n    }\n  }\n\n  array.push(child);\n}\n\nfunction insertAfter(child, refence, array) {\n  for (var i = 0; i < array.length; i++) {\n    if (array[i] === refence) {\n      array.splice(i + 1, 0, child);\n      return;\n    }\n  }\n}\n\nfunction remove(node, array) {\n  for (var i = 0; i < array.length; i++) {\n    if (array[i] === node) {\n      array.splice(i, 1);\n      break;\n    }\n  }\n}\n\nfunction add(node, array) {\n  if (!contains(node, array)) {\n    array.push(node);\n  }\n}\n\nfunction contains(node, array) {\n  for (var i = 0; i < array.length; i++) {\n    if (array[i] === node) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction tongleOnCondition(condition, node, array) {\n  if (condition) {\n    add(node, array);\n  } else {\n    remove(node, array);\n  }\n}\n\nfunction clear(array) {\n  array.length = 0;\n}\n\n/***/ }),\n\n/***/ 99:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return ObjectState; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__rxarray__ = __webpack_require__(5);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\nvar ObjectState = function () {\n  function ObjectState() {\n    _classCallCheck(this, ObjectState);\n\n    this.envetHandlers = {};\n  }\n\n  _createClass(ObjectState, [{\n    key: 'watch',\n    value: function watch(attribute, callbackFunction) {\n      if (!this.envetHandlers[attribute]) {\n        this.envetHandlers[attribute] = [];\n      }\n      if (!Object(__WEBPACK_IMPORTED_MODULE_0__rxarray__[\"d\" /* contains */])(callbackFunction, this.envetHandlers[attribute])) {\n        this.envetHandlers[attribute].push(callbackFunction);\n      }\n    }\n  }, {\n    key: 'cancelWatch',\n    value: function cancelWatch(attribute, callbackFunction) {\n      console.assert(this.envetHandlers[attribute], 'EditorState: did not register this event handler');\n      Object(__WEBPACK_IMPORTED_MODULE_0__rxarray__[\"i\" /* remove */])(callbackFunction, this.envetHandlers[attribute]);\n    }\n  }, {\n    key: 'distributeEvent',\n    value: function distributeEvent(attribute) {\n      this.distributeEventWithoutGlobal(attribute);\n      this.distributeEventWithoutGlobal('changed'); //全局事件\n    }\n  }, {\n    key: 'distributeEventWithoutGlobal',\n    value: function distributeEventWithoutGlobal(attribute) {\n      var _this = this;\n\n      var handlers = this.envetHandlers[attribute];\n      if (handlers) {\n        handlers.forEach(function (handler) {\n          handler(_this);\n        });\n      }\n    }\n  }]);\n\n  return ObjectState;\n}();\n\n/***/ })\n\n/******/ });\n\n\n// WEBPACK FOOTER //\n// core.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 345);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b7c3671963940b8dcca7","export class RXEditorCommandProxy{\n  constructor(pageId){\n    this.pageId = pageId\n    window.addEventListener(\"message\", (event)=>{\n      if(this.pageId === event.data.pageId){\n        this.handleMessage(event.data)\n      }\n    });\n\n    this.focusNode = (node, pageId)=>{\n      this.sendMessage({\n        name: 'focusNode',\n        pageId: pageId,\n        node:{\n          id:node.id,\n          ruleName:node.ruleName,\n          meta:node.meta,\n          defaultMeta:node.defaultMeta,\n          optionsSchema:node.rule.optionsSchema,\n          htmlCode:node.htmlCode,\n        }\n      })\n    }\n\n    this.unFocusNode = (node)=>{\n      this.sendMessage({\n        name: 'unFocusNode',\n        id: node.id,\n      })\n    }\n\n    document.addEventListener('mouseup', (event)=>{\n      this.sendMessage({\n        name: 'canvasMouseup',\n      })\n    })\n\n    document.addEventListener('mousemove', (event)=>{\n      this.canvasMouseMove(event)\n    })\n\n  }\n\n  canvasMouseMove(event){\n    this.sendMessage({\n      name: 'canvasMouseMove',\n      event: {\n        screenX: event.screenX,\n        screenY: event.screenY,\n      },\n    })\n  }\n\n  rxeditorReady(){\n    this.sendMessage({\n      name: 'rxeditorReady'\n    })\n  }\n\n  commandExcuted(canUndo, canRedo, commandSchema){\n    this.sendMessage({\n      name: 'commandExcuted',\n      canUndo: canUndo,\n      canRedo:canRedo,\n      commandSchema: commandSchema,\n    })\n  }\n\n  takeOverDraggingByWorkspace(){\n    this.sendMessage({\n      name: 'takeOverDraggingByWorkspace'\n    })\n  }\n\n  saveCodeFiles(innerHTML, json){\n    this.sendMessage({\n      name: 'saveCodeFiles',\n      innerHTML:innerHTML,\n      json:json,\n    })\n  }\n\n\n  handleMessage(message){\n    //console.log('received:' + message.name + \":\" + message.rxNameId)\n    switch (message.name) {\n      case 'requestAssemble':\n        let loadedData = this.serveForRXEditor.assembleWithTheme(message.theme)\n        this.sendMessage({\n          name: 'replyAssemble',\n          toolbox: loadedData.toolbox,\n          treeViewNodes: loadedData.treeViewNodes,\n        })\n        break;\n      case 'draggingFromToolbox':\n        this.serveForRXEditor.dragFromToolbox(message.item)\n        break;\n      case 'endDragFromToolbox':\n        this.serveForRXEditor.endDragFromToolbox(message.rxNameId)\n        break;\n      case 'changeCanvasState':\n        this.serveForRXEditor.changeCanvasState(message.state)\n        break;\n      case 'nodeChanged':\n        this.serveForRXEditor.nodeChanged(message.node)\n        break;\n      case 'undo':\n        this.serveForRXEditor.undo()\n        break;\n      case 'redo':\n        this.serveForRXEditor.redo()\n        break;\n      //case 'download':\n      //  this.serveForRXEditor.download()\n      //  break;\n      case 'clearCanvas':\n        this.serveForRXEditor.clearCanvas()\n        break;\n      case 'changeTheme':\n        this.serveForRXEditor.changeTheme(message.theme)\n        break;\n      case 'focusNodeFromShell':\n        this.serveForRXEditor.focusNodeFromShell(message.node)\n        break;\n      case 'duplicateNodeFromShell':\n        this.serveForRXEditor.duplicateNodeFromShell(message.id)\n        break;\n      case 'removeNodeFromShell':\n        this.serveForRXEditor.removeNodeFromShell(message.id)\n        break;\n      case 'requestHtmlCode':\n        let htmlCode = this.serveForRXEditor.requestHtmlCode()\n        this.sendMessage({\n          name: 'replyHtmlCode',\n          htmlCode: htmlCode,\n        })\n        break;\n      case 'loadHtml':\n        this.serveForRXEditor.loadHtml(message.html, message.id)\n        break;\n      case 'setInlineFile':\n        this.serveForRXEditor.setInlineFile(message.file)\n        break;\n    }\n  }\n\n\n  sendMessage(message){\n    message.pageId = this.pageId\n    message.canvasHeight = document.body.scrollHeight\n    window.parent.postMessage(message, '/');    \n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/rxeditor-command-proxy.js","import {Node} from \"../node\"\r\nimport {TextNode} from \"./text-node\"\r\n\r\nexport class RXNode extends Node{\r\n  constructor() {\r\n    super()\r\n\r\n  }\r\n\r\n\r\n  clone(){\r\n    let copy = super.clone()\r\n    copy.meta = JSON.parse(JSON.stringify(this.meta))\r\n    copy.defaultMeta = JSON.parse(JSON.stringify(this.defaultMeta))\r\n    copy.label = this.label\r\n\r\n    return copy\r\n  }\r\n\r\n  setLabel(label){\r\n    this.label = label\r\n    this.labelToCapitalize()\r\n    return this\r\n  }\r\n\r\n  labelToCapitalize(){\r\n    let label = this.label\r\n    this.label = label.replace(label[0], label[0].toUpperCase())\r\n  }\r\n\r\n\r\n  toViewModel(){\r\n    let model = super.toViewModel()\r\n    this.baseMetaToModel(model)\r\n\r\n\r\n    if(this.meta.innerHTML){\r\n      model.innerHTML = this.meta.innerHTML\r\n    }\r\n\r\n    return model\r\n  }\r\n\r\n  toHtmlModel(){\r\n    let model = super.toHtmlModel()\r\n    this.baseMetaToModel(model)\r\n    return model\r\n  }\r\n\r\n  baseMetaToModel(model){\r\n    let meta = this.meta\r\n    model.tag = meta.tag\r\n    model.innerHTML = meta.innerHTML\r\n    model.classList.push.apply(model.classList, meta.classList)\r\n    Object.assign(model.styles, meta.styles)\r\n    Object.assign(model.attributes, meta.attributes)\r\n  }\r\n\r\n  setTag(tag){\r\n    return this.setField('tag', tag)\r\n  }\r\n\r\n  addClass(className){\r\n    if(!className){\r\n      return this\r\n    }\r\n    this.meta.classList.push(className)\r\n    return this\r\n  }\r\n\r\n  setAttribute(attrName, value){\r\n    this.meta.attributes[attrName] = value\r\n    return this\r\n  }\r\n\r\n  changeTextnodeToCharNode(){\r\n    let children = []\r\n    this.children.forEach(child=>{\r\n      if(child.isTextNode){\r\n        children.push.apply(children, child.charNodes())\r\n        this.isCharState = true\r\n      }\r\n      else{\r\n        children.push(child)\r\n      }\r\n    })\r\n\r\n    this.children = children\r\n    this.render()\r\n  }\r\n\r\n  changeCharNodeToTextNode(){\r\n    let children = []\r\n    var textNode = null\r\n    this.children.forEach(child=>{\r\n      if(child.isCharNode){\r\n        let prev = child.previousSbiling()\r\n        if(!prev || !prev.isCharNode){\r\n          textNode = new TextNode('')\r\n          textNode.parent = this\r\n          children.push(textNode)\r\n        }\r\n\r\n        textNode.text += child.char\r\n      }\r\n      else{\r\n        children.push(child)\r\n      }\r\n    })    \r\n    this.children = children\r\n    this.render()\r\n    this.isCharState = false\r\n  }\r\n\r\n  clearCharNodes(){\r\n    if(this.isCharState){\r\n      this.changeCharNodeToTextNode()\r\n    }\r\n    super.clearCharNodes()\r\n  }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/nodes/rxnode.js","import {CharNode} from \"./char-node\"\r\n\r\nexport class TextNode{\r\n  constructor(text) {\r\n  \tthis.text = text\r\n    this.seedId()\r\n    this.isTextNode = true\r\n\t}\r\n  seedId(){\r\n    if(!TextNode.idSeed) TextNode.idSeed = 1\r\n    TextNode.idSeed ++\r\n    this.id = \"text\" + TextNode.idSeed\r\n  }\r\n\r\n  make(){\r\n    return new TextNode(this.text)\r\n  }\r\n\r\n  clone(){\r\n    let copy = this.make()\r\n    return copy\r\n  }\r\n\r\n  getParentViewDomElement(){\r\n    return this.parent.view.$dom\r\n  }\r\n\r\n  render(){\r\n    //this.view.render(this.toViewModel(), this.getParentViewDomElement())\r\n    let parentDom = this.getParentViewDomElement()\r\n    if(parentDom){\r\n    \tparentDom.appendChild(document.createTextNode(this.text))\r\n    }\r\n  }\r\n\r\n  renderHtml(parentDomElement){\r\n    if(parentDomElement){\r\n      parentDomElement.appendChild(document.createTextNode(this.text))\r\n    }\r\n  }\r\n\r\n\r\n  renderMouseFollower(parentDomElement){\r\n    let mouseFollower = document.createTextNode(this.text)\r\n    parentDomElement.appendChild(mouseFollower)\r\n    return mouseFollower\r\n  }\r\n\r\n  preview(){}\r\n\r\n  nodeChanged(){}\r\n\r\n  refreshState(){}\r\n\r\n  clearDraggedoverStates(){}\r\n\r\n  clearActiveStates(){}\r\n\r\n  clearFocusAndEditStates(){}\r\n\r\n  clearCharNodes(){}\r\n  \r\n  draggedToFoused(){}\r\n\r\n  focusNode(){}\r\n\r\n  allToNormalState(){}\r\n\r\n  toTreeViewNode(){\r\n    return null\r\n  }\r\n\r\n  getNodeById(){}\r\n\r\n  charNodes(){\r\n    let nodes = []\r\n    for(var i = 0; i < this.text.length; i++){\r\n      nodes.push(new CharNode(this.text[i], this.parent))\r\n    }\r\n    return nodes\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/nodes/text-node.js","export default {\r\n  dropInMargin : 10,\r\n  editable: true,\r\n  editMarginStyle : {\r\n    paddingX:'10px',\r\n    paddingY:'10px',\r\n  },\r\n  //没有子元素，显示空白\r\n  empertyMargin:false,\r\n  rejectChildren : ['col','thead', 'tbody', \r\n                           'th', 'tr', 'td']\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/rules/common-rule.js","import {add, contains, remove, insertBefore} from \"./rxarray\"\r\n\r\nexport class RXComponent{\r\n  constructor(elementName = 'div'){\r\n    this.children = []\r\n    this.classList = []\r\n    this.style = {}\r\n    this.attrs = {}\r\n    this.domOns = {}\r\n    this.elementName = elementName\r\n  }\r\n\r\n  on(eventName, callback){\r\n    this[eventName] = callback\r\n    return this\r\n  }\r\n\r\n  off(eventName){\r\n    delete this[eventName]\r\n    return this\r\n  }\r\n\r\n  domOn(name, callback){\r\n    if(this.$dom){\r\n      this.$dom.addEventListener(name, callback)\r\n    }\r\n    this.domOns[name] = callback\r\n    return this\r\n  }\r\n\r\n  domOff(name, callback){\r\n    if(this.$dom){\r\n      this.$dom.removeEventListener(name, callback)\r\n    }\r\n    delete this.domOns[name]\r\n    return this\r\n  }\r\n\r\n  pushChild(child){\r\n    this.children.push(child)\r\n    return this\r\n  }\r\n\r\n  unshiftChild(child){\r\n    this.children.unshift(child)\r\n    return this\r\n  }\r\n\r\n  cssClass(className){\r\n    add(className, this.classList)\r\n    if(this.$dom){\r\n      this.$dom.classList.add(className)\r\n    }\r\n    return this\r\n  }\r\n\r\n  removeCssClass(className){\r\n    if(contains(className, this.classList)){\r\n     remove(className, this.classList)\r\n      if(this.$dom && this.$dom.classList.contains(className)){\r\n        this.$dom.classList.remove(className)\r\n      }\r\n    }\r\n    return this\r\n  }\r\n\r\n  cssStyle(name, value){\r\n    this.style[name] = value\r\n    return this\r\n  }\r\n\r\n  removeCssStyle(name){\r\n    delete this.style[name]\r\n  }\r\n\r\n  domAttr(name, value){\r\n    this.attrs[name] = value\r\n    return this\r\n  }\r\n\r\n  removeDomAttr(name){\r\n    delete this.attrs[name]\r\n    return this\r\n  }\r\n\r\n  tongle(cssClass){\r\n    if(contains(cssClass, this.classList)){\r\n     remove(cssClass, this.classList)\r\n      if(this.$dom){\r\n        remove(cssClass, this.$dom.classList)\r\n      }\r\n    }\r\n    else{\r\n     add(cssClass, this.classList)\r\n      if(this.$dom){\r\n        add(cssClass, this.$dom.classList)\r\n      }\r\n    }\r\n  }\r\n  //setInnerHTML(innerHTML){\r\n  //  this.innerHTML = innerHTML\r\n  //  return this\r\n  //}\r\n\r\n  render(parentElement){\r\n    this.$dom =  document.createElement(this.elementName)\r\n    parentElement.appendChild(this.$dom)\r\n\r\n    if(this.innerHTML){\r\n      this.$dom.innerHTML = this.innerHTML\r\n    }\r\n\r\n    for(var styleName in this.style){\r\n      this.$dom.style[styleName] = this.style[styleName]\r\n    }\r\n\r\n    this.classList.forEach((className)=>{\r\n      this.$dom.classList.add(className)\r\n    })\r\n\r\n    for(var attrName in this.attrs){\r\n      this.$dom[attrName] = this.attrs[attrName]\r\n    }\r\n\r\n    for(var eventName in this.domOns){\r\n      this.$dom.addEventListener(eventName, this.domOns[eventName])\r\n    }\r\n\r\n    this.children.forEach((child)=>{\r\n      child.render(this.$dom)\r\n    })\r\n    return this\r\n  }\r\n\r\n  refresh(){\r\n    if(this.$dom){\r\n      let parentDomElement = this.$dom.parentNode\r\n      this.destory()\r\n      this.render(parentDomElement)\r\n    }\r\n  }\r\n\r\n  setInnerHTML(innerHTML){\r\n    this.innerHTML = innerHTML\r\n    if(this.$dom){\r\n      this.$dom.innerHTML = innerHTML\r\n    }\r\n    return this\r\n  }\r\n\r\n  destory(){\r\n    this.$dom.parentNode.removeChild(this.$dom)\r\n    this.$dom = ''\r\n  }\r\n\r\n  removeChild(node){\r\n    remove(node, this.children)\r\n    if(this.$dom && node.$dom && this.$dom.contains(node.$dom)){\r\n      this.$dom.removeChild(node.$dom)\r\n    }\r\n  }\r\n\r\n  clearChild(){\r\n    this.children = new RXArray()\r\n  }\r\n\r\n  classClasses(){\r\n    let dom = this.$dom\r\n    if(dom){\r\n      this.classList.forEach(cssClass=>{\r\n        //console.log(cssClass)\r\n        dom.classList.remove(cssClass)\r\n      })\r\n    }\r\n    this.classList.length = 0\r\n  }\r\n\r\n  show(){\r\n    this.style.display = 'flex'\r\n    if(this.$dom){\r\n      this.$dom.style.display = 'flex'\r\n    }\r\n    return this\r\n  }\r\n\r\n  isShow(){\r\n    return this.style.display !== 'none'\r\n  }\r\n\r\n  hide(){\r\n    this.style.display = 'none'\r\n    if(this.$dom){\r\n      this.$dom.style.display = 'none'\r\n    }\r\n    return this\r\n  }\r\n\r\n\r\n  insertBefore(child, refence){\r\n    insertBefore(child, refence, this.children)\r\n  }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/basic/rxcomponent.js","import initEditor from \"./shell/init-editor\"\r\n\r\nwindow.creatEditorCore = (pageId)=>{\r\n  initEditor(pageId)\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core.js","import {RXEditor} from \"../core/rxeditor\"\r\nimport {RXEditorCommandProxy} from \"../core/rxeditor-command-proxy\"\r\n//import loadElements from \"../elements/load-elements\"\r\n\r\nexport default function initEditor(pageId){\r\n  window.rxEditor = new RXEditor(pageId)\r\n  window.RXEditorCommandProxy = RXEditorCommandProxy\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/shell/init-editor.js","import {Canvas} from \"./canvas\"\nimport {CanvasState} from \"./canvas-state\"\nimport {add, tongleOnCondition} from \"../basic/rxarray\"\nimport {CommadManager} from \"./commands\"\nimport {NodeLabel} from \"./node-label\"\nimport {NodeToolbar} from \"./node-toolbar\"\nimport {RxCursor} from \"./rx-cursor\"\nimport {MouseFollower} from \"./mouse-follower\"\nimport {MiniEditbar} from \"./mini-editbar\"\nimport {RXEditorCommandProxy} from \"./rxeditor-command-proxy\"\n\nimport {NodeParser} from \"./node-parser\"\n\nfunction getDefaultLang(){\n  let lang = navigator.language || navigator.userLanguage\n  lang = lang.substr(0, 2)\n  //目前只实现两个语言版本\n  if(lang !== 'zh'){\n    lang = 'en'\n  }\n  return lang\n}\n\nvar enLocal = {\n  \"focus-parent\" : \"Focus Parent\",\n  \"move\" : \"Move\",\n  \"edit\" : \"Edit\",\n  \"duplicate\" : \"Duplicate\",\n  \"delete\" : \"Delete\",\n  \"can-be-draged\" : \"Can be draged\",\n}\n\nvar zhLocal = {\n  \"focus-parent\" : \"选中父节点\",\n  \"move\" : \"拖动\",\n  \"edit\" : \"编辑\",\n  \"duplicate\" : \"克隆\",\n  \"delete\" : \"删除\",\n  \"can-be-draged\" : \"可以拖动\",\n}\n\nfunction getLocal(id){\n  let local = getDefaultLang() === 'zh' ? zhLocal : enLocal\n  return local[id] ? local[id] : id\n}\n\nexport class RXEditor{\n  constructor(pageId) {\n    this.pageId = pageId\n    window.$t = getLocal\n    this.state = new CanvasState\n    this.commandManager = new CommadManager\n    this.commandManager.onCommandsChanged = (canUndo, canRedo, commandSchema)=>{\n      if(!commandSchema) return\n      if(commandSchema.parentId === this.canvas.id){\n        commandSchema.parentId = ''\n      }\n      if(commandSchema.oldParentId === this.canvas.id){\n        commandSchema.oldParentId = ''\n      }\n      this.commandProxy.commandExcuted(canUndo, canRedo, commandSchema)\n    }\n    this.optionClasses = []\n    add('rx-_-show-outline', this.optionClasses)\n    //this.optionClasses.add('show-label')\n    this.activedLabel = new NodeLabel\n    this.focusedLabel = new NodeLabel\n    this.focusedLabel.cssClass('focused')\n    this.focusedLabel.domOn('mousedown', (event)=>{\n      if(rxEditor.focusedNode){\n        rxEditor.focusedNode.begindragLabel(event)\n      }\n    })\n\n    this.toolbar = new NodeToolbar\n    this.cursor = new RxCursor\n    this.mouseFollower = new MouseFollower\n    this.miniEditbar = new MiniEditbar\n    this.nodeParser = new NodeParser\n  }\n\n  hangOn(id){\n    let commandProxy = new RXEditorCommandProxy(this.pageId)\n    this.workspace = document.getElementById(id)\n    this.activedLabel.render(this.workspace)\n    this.focusedLabel.render(this.workspace)\n    this.toolbar.render(this.workspace)\n    this.cursor.render(this.workspace)\n    this.mouseFollower.render(this.workspace)\n    this.miniEditbar.render(this.workspace)\n    this.canvas = new Canvas(this.workspace)\n    //this.canvas.children = this.load()\n    this.canvas.render();\n    commandProxy.serveForRXEditor = this\n    this.commandProxy = commandProxy\n\n    this.commandProxy.rxeditorReady()\n    document.addEventListener('mouseup', (event)=>{\n      this.dropElement(event)\n    })\n\n    this.state.watch('changed', (state)=>{\n      //this.allToNormalState()\n    })\n    this.state.watch('showOutline', (state)=>{\n      tongleOnCondition(state.showOutline, 'rx-_-show-outline', this.optionClasses)\n      this.render()\n    })\n    this.state.watch('showMarginX', (state)=>{\n      this.render()\n    })\n    this.state.watch('showMarginY', (state)=>{\n      this.render()\n    })\n\n  }\n\n  render(){\n    this.canvas.render()\n    this.toolbar.refreshPosition()\n    this.focusedLabel.refreshPosition()\n  }\n\n\n  clearDraggedoverStates(){\n    this.canvas.clearDraggedoverStates()\n  }\n  clearActiveStates(){\n    this.canvas.clearActiveStates()\n  }\n  clearFocusAndEditStates(){\n    this.canvas.clearFocusAndEditStates()\n  }\n\n  allToNormalState(){\n    this.canvas.allToNormalState()\n  }\n\n  dragFromToolbox(item){\n    if(this.commandManager.movingCommand) return\n    this.clearFocusAndEditStates()\n    let draggedNode = this.parseNode(item)\n    this.commandManager.startNew(draggedNode)\n    this.beginFollowMouse()\n    //this.clearFocusAndEditStates()\n  }\n\n  parseNode(item){\n    let responsive = this.state.screenWidth\n    return this.nodeParser.parse(\n      item.code.replace('--responsive--', responsive == 'xs' ? '' : '-'+ responsive)\n      )[0]\n    //return new BSContainer\n  }\n\n  dropElement(event){\n    //this.clearDraggedoverStates()\n    this.doDrop(event)\n    this.commandManager.finishMoving()\n    this.endFollowMouse()\n    this.canvas.clearCharNodes()\n  }\n\n  doDrop(event){\n    let position = this.cursor.position\n    let node = this.cursor.node\n    if(!node){\n      this.canvas.draggedToFoused()\n      return\n    }\n    this.canvas.clearFocusAndEditStates()\n    let command = this.commandManager.movingCommand\n    if(command){\n      if(position === 'in-left' || position === 'in-top'){\n        command.adoptFromToolbox(node)\n        command.moveInTop(node)\n        command.finish()\n      }\n      else if(position === 'in-right' || position === 'in-bottom'){\n        command.adoptFromToolbox(node)\n        command.moveIn(node)\n        command.finish()\n      }\n      else if(position === 'out-left' \n        || position === 'out-top'\n        || position === 'char-left'){\n        command.adoptFromToolbox(node)\n        command.moveBefore(node)\n        command.finish()\n      }\n      else if(position === 'out-right' \n        || position === 'out-bottom' \n        || position === 'char-right' ){\n        command.adoptFromToolbox(node)\n        command.moveAfter(node)\n        command.finish()\n      }\n    }\n}\n\n  endDragFromToolbox(){\n    this.commandManager.finishMoving()\n    this.endFollowMouse()\n  }\n\n  followMouse(event){\n    let mouseFollower = this.mouseFollower\n    if(mouseFollower.isActived){\n      //mouseFollower.$dom.style.left =  this.followX(event)\n      //mouseFollower.$dom.style.top = this.followY(event)\n      this.mouseFollower.followMouse(event)\n      this.commandProxy.takeOverDraggingByWorkspace()\n    }\n  }\n\n  beginFollowMouse(){\n    if(this.commandManager.movingCommand){\n      let draggedNode = this.commandManager.movingCommand.node\n      this.mouseFollower.active(draggedNode.label)\n    }\n  }\n\n  endFollowMouse(){\n    //if(this.mouseFollower && this.workspace.contains(this.mouseFollower.$dom)){\n    //  this.workspace.removeChild(this.mouseFollower.$dom)\n    //}\n    this.cursor.hide()\n    this.mouseFollower.hide()\n  }\n\n  nodeStateChanged(node, oldState, newState){\n    if(newState === node.focusState && node.focusState !== node.normalState){\n      node.htmlCode = this.getNodeHtml(node)\n      this.commandProxy.focusNode(node, this.pageId)\n    }\n    if(oldState === node.focusState && newState !== node.focusState){\n      this.commandProxy.unFocusNode(node)\n    }\n  }\n\n  getNodeHtml(node){\n    let div = document.createElement('div')\n    node.renderHtml(div)\n    return div.innerHTML;\n  }\n\n  changeCanvasState(state){\n    this.state.screenWidth = state.screenWidth\n    //this.state.preview = state.preview\n    //this.state.showEditMargin = state.showEditMargin\n    this.state.showMarginX = state.showMarginX\n    this.state.showMarginY = state.showMarginY\n    this.state.showOutline = state.showOutline\n    this.state.showLabel = state.showLabel\n  }\n\n  nodeChanged(node){\n    //console.log(node)\n    this.canvas.nodeChanged(node)\n    this.render()\n  }\n\n\n  undo(){\n    this.allToNormalState()\n    this.commandManager.undo()\n    this.render()\n  }\n\n  redo(){\n    this.allToNormalState()\n    this.commandManager.redo()\n    this.render()\n  }\n\n  //download(){\n  //  let innerHTML = this.canvas.generateHTML()\n  //  let json = this.canvas.generateJson()\n  //  this.commandProxy.saveCodeFiles(innerHTML, json)\n  //  this.render()\n  //}\n\n  clearCanvas(){\n    this.commandManager.clearCanvas()\n    this.activedLabel.hide()\n    this.focusedLabel.hide()\n    this.toolbar.hide()\n    this.render()\n  }\n\n\n  focusNodeFromShell(node){\n    this.canvas.clearFocusAndEditStates()\n    this.canvas.focusNode(node)\n  }\n\n  duplicateNodeFromShell(id){\n    this.canvas.clearFocusAndEditStates()\n    let node = this.canvas.getNodeById(id)\n    this.commandManager.duplicate(node)\n  }\n\n  removeNodeFromShell(id){\n    this.canvas.clearFocusAndEditStates()\n    let node = this.canvas.getNodeById(id)\n    this.commandManager.deleteNode(node)\n  }\n\n  canvasMouseMove(event){\n    this.commandProxy.canvasMouseMove(event)\n  }\n\n  requestHtmlCode(){\n    this.allToNormalState()\n    return this.canvas.generateHTML()\n  }\n\n  loadHtml(html, id){\n    let node = this.canvas.getNodeById(id)\n    if(node){\n      this.commandManager.loadNodeHtml(node, html)\n    }\n    else{\n      this.commandManager.loadCanvasHtml(html)\n    }\n\n    this.render()\n  }\n\n  setInlineFile(file){\n    let codeId = file.name.replace('.', '-')\n    let element = document.getElementById(codeId)\n    if(element){\n      element.innerHTML = file.code\n      return\n    }\n\n    if(file.fileType === 'style'){\n      let style = document.createElement('style');\n      style.type = 'text/css';\n      style.rel = 'stylesheet';\n      style.id = codeId\n\n      style.appendChild(document.createTextNode(file.code));\n\n      let head = document.getElementsByTagName('head')[0];\n      head.appendChild(style);\n    }\n\n    if(file.fileType === 'javascript'){\n      var script = document.createElement('script');\n      script.type = 'text/javascript';\n      script.id = codeId\n      script.appendChild(document.createTextNode(file.code));\n      document.body.appendChild(script);\n    }\n    \n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/rxeditor.js","import {Node} from \"./node\"\n\nexport class Canvas extends Node{\n  constructor(workspace) {\n    super()\n    this.activeState = this.normalState\n    this.focusState = this.normalState\n    this.parentViewDomElement = workspace;\n    this.padding = '30px';\n\n    this.stateChanged = (oldState, newState)=>{}\n\n    this.rule = {dropInMargin : 0}\n    this.rule.acceptedChildren=''\n    this.rule.rejectChildren = ['col','thead', 'tbody', \n                           'th', 'tr', 'td']\n  }\n\n  getParentViewDomElement(){\n    return this.parentViewDomElement\n  }\n\n  /*preview(parentDomElement){\n    if(parentDomElement.contains(this.view.$dom)){\n      parentDomElement.removeChild(this.view.$dom)\n    }\n    return super.preview(parentDomElement)\n  }*/\n\n  toViewModel(){\n    let model = super.toViewModel()\n    model.tag = 'div'\n    model.styles.width = \"100%\"\n    model.styles['min-height'] = \"calc(100vh)\"\n    model.styles.cursor = 'default'\n    model.styles['border'] = '0'\n    model.styles['padding'] = '10px'\n    model.classList.push('canvas')\n    model.toolbar = ''\n    model.label = ''\n   return model\n  }\n\n  toPreviewModel(){\n    let model = super.toPreviewModel()\n    model.tag = 'div'\n    return model\n  }\n\n  generateHTML(){\n    let rootDiv = document.createElement('div')\n    this.children.forEach(child=>{\n      child.renderHtml(rootDiv)\n    })\n    return rootDiv.innerHTML\n\n  }\n\n  generateJson(){\n    let jsonArray = []\n    this.children.forEach((child)=>{\n      jsonArray.push(child.toJson())\n    })\n    return jsonArray\n  }\n\n  generateTreeViewNodes(){\n    let viewNodes = []\n    this.children.forEach((child)=>{\n      viewNodes.push(child.toTreeViewNode())\n    })\n    return viewNodes\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/canvas.js","export class NodeView{\n  constructor() {\n  }\n\n  render(model, parentDoment){\n    this.parentDoment = parentDoment\n    //this.putDown(parentDoment)//防止canvas内节点重复添加\n    let oldDom = this.$dom\n    \n    this.$dom = document.createElement(model.tag)\n    this.doRender(model, parentDoment, this.$dom)\n    if(parentDoment.contains(oldDom)){\n      parentDoment.replaceChild(this.$dom, oldDom)\n    }\n    else{\n      parentDoment.appendChild(this.$dom)\n    }\n  }\n\n  renderHtml(model, parentDoment){\n    //this.putDown(parentDoment)//防止canvas内节点重复添加\n    let previewDom = document.createElement(model.tag)\n    this.doRender(model, parentDoment, previewDom)\n    return previewDom\n  }\n\n  refreshState(model){\n    if(this.$dom){\n      //let y = this.$dom.getBoundingClientRect().y\n      this.$dom.classList.remove('rx-_-mouse-overed','rx-_-focused','rx-_-dragged', 'rx-_-dragover', 'rx-_-editing')\n      this.renderStylesAndClasses(model, this.$dom)\n      this.showAttributes(model,this.$dom)\n    }\n  }\n\n  doRender(model, parentDoment, domElement){\n    domElement.innerHTML = model.innerHTML ? model.innerHTML : ''\n    this.renderStylesAndClasses(model, domElement)\n    this.bindEvents(domElement, model.on)\n    this.showAttributes(model,domElement)\n    //parentDoment.appendChild(domElement);\n  }\n\n\n  renderStylesAndClasses(model, domElement){\n    if(domElement){\n      if(model.styles){\n        for(var styleName in model.styles){\n          domElement.style[styleName] = model.styles[styleName]\n        }\n      }\n\n      model.classList.forEach((className)=>{\n        if(className){\n          domElement.classList.add(className)\n        }\n      })\n      \n    }\n  }\n\n  showAttributes(model, domElement){\n    for(var attributeName in model.attributes){\n      if(model.attributes[attributeName]){\n        domElement.setAttribute(attributeName, model.attributes[attributeName])\n      }\n    }\n  }\n\n  bindEvents(element, on){\n    for(var eventName in on){\n      //element.addEventListener(eventName, on[eventName])\n      element[eventName] = on[eventName]\n    }\n  }\n\n  putDown(){\n    if(this.$dom){\n      if(this.parentDoment.contains(this.$dom)){\n        this.parentDoment.removeChild(this.$dom);\n      }\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/node-view.js","export class NodeState {\n  constructor(node) {\n    this.node = node\n    this.classList = []\n    this.styles = {}\n    this.attributes = {/*contenteditable:'false'*/}\n    this.onMousemove = ()=>{/*console.log('mouse move NodeState')*/};\n    this.onBegindrag = ()=>{};\n    this.onMouseover = (event)=>{};\n    this.onMouseout = ()=>{};\n    //this.onMouseup = (event)=>{\n      //添加结束拖动代码\n    //}\n    this.onClick = ()=>{\n      rxEditor.clearFocusAndEditStates()\n    }\n    this.enter = ()=>{}\n    this.leave = ()=>{\n    }\n  }\n\n  stateModel(){\n    let classList = []\n    classList.push.apply(classList, this.classList)\n   \n    let model = {\n      styles:Object.assign({}, this.styles),\n      classList:classList,\n      attributes: Object.assign({}, this.attributes),\n    }\n\n    this.addtionToModel(model)\n    return model\n  }\n\n  addtionToModel(model){\n    model.classList.push.apply(model.classList, rxEditor.optionClasses)\n    let node = this.node\n    if((rxEditor.state.showMarginX && node.rule.editMarginStyle)\n      || (node.children.length === 0 && node.rule.empertyMargin)\n      ){\n      model.styles['padding-left'] = node.rule.editMarginStyle ? node.rule.editMarginStyle.paddingX : 0\n      model.styles['padding-right'] = node.rule.editMarginStyle ? node.rule.editMarginStyle.paddingX : 0\n    }\n    if((rxEditor.state.showMarginY && node.rule.editMarginStyle)\n      || (node.children.length === 0 && node.rule.empertyMargin)\n      ){\n      model.styles['padding-top'] = node.rule.editMarginStyle ? node.rule.editMarginStyle.paddingY : 0\n      model.styles['padding-bottom'] = node.rule.editMarginStyle ? node.rule.editMarginStyle.paddingY : 0\n    }\n\n    //添加for后，编辑时无法选中\n    if(model.attributes.for){\n      model.attributes.for = ''\n    }\n\n    model.attributes.draggable = \"false\"\n\n    return model\n  }\n\n  judgePosition(event){\n    let draggedNode = rxEditor.commandManager.movingCommand.node\n    if(this.node.isCharNode){\n      return this.judgeCharNodePostion(event)\n    }\n    let margin = this.node.rule.dropInMargin\n    margin = margin ? margin : 0\n\n    let clientWidth = event.srcElement.clientWidth\n    let clientHeight = event.srcElement.clientHeight\n    let offsetX = event.offsetX\n    let offsetY = event.offsetY\n    let ratioY = offsetY/clientHeight\n    let ratioX = offsetX/clientWidth\n\n    if(margin > 0 && \n      ((this.node.parent && this.node.parent.canAccept(draggedNode)) || !this.node.parent)\n      ){\n      //左上角小方块区域\n      if(offsetY < margin && offsetX < margin){\n        return ratioY < ratioX ? 'out-top' :'out-left'\n      }\n\n      //右上角小方块区域\n      if(offsetY < margin \n        && clientWidth - offsetX < margin){\n        return ratioY < (1 - ratioX) ? 'out-top' :'out-right'\n      }\n\n      //右下角小方块\n      if(clientHeight - offsetY < margin \n        && clientWidth - offsetX < margin){\n        return (1 - ratioY) < (1 - ratioX) ? 'out-bottom' :'out-right'\n      }\n\n      //左下角小方块\n      if(clientHeight - offsetY < margin \n        && offsetX < margin){\n        return (1 - ratioY) <  ratioX ? 'out-bottom' :'out-left'\n      }\n\n      if(offsetY < margin){\n        return 'out-top'\n      }\n\n      if(offsetX < margin){\n        return 'out-left'\n      }\n\n      if(clientHeight - offsetY < margin){\n        return 'out-bottom'\n      }\n\n      if(clientWidth - offsetX < margin){\n        return 'out-right'\n      }\n    }\n\n    if(this.node.canAccept(draggedNode)){\n      if(this.inTop(event) && this.inLeft(event)){\n        return ratioY < ratioX ? 'in-top' :'in-left'\n      }\n      if(this.inTop(event) && !this.inLeft(event)){\n        return ratioY < (1 - ratioX) ? 'in-top' :'in-right'\n      }\n      if(!this.inTop(event) && this.inLeft(event)){\n        return (1 - ratioY) < ratioX ? 'in-bottom' :'in-left'\n      }\n      if(!this.inTop(event) && !this.inLeft(event)){\n        return (1 - ratioY) < (1 - ratioX) ? 'in-bottom' :'in-right'\n      }\n    }\n\n  }\n\n  judgeCharNodePostion(event){\n    return this.inLeft(event) ? 'char-left' : 'char-right'\n  }\n\n  //-dropInMargin 边界里面，算是拖入内部，外面算是拖入外部\n  inTop(event){\n    //位于上半部\n    if(event.srcElement.clientHeight > event.offsetY*2){\n      return true\n    }\n    return false\n  }\n\n  inLeft(event){\n    //位于左半部部\n    if(event.srcElement.clientWidth > event.offsetX*2){\n      return true\n    }\n    return false\n  }\n\n}\n\nexport class CanDropState extends NodeState{\n  constructor(node) {\n    super(node)\n    this.onMousemove = (event)=>{\n      this.doDragover(event)\n      rxEditor.followMouse(event)\n    }\n    //this.onMouseup = (event)=>{\n    //  this.doDrop(event)\n    //}\n    this.onClick = (event)=>{\n      rxEditor.clearFocusAndEditStates()\n      this.node.changeToState('focusState')\n    }\n  }\n\n  doDragover(event){\n    let command = rxEditor.commandManager.movingCommand\n    if(command){\n      let position =this.judgePosition(event)\n      if(position){\n        this.node.changeToState('dragoverState')\n        rxEditor.cursor.show(this.judgePosition(event), this.node)\n      }\n    }\n\n  }\n\n}\n\nexport class NormalState extends CanDropState{\n  constructor(node) {\n    super(node)\n    this.onMouseover = (event)=>{\n      if(!rxEditor.commandManager.movingCommand){\n        rxEditor.clearActiveStates()\n        this.node.changeToState('activeState')\n      }\n    };\n  }\n}\n\nexport class DragoverState extends CanDropState{\n  constructor(node) {\n    super(node)\n    this.classList.push('rx-_-dragover')\n    this.enter = ()=>{\n      node.changeTextnodeToCharNode()\n      if(!this.node.isCharNode){\n        rxEditor.activedLabel.show(node.label, node, 1)\n      }\n    }\n    this.leave = ()=>{\n      rxEditor.activedLabel.hide()\n    }\n    this.onMouseout = ()=>{\n      this.node.changeToState('normalState')\n    }\n  }\n}\n\nexport class ActiveState extends CanDropState{\n  constructor(node) {\n    super(node)\n    this.classList.push('rx-_-mouse-overed')\n    this.enter = ()=>{\n      rxEditor.activedLabel.show(node.label, node, 1)\n    }\n    this.leave = ()=>{\n      rxEditor.activedLabel.hide()\n    }\n    this.onMouseout = ()=>{\n      //console.log('mouse out')\n      this.node.changeToState('normalState')\n    };\n    this.onMouseover = (event)=>{\n      if(!rxEditor.commandManager.movingCommand){\n        rxEditor.clearActiveStates()\n        this.node.changeToState('activeState')\n      }\n    };\n  }\n}\n\nexport class FocusState extends CanDropState{\n  constructor(node) {\n    super(node)\n    this.classList.push('rx-_-focused')\n    this.enter = ()=>{\n      let dom = node.view.$dom\n      rxEditor.focusedLabel.show(node.label, node, 2)\n      rxEditor.toolbar.show(node)\n      rxEditor.focusedNode = node\n    }\n    this.leave = ()=>{\n      rxEditor.focusedLabel.hide()\n      rxEditor.toolbar.hide()\n      rxEditor.focusedNode = ''\n    }\n    this.onClick = (event)=>{\n      event.stopPropagation()\n    }\n\n    this.onBegindrag = (event)=>{\n      //if(this.node.draggable){\n      this.preventDefault\n      rxEditor.commandManager.startMove(this.node)\n      rxEditor.beginFollowMouse(event)\n      this.node.changeToState('draggedState')\n      //}\n    };\n  }\n}\n\nexport class DisableState extends NodeState{\n  constructor(node) {\n    super(node)\n    this.onMousemove = (event)=>{\n      event.preventDefault()\n      rxEditor.followMouse(event) \n      //console.log('mouse move DisableState')\n    };\n    this.onMouseout = (event)=>{event.preventDefault()};\n  }\n}\n\nexport class DraggedState extends DisableState{\n  constructor(node) {\n    super(node)\n    this.classList.push('rx-_-dragged')\n    this.enter = ()=>{\n      document.body.classList.add('one-element-dragged')\n    }\n    this.leave = ()=>{\n      document.body.classList.remove('one-element-dragged')\n    }\n  }\n}\n\nexport class EditState extends FocusState{\n  constructor(node) {\n    super(node)\n    this.classList.push('rx-_-editing')\n    this.enter = ()=>{\n      this.attributes.contenteditable = 'true'\n      let dom = node.view.$dom\n      rxEditor.focusedLabel.show(node.label, node, 2)\n      rxEditor.toolbar.show(node)\n      rxEditor.focusedNode = node\n      rxEditor.miniEditbar.show(this.node.view.$dom)\n      rxEditor.commandManager.startEditText(node)\n      node.render()\n    }\n\n    this.leave = ()=>{\n      rxEditor.focusedLabel.hide()\n      rxEditor.toolbar.hide()\n      rxEditor.focusedNode = ''\n      rxEditor.miniEditbar.hide()\n\n      rxEditor.commandManager.finishEditText()\n      this.node.render()\n    }\n  }\n}\n\nexport class PreviewState extends NodeState{\n  constructor(node) {\n    super(node)\n    this.onClick = ()=>{};\n  }\n\n  addtionToModel(model){\n    return model\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/node-state.js","import {ObjectState} from \"../basic/object-state\"\n\nexport class CanvasState extends ObjectState{\n  constructor(){\n    super()\n    this.__screenWidth = 'md'\n    this.__preview = false\n    this.__showMarginX = true\n    this.__showMarginY = true\n    this.__showOutline = true\n    this.__showLabel = true\n\n  }\n\n  get screenWidth(){\n    return this.__screenWidth\n  }\n\n  set screenWidth(screenWidth){\n    if(this.__screenWidth == screenWidth){return} \n    this.__screenWidth = screenWidth\n    this.distributeEvent('screenWidth')\n  }\n\n\n  get preview(){\n    return this.__preview\n  }\n\n  set preview(preview){\n    if(this.__preview == preview){return} \n    this.__preview = preview\n    this.distributeEvent('preview')\n  }\n\n  get showMarginX(){\n    return this.__showMarginX\n  }\n\n  set showMarginX(showMarginX){\n    if(this.__showMarginX == showMarginX){return} \n    this.__showMarginX = showMarginX\n    this.distributeEvent('showMarginX')\n  }\n\n  get showMarginY(){\n    return this.__showMarginY\n  }\n\n  set showMarginY(showMarginY){\n    if(this.__showMarginY == showMarginY){return} \n    this.__showMarginY = showMarginY\n    this.distributeEvent('showMarginY')\n  }\n\n  get showOutline(){\n    return this.__showOutline\n  }\n\n  set showOutline(showOutline){\n    if(this.__showOutline == showOutline){return} \n    this.__showOutline = showOutline\n    this.distributeEvent('showOutline')\n  }\n\n  get showLabel(){\n    return this.__showLabel\n  }\n\n  set showLabel(showLabel){\n    if(this.__showLabel == showLabel){return} \n    this.__showLabel = showLabel\n    this.distributeEvent('showLabel')\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/canvas-state.js","function insterAfter(newElement,targetElement){\n  var parent = targetElement.parentNode;\n  if(parent.lastChild == targetElement){\n    parent.appendChild(newElement);\n  }\n  else{\n    parent.insertBefore(newElement,targetElement.nextSibling);\n  }              \n}\n\nclass CommandMovable{\n  constructor(node){\n    this.node = node\n    this.oldParent = node.parent\n    this.oldnNextSbiling = node.nextSbiling()\n  }\n\n  moveInTop(targetParent){\n    this.node.moveInTop(targetParent)\n    this.storeNewInfo()\n  }\n\n\n  moveBefore(brother){\n    this.node.moveBefore(brother)\n    this.storeNewInfo()\n  }\n\n  moveAfter(brother){\n    this.node.moveAfter(brother)\n    this.storeNewInfo()\n  }\n\n\n  moveIn(targetParent){\n    this.node.moveIn(targetParent)\n    this.storeNewInfo()\n  }\n\n  storeNewInfo(){\n    this.newParent = this.node.parent\n    this.newNextSbiling = this.node.nextSbiling()\n  }\n\n  adoptFromToolbox(parent){\n    let draggedNode = this.node\n    if(draggedNode && !draggedNode.parent && parent.canAccept(draggedNode)){\n      draggedNode.parent = parent\n      draggedNode.render()\n      draggedNode.changeToState('draggedState')\n    }\n  }\n\n  finish(){\n    let draggedNode = this.node\n    if(draggedNode.parent){\n      draggedNode.parent.changeToState('normalState')\n    }\n    this.makeExcuteSchema()\n  }\n\n  excute(){\n    this.node.removeFromParent()\n    if(this.newNextSbiling){\n      this.node.moveBefore(this.newNextSbiling)\n    }\n    else if(this.newParent){\n      this.newParent.pushChild(this.node)\n    }\n    this.makeExcuteSchema()\n  }\n\n  undo(){\n    this.node.removeFromParent()\n    if(this.oldnNextSbiling){\n      this.node.moveBefore(this.oldnNextSbiling)\n    }\n    else if(this.oldParent)\n    {\n      this.oldParent.pushChild(this.node)\n    }\n\n    this.makeUndoSchema()\n  }\n\n\n}\n\nclass CommandNew extends CommandMovable{\n  constructor(node) {\n    super(node)\n  }\n\n  makeExcuteSchema(){\n    this.commandSchema = {\n      command : 'new',\n      node : this.node.toTreeViewNode(),\n      parentId : this.node.parent ? this.node.parent.id : '',\n      nextSblilingId : this.node.nextSbiling() ? this.node.nextSbiling().id : '',\n    }\n  }\n  \n  makeUndoSchema(){\n    this.commandSchema = {\n      command : 'delete',\n      nodeId : this.node.id,\n    }\n  }\n}\n\nclass CommandMove extends CommandMovable{\n  constructor(node) {\n   super(node)\n  }\n\n  makeExcuteSchema(){\n    this.commandSchema = {\n      command : 'move',\n      nodeId : this.node.id,\n      oldParentId : this.oldParent ? this.oldParent.id : '',\n      parentId : this.node.parent ? this.node.parent.id : '',\n      nextSblilingId : this.node.nextSbiling() ? this.node.nextSbiling().id : '',\n    }\n  }\n  \n  makeUndoSchema(){\n    this.commandSchema = {\n      command : 'move',\n      nodeId : this.node.id,\n      oldParentId : this.newParent ? this.newParent.id : '',\n      parentId : this.node.parent ? this.node.parent.id : '',\n      nextSblilingId : this.node.nextSbiling() ? this.node.nextSbiling().id : '',\n    }\n  }\n}\n\nclass CommandDelete{\n  constructor(node) {\n    this.node = node\n    this.oldParent = node.parent\n    this.oldnNextSbiling = this.node.nextSbiling()\n  }\n\n  excute(){\n    this.node.removeFromParent()\n    this.makeExcuteSchema()\n  }\n\n  undo(){\n    if(this.oldnNextSbiling){\n      this.node.moveBefore(this.oldnNextSbiling)\n    }\n    else{\n      this.oldParent.pushChild(this.node)\n    }\n    this.makeUndoSchema()\n  }\n\n  makeExcuteSchema(){\n    this.commandSchema = {\n      command : 'delete',\n      nodeId : this.node.id,\n    }\n  }\n  \n  makeUndoSchema(){\n    this.commandSchema = {\n      command : 'new',\n      node : this.node.toTreeViewNode(),\n      parentId : this.node.parent ? this.node.parent.id : '',\n      nextSblilingId : this.node.nextSbiling() ? this.node.nextSbiling().id : '',\n    }\n  }\n\n}\n\nclass CommandClone{\n  constructor(node) {\n    this.node = node\n    this.copy = node.clone()\n  }\n\n  excute(){\n    this.copy.moveAfter(this.node)\n    this.makeExcuteSchema()\n  }\n\n  undo(){\n    this.copy.removeFromParent()\n    this.makeUndoSchema()\n  }\n\n  makeExcuteSchema(){\n    this.commandSchema = {\n      command : 'new',\n      node : this.copy.toTreeViewNode(),\n      parentId : this.copy.parent ? this.copy.parent.id : '',\n      nextSblilingId : this.copy.nextSbiling() ? this.copy.nextSbiling().id : '',\n    }\n  }\n  \n  makeUndoSchema(){\n    this.commandSchema = {\n      command : 'delete',\n      nodeId : this.copy.id,\n    }\n  }\n}\n\nclass CommandChangeNode{\n  constructor(node, newMeta) {\n    this.node = node\n    this.oldMeta = JSON.parse(JSON.stringify(node.meta))\n    this.newMeta = JSON.parse(JSON.stringify(newMeta))\n  }\n\n  excute(){\n    this.node.meta = JSON.parse(JSON.stringify(this.newMeta))\n    this.makeExcuteSchema()\n  }\n\n  undo(){\n    this.node.meta = JSON.parse(JSON.stringify(this.oldMeta))\n    this.makeUndoSchema()\n  }\n\n  makeExcuteSchema(){\n    this.commandSchema = {\n      command : 'change',\n      nodeId : this.node.id,\n      meta: this.node.meta\n    }\n  }\n  \n  makeUndoSchema(){\n    this.commandSchema = {\n      command : 'change',\n      nodeId : this.node.id,\n      meta: this.node.meta,\n    }\n  }\n}\n\n\nclass CommandTextEdit{\n  constructor(node) {\n    this.node = node\n    this.oldChildren = this.node.children\n\n    this.node.children.forEach(chilid=>{\n      chilid.preview()\n    })\n  }\n\n  finish(){\n    this.node.children = rxEditor.nodeParser.parse(this.node.view.$dom.innerHTML)\n\n    this.node.children.forEach(child=>{\n      child.parent = this.node\n    })\n    this.newChildren = this.node.children\n  } \n\n  excute(){\n    this.node.children = this.newChildren\n    this.makeExcuteSchema()\n  }\n\n  undo(){\n    this.node.children = this.oldChildren\n    this.makeUndoSchema()\n  }\n\n  makeExcuteSchema(){\n    this.commandSchema = {\n      command : 'textEdit',\n      nodeId : this.node.id,\n      node : this.node.toTreeViewNode(),\n    }\n  }\n  \n  makeUndoSchema(){\n    this.commandSchema = {\n      command : 'textEdit',\n      nodeId : this.node.id,\n      node : this.node.toTreeViewNode(),\n    }\n  }\n}\n\nclass CommandLoadCanvasHtml{\n  constructor(newHtml) {\n    this.node = rxEditor.canvas\n    this.oldChildren = this.node.children\n    this.node.children = rxEditor.nodeParser.parse(newHtml)\n    this.node.children.forEach(child=>{\n      child.parent = this.node\n    })\n    this.newChildren = this.node.children\n  }\n\n  excute(){\n    this.node.children = this.newChildren\n    this.makeExcuteSchema()\n  }\n\n  undo(){\n    this.node.children = this.oldChildren\n    this.makeUndoSchema()\n  }\n\n  makeExcuteSchema(){\n    this.commandSchema = {\n      command : 'loadCanvasNodes',\n      nodes : this.node.toTreeViewNode().children,\n    }\n  }\n  \n  makeUndoSchema(){\n    this.commandSchema = {\n      command : 'loadCanvasNodes',\n      nodes : this.node.toTreeViewNode().children,\n    }\n  }\n}\n\nclass CommandClearCanvas{\n  constructor() {\n    this.node = rxEditor.canvas\n    this.oldChildren = this.node.children\n    this.node.children = []\n    this.newChildren = this.node.children\n  }\n\n  excute(){\n    this.node.children = this.newChildren\n    this.makeExcuteSchema()\n  }\n\n  undo(){\n    this.node.children = this.oldChildren\n    this.makeUndoSchema()\n  }\n\n  makeExcuteSchema(){\n    this.commandSchema = {\n      command : 'loadCanvasNodes',\n      nodes : this.node.toTreeViewNode().children,\n    }\n  }\n  \n  makeUndoSchema(){\n    this.commandSchema = {\n      command : 'loadCanvasNodes',\n      nodes : this.node.toTreeViewNode().children,\n    }\n  }\n}\n\nclass CommandLoadNodeHtml{\n  constructor(node, newHtml) {\n    this.node = node\n    this.oldChildren = this.node.children\n    this.oldMeta = this.node.meta\n    this.node.children = []\n    let nodes = rxEditor.nodeParser.parse(newHtml)\n    if(nodes.length > 0){\n      let newNode = nodes[0]\n      newNode.children.forEach(child=>{\n        child.parent = this.node\n        this.node.children.push(child)\n      })\n      this.node.meta = newNode.meta\n    }\n    this.newMeta = this.node.meta\n    this.newChildren = this.node.children\n  }\n\n  excute(){\n    this.node.children = this.newChildren\n    this.node.meta = this.newMeta\n    this.makeExcuteSchema()\n  }\n\n  undo(){\n    this.node.children = this.oldChildren\n    this.node.meta = this.oldMeta\n    this.makeUndoSchema()\n  }\n\n  makeExcuteSchema(){\n    this.commandSchema = {\n      command : 'loadNode',\n      nodeId : this.node.id,\n      node : this.node.toTreeViewNode(),\n    }\n  }\n  \n  makeUndoSchema(){\n    this.commandSchema = {\n      command : 'loadNode',\n      nodeId : this.node.id,\n      node : this.node.toTreeViewNode(),\n    }\n  }\n}\n\nexport class CommadManager{\n  constructor() {\n    this.undoCommands = []\n    this.redoCommands = []\n    this.onCommandsChanged = (canUndo, canRedo)=>{\n    }\n  }\n\n  getDraggedNode(){\n    if(this.movingCommand){\n      return this.movingCommand.node\n    }\n  }\n  startNew(node){\n    let cmd = new CommandNew(node)\n    this.startCommand(cmd)\n  }\n\n  startMove(node){\n    let cmd = new CommandMove(node)\n    this.startCommand(cmd)\n  }\n\n  duplicate(node){\n    let cmd = new CommandClone(node)\n    cmd.excute()\n    this.finished(cmd)\n    cmd.node.changeToState('normalState')\n    cmd.copy.changeToState('focusState')\n  }\n\n  changeNode(node, newNodeData){\n    //node.meta = newNodeData.meta\n    let cmd = new CommandChangeNode(node, newNodeData.meta)\n    cmd.excute()\n    this.finished(cmd)\n  }\n\n  deleteNode(node){\n    let cmd = new CommandDelete(node)\n    cmd.excute()\n    this.finished(cmd)\n    rxEditor.toolbar.hide()\n    rxEditor.focusedLabel.hide()\n  }\n\n  loadNodeHtml(node, html){\n    let cmd = new CommandLoadNodeHtml(node, html)\n    cmd.excute()\n    this.finished(cmd)\n  }\n\n  loadCanvasHtml(html){\n    let cmd = new CommandLoadCanvasHtml(html)\n    cmd.excute()\n    this.finished(cmd)\n  }\n\n  clearCanvas(){\n    let cmd = new CommandClearCanvas()\n    cmd.excute()\n    this.finished(cmd)\n  }\n\n\n  startCommand(command){\n    this.movingCommand = command\n  }\n\n  finishMoving(){\n\n    if(this.movingCommand && this.movingCommand.node.parent){\n      //this.movingCommand.finish()\n      this.finished(this.movingCommand)\n      this.movingCommand.node.changeToState('focusState')\n    }\n    this.movingCommand = ''\n  }\n\n  startEditText(node){\n    this.textCommand = new CommandTextEdit(node)\n  }\n\n  finishEditText(){\n    this.textCommand.finish()\n    this.finished(this.textCommand)\n    this.textCommand = ''\n  }\n\n  finished(command){\n    this.undoCommands.push(command)\n    this.redoCommands.length = 0\n    this.submitChanged(command)\n  }\n\n  undo(){\n    let command = this.undoCommands.pop()\n    command.undo()\n    this.redoCommands.push(command)\n    this.submitChanged(command)\n  }\n\n  redo(){\n    let command = this.redoCommands.pop()\n    command.excute()\n    this.undoCommands.push(command)\n    this.submitChanged(command)\n  }\n\n  submitChanged(command){\n    this.onCommandsChanged(this.undoCommands.length > 0, this.redoCommands.length > 0, command.commandSchema)\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/commands.js","import {RXComponent} from \"../basic/rxcomponent\"\n\nexport class NodeLabel extends RXComponent{\n  constructor(){\n    super()\n    this.cssClass('node-label')\n    this.domAttr('title', $t('can-be-draged'))\n    this.hide()\n    document.addEventListener('scroll', (event)=>{\n      this.refreshPosition()\n    })\n    window.addEventListener('resize', (event)=>{\n      this.refreshPosition()\n    })\n  }\n\n  refreshPosition(){\n    this.followElement(this.node, this.offset)\n  }\n\n  show(label, node, offset){\n    this.node = node\n    this.offset = offset\n    if(!node || !node.view.$dom) return\n    super.setInnerHTML(label)\n    this.followElement(node, offset)\n    return super.show()\n  }\n\n  followElement(node, offset){\n    if(!node || !node.view || !node.view.$dom) return\n    let domElement = node.view.$dom\n    let rect = domElement.getBoundingClientRect()\n    if(this.$dom){\n      this.$dom.style.left = rect.x + 'px'\n      if(rect.y < 20){\n        this.$dom.style.top = (rect.y + rect.height + offset) + 'px'\n      }\n      else{\n        this.$dom.style.top = (rect.y - 15 - offset) + 'px'\n      }\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/node-label.js","import {RXComponent} from \"../basic/rxcomponent\"\n\nclass SvgButton extends RXComponent{\n  constructor(title, svg, on, callback){\n    super()\n    this.cssClass('rx-button')\n    this.domAttr('title', title)  \n    this.innerHTML = svg\n    this.domOn(on, callback)\n  }  \n}\n\nvar svgArrowUp = `<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"arrow-up\" class=\"svg-inline--fa fa-arrow-up fa-w-14\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"><path fill=\"currentColor\" d=\"M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z\"></path></svg>`\n\nvar svgMove = `<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"arrows-alt\" class=\"svg-inline--fa fa-arrows-alt fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M352.201 425.775l-79.196 79.196c-9.373 9.373-24.568 9.373-33.941 0l-79.196-79.196c-15.119-15.119-4.411-40.971 16.971-40.97h51.162L228 284H127.196v51.162c0 21.382-25.851 32.09-40.971 16.971L7.029 272.937c-9.373-9.373-9.373-24.569 0-33.941L86.225 159.8c15.119-15.119 40.971-4.411 40.971 16.971V228H228V127.196h-51.23c-21.382 0-32.09-25.851-16.971-40.971l79.196-79.196c9.373-9.373 24.568-9.373 33.941 0l79.196 79.196c15.119 15.119 4.411 40.971-16.971 40.971h-51.162V228h100.804v-51.162c0-21.382 25.851-32.09 40.97-16.971l79.196 79.196c9.373 9.373 9.373 24.569 0 33.941L425.773 352.2c-15.119 15.119-40.971 4.411-40.97-16.971V284H284v100.804h51.23c21.382 0 32.09 25.851 16.971 40.971z\"></path></svg>`\n\nvar svgEdit = `<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"far\" data-icon=\"edit\" class=\"svg-inline--fa fa-edit fa-w-18\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 576 512\"><path fill=\"currentColor\" d=\"M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z\"></path></svg>`\n\nvar svgClone = `<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"far\" data-icon=\"clone\" class=\"svg-inline--fa fa-clone fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M464 0H144c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h320c26.51 0 48-21.49 48-48v-48h48c26.51 0 48-21.49 48-48V48c0-26.51-21.49-48-48-48zM362 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h42v224c0 26.51 21.49 48 48 48h224v42a6 6 0 0 1-6 6zm96-96H150a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h308a6 6 0 0 1 6 6v308a6 6 0 0 1-6 6z\"></path></svg>`\n\nvar svgRemove = `<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"far\" data-icon=\"trash-alt\" class=\"svg-inline--fa fa-trash-alt fa-w-14\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"><path fill=\"currentColor\" d=\"M268 416h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12zM432 80h-82.41l-34-56.7A48 48 0 0 0 274.41 0H173.59a48 48 0 0 0-41.16 23.3L98.41 80H16A16 16 0 0 0 0 96v16a16 16 0 0 0 16 16h16v336a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128h16a16 16 0 0 0 16-16V96a16 16 0 0 0-16-16zM171.84 50.91A6 6 0 0 1 177 48h94a6 6 0 0 1 5.15 2.91L293.61 80H154.39zM368 464H80V128h288zm-212-48h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12z\"></path></svg>`\n\nexport class NodeToolbar extends RXComponent{\n  constructor(){\n    super()\n    this.cssClass('node-toolbar')\n    this.hide()\n\n    this.duplicateBtn = new SvgButton($t('duplicate'), svgClone, 'click', ()=>{\n      if(rxEditor.focusedNode){\n        rxEditor.focusedNode.duplicate(event)\n      }\n    })\n\n    this.pushChild(new SvgButton($t('focus-parent'), svgArrowUp, 'click' , ()=>{\n      if(rxEditor.focusedNode){\n        rxEditor.focusedNode.up(event)\n      }\n    }))\n    this.pushChild(new SvgButton($t('move'), svgMove,'mousedown', (event)=>{\n        if(rxEditor.focusedNode){\n          rxEditor.focusedNode.begindragIcon(event)\n        }\n      })\n      //.cssStyle('cursor', 'move')\n    )\n    this.editButton = new SvgButton($t('edit'), svgEdit,'mousedown', (event)=>{\n      rxEditor.focusedNode.changeToState('editState')\n    })\n\n    this.editButton.domOn('mouseup',(event)=>{\n      //move cusor to end\n      let el = rxEditor.focusedNode.view.$dom\n      let sel = window.getSelection();\n      sel.collapse(el, 1);\n      el.focus();      \n    })\n    this.pushChild(this.editButton)\n    this.pushChild(this.duplicateBtn)\n    this.pushChild(new SvgButton($t('delete'), svgRemove, 'click', ()=>{\n      if(rxEditor.focusedNode){\n        rxEditor.focusedNode.delete(event)\n      }\n    }))\n\n    document.addEventListener('scroll', (event)=>{\n      this.refreshPosition()\n    })\n    window.addEventListener('resize', (event)=>{\n      this.refreshPosition()\n    })\n  }\n\n  refreshPosition(){\n    this.followElement(this.node)\n  }\n\n  show(node){\n    this.node = node\n    if(!node || !node.view.$dom) return\n    this.followElement(node)\n    if(this.node.rule.editable){\n      this.editButton.show()\n    }\n    else{\n      this.editButton.hide()\n    }\n    //if(this.node.forbidDuplicate){\n    //  this.duplicateBtn.hide()\n    //}\n    //else{\n    //  this.duplicateBtn.show()\n    //}\n    return super.show()\n  }\n\n  followElement(node){\n    if(!node || !node.view || !node.view.$dom) return\n    let domElement = node.view.$dom\n    let rect = domElement.getBoundingClientRect()\n    let offsetX = this.node.rule.editable ? 0 : 25\n    if(this.$dom){\n      let x = (rect.x + rect.width - 120)\n      x = x < 0 ? 0 : x\n      this.$dom.style.left = x + offsetX + 'px'\n      if(rect.y < 26){\n        this.$dom.style.top = (rect.y + rect.height) + 'px'\n      }\n      else{\n        this.$dom.style.top = (rect.y - 26) + 'px'\n      }\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/node-toolbar.js","import {RXComponent} from \"../basic/rxcomponent\"\r\n\r\nexport class RxCursor extends RXComponent{\r\n  constructor(){\r\n    super()\r\n    this.cssClass('rx-cursor')\r\n    this.cssClass('out')\r\n    this.hide()\r\n  }\r\n\r\n  hide(){\r\n    this.position = ''\r\n    this.node = null\r\n    super.hide()\r\n  }\r\n  \r\n  show(position, node){\r\n    this.position = position\r\n    this.node = node\r\n    if(!node || !node.view.$dom) return\r\n    this.classClasses()\r\n    this.cssClass('rx-cursor')\r\n    this.cssClass(position)\r\n    this.node = node\r\n    if(position === 'in-top'){\r\n      this.inTop(node)\r\n    }\r\n\r\n    if(position === 'in-right'){\r\n      this.inRight(node)\r\n    }\r\n\r\n    if(position === 'in-bottom'){\r\n      this.inBottom(node)\r\n    }\r\n\r\n    if(position === 'in-left'){\r\n      this.inLeft(node)\r\n    }\r\n\r\n    if(position === 'out-top'){\r\n      this.outTop(node)\r\n    }\r\n\r\n    if(position === 'out-right'){\r\n      this.outRight(node)\r\n    }\r\n\r\n    if(position === 'out-bottom'){\r\n      this.outBottom(node)\r\n    }\r\n\r\n    if(position === 'out-left'){\r\n      this.outLeft(node)\r\n    }\r\n\r\n    if(position === 'char-left'){\r\n      this.charLeft(node)\r\n    }\r\n\r\n    if(position === 'char-right'){\r\n      this.charRight(node)\r\n    }\r\n\r\n    return super.show()\r\n  }\r\n\r\n  outTop(node){\r\n    let domElement = node.view.$dom\r\n    let rect = domElement.getBoundingClientRect()\r\n    if(this.$dom){\r\n      this.$dom.style.left = rect.left + 'px'\r\n      this.$dom.style.top = (rect.top - 2) + 'px'\r\n      this.$dom.style.width = rect.width + 'px'\r\n      this.$dom.style.height = '4px'\r\n    }\r\n  }\r\n\r\n  outRight(node){\r\n    let domElement = node.view.$dom\r\n    let rect = domElement.getBoundingClientRect()\r\n    if(this.$dom){\r\n      this.$dom.style.left = (rect.right -2) + 'px'\r\n      this.$dom.style.right = \"auto\"\r\n      this.$dom.style.top = rect.top + 'px'\r\n      this.$dom.style.width = '4px'\r\n      this.$dom.style.height = rect.height + 'px'\r\n    }\r\n  }\r\n\r\n  outBottom(node){\r\n    let domElement = node.view.$dom\r\n    let rect = domElement.getBoundingClientRect()\r\n    if(this.$dom){\r\n      this.$dom.style.left = rect.x + 'px'\r\n      this.$dom.style.top = (rect.bottom - 2) + 'px'\r\n      this.$dom.style.bottom = 'auto'\r\n      this.$dom.style.width = rect.width + 'px'\r\n      this.$dom.style.height = '4px'\r\n    }\r\n  }\r\n\r\n  outLeft(node){\r\n    let domElement = node.view.$dom\r\n    let rect = domElement.getBoundingClientRect()\r\n    if(this.$dom){\r\n      this.$dom.style.left = (rect.left - 2) + 'px'\r\n      this.$dom.style.right = 'auto'\r\n      this.$dom.style.top = rect.top + 'px'\r\n      this.$dom.style.width = '4px'\r\n      this.$dom.style.height = rect.height + 'px'\r\n    }\r\n  }\r\n\r\n  charRight(node){\r\n    let domElement = node.view.$dom\r\n    let rect = domElement.getBoundingClientRect()\r\n    if(this.$dom){\r\n      this.$dom.style.left = (rect.right -2) + 'px'\r\n      this.$dom.style.right = \"auto\"\r\n      this.$dom.style.top = rect.top + 'px'\r\n      this.$dom.style.width = '4px'\r\n      this.$dom.style.height = rect.height + 'px'\r\n    }\r\n  }\r\n\r\n  charLeft(node){\r\n    let domElement = node.view.$dom\r\n    let rect = domElement.getBoundingClientRect()\r\n    if(this.$dom){\r\n      this.$dom.style.left = (rect.left - 2) + 'px'\r\n      this.$dom.style.right = 'auto'\r\n      this.$dom.style.top = rect.top + 'px'\r\n      this.$dom.style.width = '4px'\r\n      this.$dom.style.height = rect.height + 'px'\r\n    }\r\n  }\r\n\r\n/**/\r\n  inTop(node){\r\n    let domElement = node.view.$dom\r\n    let rect = domElement.getBoundingClientRect()\r\n    if(this.$dom){\r\n      this.$dom.style.left = rect.left + 'px'\r\n      this.$dom.style.top = (rect.top + 1) + 'px'\r\n      this.$dom.style.width = rect.width + 'px'\r\n      this.$dom.style.height = '4px'\r\n    }\r\n  }\r\n\r\n  inRight(node){\r\n    let domElement = node.view.$dom\r\n    let rect = domElement.getBoundingClientRect()\r\n    if(this.$dom){\r\n      this.$dom.style.left = (rect.right -4) + 'px'\r\n      this.$dom.style.right = \"auto\"\r\n      this.$dom.style.top = rect.top + 'px'\r\n      this.$dom.style.width = '4px'\r\n      this.$dom.style.height = rect.height + 'px'\r\n    }\r\n  }\r\n\r\n  inBottom(node){\r\n    let domElement = node.view.$dom\r\n    let rect = domElement.getBoundingClientRect()\r\n    if(this.$dom){\r\n      this.$dom.style.left = rect.x + 'px'\r\n      this.$dom.style.top = (rect.bottom - 4) + 'px'\r\n      this.$dom.style.bottom = 'auto'\r\n      this.$dom.style.width = rect.width + 'px'\r\n      this.$dom.style.height = '4px'\r\n    }\r\n  }\r\n\r\n  inLeft(node){\r\n    let domElement = node.view.$dom\r\n    let rect = domElement.getBoundingClientRect()\r\n    if(this.$dom){\r\n      this.$dom.style.left = rect.left + 'px'\r\n      this.$dom.style.right = 'auto'\r\n      this.$dom.style.top = rect.top + 'px'\r\n      this.$dom.style.width = '4px'\r\n      this.$dom.style.height = rect.height + 'px'\r\n    }\r\n  }\r\n\r\n  followElement(node){\r\n    let domElement = node.view.$dom\r\n    let rect = domElement.getBoundingClientRect()\r\n    if(this.$dom){\r\n      this.$dom.style.left = rect.x + 'px'\r\n      this.$dom.style.top = rect.height/2 + 'px'\r\n      //if(rect.y < 20){\r\n      //  this.$dom.style.top = (rect.y + rect.height) + 'px'\r\n      //}\r\n      //else{\r\n      //  this.$dom.style.top = (rect.y - 15 - offset) + 'px'\r\n      //}\r\n\r\n      this.$dom.style.width = rect.width + 'px'\r\n    }\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/rx-cursor.js","import {RXComponent} from \"../basic/rxcomponent\"\r\n\r\nexport class MouseFollower extends RXComponent{\r\n  constructor(){\r\n    super()\r\n    this.cssClass('mouse-follower')\r\n    this.hide()\r\n  }\r\n\r\n  active(text){\r\n    super.setInnerHTML(text)\r\n    this.isActived = true\r\n  }\r\n\r\n  hide(){\r\n    this.isActived = false\r\n    super.hide()\r\n  }\r\n\r\n  followMouse(event){\r\n    this.$dom.style.left =  event.clientX\r\n    this.$dom.style.top =  event.clientY\r\n    super.show()\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/mouse-follower.js","import {RXComponent} from \"../basic/rxcomponent\"\nimport {ObjectState} from \"../basic/object-state\"\n\nclass EditorState extends ObjectState{\n  constructor(){\n    super()\n    this.__bold = false\n    this.__italic = false\n    this.__underline = false\n    this.__strikeThrough = false\n    this.__isLink = false\n  }\n\n  get bold(){\n    return this.__bold\n  }\n\n  set bold(bold){\n    if(this.__bold == bold){return} \n    this.__bold = bold\n    this.distributeEvent('bold')\n  }\n\n  get italic(){\n    return this.__italic\n  }\n\n  set italic(italic){\n    if(this.__italic == italic){return} \n    this.__italic = italic\n    this.distributeEvent('italic')\n  }\n\n  get underline(){\n    return this.__underline\n  }\n\n  set underline(underline){\n    if(this.__underline == underline){return} \n    this.__underline = underline\n    this.distributeEvent('underline')\n  }\n  get strikeThrough(){\n    return this.__strikeThrough\n  }\n\n  set strikeThrough(strikeThrough){\n    if(this.__strikeThrough == strikeThrough){return} \n    this.__strikeThrough = strikeThrough\n    this.distributeEvent('strikeThrough')\n  }\n\n  get isLink(){\n    return this.__isLink\n  }\n\n  set isLink(isLink){\n    if(this.__isLink == isLink){return} \n    this.__isLink = isLink\n    this.distributeEvent('isLink')\n  }\n\n}\n\nclass BarButton extends RXComponent{\n  constructor(title, callback){\n    super()\n    this.cssClass('mini-button')\n    this.domAttr('title', title)  \n    this.domOn('click', callback)\n  }  \n}\n\nconst isLink = () => {\n  if (window.getSelection().toString !== '') {\n    let selection = window.getSelection()\n    selection = selection.rangeCount > 0 ? selection.getRangeAt(0) :''\n    if (selection) {\n      if (selection.startContainer.parentNode.tagName === 'A'\n      || selection.endContainer.parentNode.tagName === 'A') {\n        return true\n      } else { return false }\n    } else { return false }\n  }\n}\n\n\nexport class MiniEditbar extends RXComponent{\n  constructor(){\n    super()\n    this.cssClass('mini-editbar')\n    this.hide()\n    this.state = new EditorState\n\n    this.domOn('mousedown', (event)=>{\n      event.preventDefault()\n    })\n  \n    let boldBtn = new BarButton('Bold', ()=>{\n        document.execCommand('bold', false, null)\n        this.updateButtonsState()\n      })\n      .cssClass('icon-button')\n      .setInnerHTML('<b>B</b>')\n\n    this.pushChild(boldBtn)\n\n    let italicBtn = new BarButton('Italic', ()=>{\n        document.execCommand('italic', false, null)\n        this.state.italic = !this.state.italic\n      })\n      .cssClass('icon-button')\n      .setInnerHTML('<i>I</i>')\n    this.pushChild( italicBtn )\n\n    let underlineBtn = new BarButton('Underline', ()=>{\n        document.execCommand('underline', false, null)\n        this.updateButtonsState()\n      })\n      .cssClass('icon-button')\n      .setInnerHTML('<u>U</u>')\n    this.pushChild( underlineBtn )\n\n    let strikeBtn = new BarButton('Strike', ()=>{\n        document.execCommand('strikeThrough', false, null)\n        this.updateButtonsState()\n      })\n      .cssClass('icon-button')\n      .setInnerHTML('<strike>S</strike>')\n    this.pushChild( strikeBtn )\n\n    let linkBtn = new BarButton('Link', ()=>{\n        if(this.state.isLink){\n          document.execCommand('unlink', false, null)\n        }\n        else{\n          document.execCommand('createLink', false, '#')\n        }\n        this.updateButtonsState()\n      })\n      .cssClass('icon-button')\n      .setInnerHTML('<div style=\"transform:rotate(45deg)\">⫘</div>')\n    this.pushChild( linkBtn )\n\n    document.onpaste = (event)=>{\n      let plainText  =  event.clipboardData.getData('text/plain').replace(/[\\r\\n]/g,\"<br>\")\n      document.execCommand('insertHTML', false, plainText)\n      return false\n    }\n\n    document.addEventListener('keydown',(event)=>{\n      if (event.keyCode === 13) {\n        document.execCommand('insertHTML', false, '<br>')\n        event.preventDefault()\n        return false\n      }\n    })\n\n    /*let codeBtn = new BarButton('Switch Code Editor', ()=>{\n        this.updateButtonsState()\n      })\n      .cssClass('icon-button')\n      .setInnerHTML('<div\"><></div>')\n    this.pushChild( codeBtn )\n    let btnInsert = new BarButton('Bootstrap Styles', ()=>{\n      })\n      .cssClass('mini-styles')\n      .setInnerHTML('Insert <span>▾</span>')\n    this.pushChild( btnInsert )*/\n\n    this.watchOne('bold', boldBtn)\n    this.watchOne('italic', italicBtn)\n    this.watchOne('underline', underlineBtn)\n    this.watchOne('strikeThrough', strikeBtn)\n    this.watchOne('isLink', linkBtn)    \n    document.addEventListener('scroll', (event)=>{\n      this.followElement(this.domElement)\n    })\n    window.addEventListener('resize', (event)=>{\n      this.followElement(this.domElement)\n    })\n  }\n\n  watchOne(stateName, btn){\n    this.state.watch(stateName, ()=>{\n      if(this.state[stateName]){\n        btn.cssClass('active')\n      }\n      else{\n        btn.removeCssClass('active')\n      }\n    })\n  }\n\n  show(followElement){\n    if(!followElement) return\n    this.followElement(followElement)\n    this.updateButtonsState()\n    document.addEventListener(\"selectionchange\", (event)=>{\n      this.updateButtonsState()\n    })\n    return super.show()\n  }\n\n  hide(){\n    document.removeEventListener(\"selectionchange\", (event)=>{\n      this.updateButtonsState()\n    })\n    return super.hide()\n  }\n\n\n  updateButtonsState(){\n    if(!this.isShow()){\n      return\n    }\n    this.state.bold = document.queryCommandState('bold')\n    this.state.italic = document.queryCommandState('italic')\n    this.state.underline = document.queryCommandState('underline')\n    this.state.strikeThrough = document.queryCommandState('strikeThrough')\n    this.state.isLink = isLink()\n  }\n\n  followElement(domElement){\n    if(!domElement) return\n    this.domElement = domElement\n    let rect = domElement.getBoundingClientRect()\n    let height = 32\n    if(this.$dom){\n      this.$dom.style.left = (rect.x -1)  + 'px'\n      if(rect.y < height){\n        this.$dom.style.top = (rect.y + rect.height) + 'px'\n      }\n      else{\n        this.$dom.style.top = (rect.y - height) + 'px'\n      }\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/mini-editbar.js","import {ClassNode} from './nodes/class-node.js'\r\nimport {TagNode} from './nodes/tag-node.js'\r\nimport {TextNode} from './nodes/text-node.js'\r\nimport rules from './rules'\r\nimport commonRule from'./rules/common-rule'\r\n\r\nexport class NodeParser{\r\n  constructor() {\r\n    this.$dom = document.createElement('div')\r\n  }\r\n\r\n  parse(html){\r\n    this.$dom.innerHTML = html\r\n\r\n    //console.log(this.$dom.childNodes)\r\n    let nodes = []\r\n    for(var i = 0; i < this.$dom.childNodes.length; i++){\r\n        let node = this.paraseNode(this.$dom.childNodes[i])\r\n        if(node){\r\n          nodes.push(node)\r\n        }\r\n    }\r\n    return nodes\r\n  }\r\n\r\n  paraseNode(element, parent){\r\n    var node \r\n    if(element.nodeType === 3){\r\n      let text = element.textContent//.trim()\r\n      if(!text){\r\n        return ''\r\n      }\r\n      let node =  new TextNode(text)\r\n      node.parent = parent\r\n      return node \r\n    }\r\n\r\n    //暂不处理注释\r\n    if(element.nodeType === 8){\r\n      return ''\r\n    }\r\n\r\n    if(element.classList.contains('container')){\r\n      node = new ClassNode('container')\r\n    }\r\n\r\n    let clssNode = this.parseClassNode(element)\r\n    node = clssNode ? clssNode : this.parseTagNode(element)\r\n\r\n    this.copyClassList(element.classList, node.meta.classList)\r\n    for(var i = 0; i < element.childNodes.length; i++){\r\n      let child = element.childNodes[i]\r\n\r\n      let childNode = this.paraseNode(child, node)\r\n      if(childNode){\r\n        node.children.push(childNode)\r\n      }\r\n    }\r\n\r\n    this.parseAttributes(node, element)\r\n    node.markDefaultMeta()\r\n\r\n    node.parent = parent\r\n\r\n    return node\r\n  }\r\n\r\n  parseAttributes(node, element){\r\n    let attrs = element.attributes;\r\n     for(var i = 0; i < attrs.length; i++){\r\n      let attrName = attrs[i]['nodeName'];\r\n      let attrValue = attrs[i]['nodeValue'];\r\n      if(attrName.toLowerCase() !== \"class\"){\r\n        node.meta.attributes[attrName] = attrValue\r\n      }\r\n    }\r\n  }\r\n\r\n  parseClassNode(element){\r\n    for(var ruleName in rules.classRules){\r\n      let rule = rules.classRules[ruleName]\r\n      rule.classes = rule.classes ? rule.classes : [ruleName]\r\n\r\n      for(var i = 0; i < rule.classes.length; i++){\r\n        let cssClass = rule.classes[i].toLowerCase()\r\n        if(element.classList.contains(cssClass)){\r\n          let node = new ClassNode(cssClass)\r\n          node.meta.tag = element.tagName.toLowerCase()\r\n          node.setLabel(rule.label ? rule.label : ruleName)\r\n          node.ruleName = ruleName\r\n          node.rule = rule\r\n          return node\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  parseTagNode(element){\r\n    var node\r\n    let elTag = element.tagName.toLowerCase()\r\n    for(var ruleName in rules.tagRules){\r\n      let rule = rules.tagRules[ruleName]\r\n      rule.tags = rule.tags ? rule.tags : [ruleName]\r\n      for(var i = 0; i < rule.tags.length; i++){\r\n        let tag = rule.tags[i]\r\n        if(elTag === tag.toLowerCase()){\r\n          node = new TagNode(tag)\r\n          node.setLabel(rule.label ? rule.label : ruleName)\r\n          node.ruleName = ruleName\r\n          node.rule = rule\r\n          return node\r\n        }\r\n      }\r\n    }\r\n    node = new TagNode(elTag)\r\n    node.ruleName = elTag\r\n    node.rule = Object.assign({}, commonRule)\r\n    return node\r\n  }\r\n\r\n  copyClassList(from, to){\r\n    from.forEach(cssClass=>{\r\n      if(cssClass.indexOf('rx-_-') !== 0){\r\n        to.push(cssClass)\r\n      }\r\n    })\r\n  }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/node-parser.js","import {RXNode} from './rxnode.js'\r\nimport {add, remove} from \"../../basic/rxarray\"\r\n\r\nexport class ClassNode extends RXNode{\r\n  constructor(cssClass) {\r\n    super()\r\n      //add(cssClass, this.meta.classList)\r\n      this.cssClass = cssClass\r\n  }\r\n\r\n\r\n  make(){\r\n    return new ClassNode(this.cssClass)\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/nodes/class-node.js","import {Node} from '../node.js'\r\nimport {add, remove} from \"../../basic/rxarray\"\r\n\r\nexport class CharNode extends Node{\r\n  constructor(char, parent) {\r\n    super()\r\n    this.parent = parent\r\n    this.char = char\r\n    this.isCharNode = true;\r\n    this.rule = {}\r\n    this.rule.acceptedChildren = []\r\n    this.rule.editMarginStyle = {}\r\n    this.rule.dropInMargin = 5;\r\n  }\r\n\r\n  make(){\r\n    return new CharNode\r\n  }\r\n\r\n  changeTextnodeToCharNode(){\r\n  }\r\n\r\n  toViewModel(){\r\n    return {\r\n      styles:{},\r\n      classList:['char-node'],\r\n      attributes:{},\r\n      innerHTML : this.char,\r\n      tag:'span',\r\n      on:{\r\n        onmousemove:this.mousemove,\r\n        onmouseover:this.mouseover,\r\n        onmouseout:this.mouseout,\r\n        //onclick:this.onclick,\r\n      }\r\n    }\r\n  }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/nodes/char-node.js","import {RXNode} from './rxnode.js'\r\n\r\nexport class TagNode extends RXNode{\r\n  constructor(tag) {\r\n    super()\r\n    this.meta.tag = tag\r\n    this.label = tag\r\n    this.labelToCapitalize()\r\n\t}\r\n\r\n  make(){\r\n  \tlet node = new TagNode(this.meta.tag)\r\n  \tnode.label = this.label\r\n  \treturn node\r\n  }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/nodes/tag-node.js","import container from \"./container\"\r\nimport row from \"./row\"\r\nimport col from \"./col\"\r\nimport heading from \"./heading\"\r\nimport commonRule from \"./common-rule\"\r\n\r\n//ruleName:\r\n// -container\r\n// -row\r\n// -col\r\n// -heading\r\n\r\n//用于判断的规则token， 全部小写，不接受大写\r\n//Label为空，表示label使用类名字\r\n//- label:''\r\n//空表示所有都接受，空数组表示都不接受\r\n//- acceptedChildren : '',\r\n//空和空数组都表示所有都不排除\r\n//- rejectChildren : '',\r\n//在这个边界内算是拖入内部\r\n//  '--responsive--' 需要根据屏幕大小被替换成 '','-sm', '-md', '-lg', '-xl'\r\n//classes 为空表示单一类命，跟ID一致\r\n//tags 为空表示tag，跟ID一致\r\n\r\nexport default{\r\n  classRules : {\r\n    \"container\": container,\r\n    \"row\": row,\r\n    \"col\": col,\r\n    \"w-100\": Object.assign({}, commonRule),\r\n    \"alert\" : Object.assign({}, commonRule),\r\n  },\r\n\r\n  tagRules : {\r\n    heading: heading\r\n  },\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/rules/index.js","export default {\r\n  dropInMargin : 10,\r\n  editable: false,\r\n  editMarginStyle : {\r\n    paddingX:'30px',\r\n    paddingY:'30px',\r\n  },\r\n  //没有子元素，显示空白\r\n  empertyMargin:true,\r\n\r\n  rejectChildren : ['col','thead', 'tbody', \r\n                           'th', 'tr', 'td']\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/rules/container.js","export default{\r\n  dropInMargin : 10,\r\n  editable: false,\r\n  editMarginStyle : {\r\n    paddingX:'20px',\r\n    paddingY:'20px',\r\n  },\r\n  //没有子元素，显示空白\r\n  empertyMargin:true,\r\n  acceptChildren : ['col','w-100']\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/rules/row.js","export default{\r\n  label:'column',\r\n  dropInMargin : 10,\r\n  editable: true,\r\n  editMarginStyle : {\r\n    paddingX:'20px',\r\n    paddingY:'20px',\r\n  },\r\n  //没有子元素，显示空白\r\n  empertyMargin:true,\r\n  classes:[\r\n    'col', \r\n    'col-1','col-2','col-3', 'col-4', 'col-5', 'col-6', \r\n    'col-7', 'col-8','col-9','col-10','col-11','col-12',\r\n    'col-sm', \r\n    'col-sm-1','col-sm-2','col-sm-3', 'col-sm-4', 'col-sm-5', 'col-sm-6', \r\n    'col-sm-7', 'col-sm-8','col-sm-9','col-sm-10','col-sm-11','col-sm-12',\r\n    'col-md', \r\n    'col-md-1','col-md-2','col-md-3', 'col-md-4', 'col-md-5', 'col-md-6', \r\n    'col-md-7', 'col-md-8','col-md-9','col-md-10','col-md-11','col-md-12',\r\n    'col-lg', \r\n    'col-lg-1','col-lg-2','col-lg-3', 'col-lg-4', 'col-lg-5', 'col-lg-6', \r\n    'col-lg-7', 'col-lg-8','col-lg-9','col-lg-10','col-lg-11','col-lg-12',\r\n    'col-xl', \r\n    'col-xl-1','col-xl-2','col-xl-3', 'col-xl-4', 'col-xl-5', 'col-xl-6', \r\n    'col-xl-7', 'col-xl-8','col-xl-9','col-xl-10','col-xl-11','col-xl-12',\r\n  ],\r\n  rejectChildren : ['col','thead', 'tbody', \r\n                           'th', 'tr', 'td']\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/rules/col.js","export default{\r\n  label:\"Heading\",\r\n  tags:['h1', 'h2', 'h3', 'h4', 'h5', 'h6'],\r\n  editable: true,\r\n  editMarginStyle : {\r\n    paddingX:'5px',\r\n    paddingY:'5px',\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/rules/heading.js","import {NodeView} from \"./node-view\"\nimport {add, remove, first, last, insertBefore,insertAfter, contains, after, before} from \"../basic/rxarray\"\nimport {NormalState, ActiveState, FocusState, DragoverState, DisableState, DraggedState, EditState, PreviewState} from \"./node-state\"\n\nfunction insterAfterDom(newElement,targetElement){\n  var parent = targetElement.parentNode;\n  if(parent.lastChild == targetElement){\n    parent.appendChild(newElement);\n  }\n  else{\n    parent.insertBefore(newElement,targetElement.nextSibling);\n  }              \n}\n\nexport class Node{\n  constructor() {\n    this.seedId()\n    //this.mouseFollowerWidth =  '200px'\n  \tthis.children = []\n  \tthis.view = new NodeView()\n\n    //基础数据，持久化也是这部分数据\n    this.meta = {\n      tag : 'div',\n      classList : [],\n      styles : {},\n      attributes : {},\n    }\n\n    this.defaultMeta = {\n      tag : 'div',\n      classList : [],\n      styles : {},\n      attributes : {},\n    }\n    \n    this.initStates()\n\n    this.mouseFollower = {\n      offsetX:10,\n      offsetY:0\n    }\n\n    this.begindrag = (event)=>{\n      event.stopPropagation()\n      this.state.onBegindrag(event)\n    }\n\n    this.begindragLabel = (event)=>{\n      if(this.view.$dom){\n        this.mouseFollower.offsetX = event.offsetX\n        this.mouseFollower.offsetY = -18 + event.offsetY\n      }\n      this.begindrag(event)\n    }\n\n    this.begindragIcon = (event)=>{\n      if(this.view.$dom){\n        this.mouseFollower.offsetX = this.view.$dom.clientWidth - 96 + event.offsetX\n        this.mouseFollower.offsetY = -24 + event.offsetY\n      }\n      this.begindrag(event)\n    }\n\n    this.mousemove = (event)=>{\n      event.stopPropagation()\n      this.state.onMousemove(event)\n      rxEditor.canvasMouseMove(event)\n    }\n    this.mouseover = (event)=>{\n      event.stopPropagation()\n      this.state.onMouseover(event)\n    }\n    this.mouseout = (event)=>{\n      event.stopPropagation()\n      this.state.onMouseout(event)\n    }\n\n    this.onclick = (event)=>{\n      event.stopPropagation()\n      this.state.onClick(event)\n    }\n\n    this.duplicate = ()=>{\n      this.changeToState('normalState')\n      rxEditor.commandManager.duplicate(this)\n      rxEditor.render()\n    }\n\n    this.up = (event)=>{\n      if(this.parent){\n        this.changeToState('normalState')\n        this.parent.changeToState('focusState')\n        event.stopPropagation()\n      }\n    }\n\n    this.delete =()=>{\n      //if(confirm(\"Are you sure to delete?\")){\n        this.changeToState('normalState')\n        rxEditor.commandManager.deleteNode(this)\n        rxEditor.render()\n      //}\n    }\n\n    this.stateChanged = (oldState, newState)=>{\n      oldState.leave()\n      newState.enter()\n      rxEditor.nodeStateChanged(this, oldState, newState)\n    }\n\n  }\n\n  seedId(){\n    if(!Node.idSeed) Node.idSeed = 1\n    Node.idSeed ++\n    this.id = Node.idSeed\n  }\n\n  initStates(){\n    this.normalState = new NormalState(this)\n    this.activeState = new ActiveState(this)\n    this.focusState = new FocusState(this)\n    this.dragoverState = new DragoverState(this)\n    this.draggedState = new DraggedState(this)\n    this.disableState = new DisableState(this)\n    this.editState = new EditState(this)\n    this.previewState = new PreviewState(this)\n    this.state = this.normalState\n  }\n\n  markDefaultMeta(){\n    this.defaultMeta.tag = this.meta.tag\n    this.defaultMeta.classList = this.meta.classList.concat()\n    this.defaultMeta.attributes = Object.assign({}, this.meta.attributes) \n    this.defaultMeta.styles = Object.assign({}, this.meta.styles) \n  }\n\n  changeToState(stateName){\n    if(this.state === this[stateName]) return\n    let oldState = this.state\n    this.state = this[stateName]\n    this.refreshState()\n    this.stateChanged(oldState, this[stateName])\n  }\n\n  render(){\n    this.view.render(this.toViewModel(), this.getParentViewDomElement())\n    this.children.forEach(function(child){  \n      child.render()\n    })\n  }\n\n  renderHtml(parentDomElement){\n    let dom = this.view.renderHtml(this.toHtmlModel(), parentDomElement)\n    this.children.forEach((child)=>{  \n      child.renderHtml(dom)\n    })\n\n    parentDomElement.appendChild(dom)\n    return dom\n  }\n\n  refreshState(){\n    this.view.refreshState(this.toViewModel())\n    this.children.forEach(function(child){  \n      child.refreshState()\n    })\n  }\n\n  clearDraggedoverStates(){\n    if(this.state === this.dragoverState){\n      this.changeToState('normalState')\n    }\n    this.children.forEach(function(child){  \n      child.clearDraggedoverStates()\n    })\n  }\n\n  clearActiveStates(){\n    if(this.state === this.activeState){\n      this.changeToState('normalState')\n    }\n    this.children.forEach(function(child){  \n      child.clearActiveStates()\n    })\n  }\n\n  clearFocusAndEditStates(){\n    if(this.state === this.focusState || this.state === this.editState){\n      this.changeToState('normalState')\n    }\n    this.children.forEach(function(child){  \n      child.clearFocusAndEditStates()\n    })\n  }\n\n  allToNormalState(){\n    this.changeToState('normalState')\n    this.children.forEach((child)=>{  \n      child.allToNormalState()\n    })\n  }\n\n  draggedToFoused(){\n    if(this.state === this.draggedState){\n      this.changeToState('focusState')\n    }\n    this.children.forEach(function(child){  \n      child.draggedToFoused()\n    })\n  }\n\n  getParentViewDomElement(){\n    return this.parent.view.$dom\n  }\n\n  firstChild(){\n    return first(this.children)\n  }\n\n  nextSbiling(){\n    if(this.parent){\n      return after(this, this.parent.children) \n    }\n  }\n\n  previousSbiling(){\n    if(this.parent){\n      return before(this, this.parent.children) \n    }\n  }\n\n  moveInTop(targetParent){\n    if(first(targetParent.children) !== this){\n      this.removeFromParent()\n      targetParent.unshiftChild(this)\n      targetParent.render()\n    }\n  }\n\n  moveIn(targetParent){\n    if(last(targetParent.children) !== this){\n      this.removeFromParent()\n      targetParent.pushChild(this)\n      targetParent.render()\n    }\n  }\n\n  moveBefore(brother){\n    if(before(brother, this.children) !== this){\n      this.removeFromParent()\n      this.parent = brother.parent\n      insertBefore(this, brother, brother.parent.children);\n      this.parent.render()\n    }\n  }\n\n  moveAfter(brother){\n    if(after(brother, this.children) !== this){\n      this.removeFromParent()\n      this.parent = brother.parent\n      insertAfter(this, brother, brother.parent.children);\n      this.parent.render()\n    }\n  }\n\n  removeFromParent(){\n    if(this.parent){\n      remove(this, this.parent.children)\n      this.parent.render()\n    }\n  }\n\n  unshiftChild(child){\n    child.parent = this\n    this.children.unshift(child) \n    return this\n  }\n\n  pushChild(child){\n    child.parent = this\n    add(child, this.children) \n    return this\n  }\n\n  insertAfterSelf(brother){\n    brother.parent = this.parent\n    insertAfter(brother, this, this.parent.children);\n    return this\n  }\n\n  clone(){\n    let copy = this.make()\n    // /console.log(copy)\n    copy.rule = JSON.parse(JSON.stringify(this.rule))\n    copy.ruleName = this.ruleName\n    this.children.forEach((child)=>{  \n      copy.pushChild(child.clone())\n    })\n    return copy\n  }\n\n  canAccept(child){\n    let acceptedChildren = this.rule ? this.rule.acceptedChildren : ''\n    if(acceptedChildren  && acceptedChildren.length == 0){\n      return false\n    }\n\n    if(acceptedChildren && !this.containsInAccepted(child)){\n      return false\n    }\n\n    if(!acceptedChildren && this.containsInExcept(child)){\n      return false\n    }\n    return true\n  }\n\n\n  containsInAccepted(child){\n    let childRuleName = child.ruleName\n    let acceptedChildren = this.rule ? this.rule.acceptedChildren : ''\n    for(var i = 0; i < acceptedChildren.length; i++){\n      if(acceptedChildren[i] === childRuleName){\n        return true\n      }\n    }\n\n    return false\n  }\n\n  containsInExcept(child){\n    let childRuleName = child.ruleName\n    let rejectChildren = this.rule ? this.rule.rejectChildren : ''\n    if(rejectChildren){\n      for(var i = 0; i < rejectChildren.length; i++){\n        if(rejectChildren[i] === childRuleName){\n          return true\n        }\n      }\n    }\n\n    return false    \n  }\n\n  toViewModel(){\n    let model = this.state.stateModel()\n\n    model.on = {\n      onmousemove:this.mousemove,\n      onmouseover:this.mouseover,\n      onmouseout:this.mouseout,\n      //onmouseup:this.mouseup,\n      onclick:this.onclick,\n    }\n\n    return model\n  }\n\n  toHtmlModel(){\n    return {      \n      styles:{},\n      classList:[],//new RXArray,\n      attributes:{},\n    }\n  }\n\n  toTreeViewNode(){\n    let view = {\n      label: this.label,\n      tag:this.meta.tag,\n      id: this.id,\n      state:this.getStateName(),\n      children: [],\n    }\n\n    this.children.forEach((child)=>{\n      let childView = child.toTreeViewNode()\n      if(childView){\n        view.children.push(childView)\n      }\n    })\n\n    return view\n  }\n\n  getStateName(){\n    if(this.state === this.normalState){\n      return 'normalState'\n    }\n    if(this.state === this.activeState){\n      return 'activeState'\n    }\n    if(this.state === this.focusState){\n      return 'focusState'\n    }\n    if(this.state === this.dragoverState){\n      return 'dragoverState'\n    }\n    if(this.state === this.draggedState){\n      return 'draggedState'\n    }\n    if(this.state === this.disableState){\n      return 'disableState'\n    }\n  }\n\n  nodeChanged(node){\n    if(this.id === node.id){\n      rxEditor.commandManager.changeNode(this, node)\n      return;\n    }\n\n    this.children.forEach((child)=>{\n      child.nodeChanged(node)\n    })\n  }\n\n  focusNode(node){\n    if(node.id === this.id){\n      this.changeToState('focusState')\n    }\n    else{\n      this.changeToState('normalState')\n    }\n    this.children.forEach((child)=>{\n      child.focusNode(node)\n    })\n  }\n\n  clearCharNodes(){\n    this.children.forEach(child=>{\n      child.clearCharNodes()\n    })\n  }\n\n  getNodeById(id){\n    if(id === this.id){\n      return this\n    }\n\n    for(var i in this.children){\n      let node = this.children[i].getNodeById(id)\n      if(node){\n        return node\n      }\n    }\n  }\n\n  preview(){\n    this.changeToState('previewState')\n    this.children.forEach(child=>{\n      child.preview()\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/node.js","export function first(array){\r\n  if(array.length > 0){\r\n    return array[0]\r\n  }\r\n}\r\n\r\nexport function last(array){\r\n  if(array.length > 0){\r\n    return array[array.length - 1]\r\n  }\r\n}\r\n\r\nexport function before(refence, array){\r\n  for(var i = 0; i < array.length; i++){\r\n    if(array[i] === refence && i > 0){\r\n      return array[i - 1];\r\n    }\r\n  }\r\n}\r\n\r\nexport function after(refence, array){\r\n  for(var i = 0; i < array.length; i++){\r\n    if(array[i] === refence && i < array.length){\r\n      return array[i + 1];\r\n    }\r\n  }\r\n}\r\n\r\n\r\nexport function insertBefore(child, refence, array){\r\n  for(var i = 0; i < array.length; i++){\r\n    if(array[i] === refence){\r\n      array.splice(i, 0, child)\r\n      return;\r\n    }\r\n  }\r\n\r\n  array.push(child)\r\n}\r\n\r\nexport function insertAfter(child, refence, array){\r\n  for(var i = 0; i < array.length; i++){\r\n    if(array[i] === refence){\r\n      array.splice(i + 1, 0, child)\r\n      return\r\n    }\r\n  }\r\n}\r\n\r\nexport function remove(node, array){\r\n  for (var i = 0; i < array.length; i++) {\r\n    if(array[i] === node){\r\n      array.splice(i, 1)\r\n      break\r\n    }\r\n  }\r\n}\r\n\r\nexport function add(node, array){\r\n  if(!contains(node, array)){\r\n    array.push(node)\r\n  }\r\n}\r\n\r\nexport function contains(node, array){\r\n  for (var i = 0; i < array.length; i++) {\r\n    if(array[i] === node){\r\n      return true\r\n    }\r\n  }\r\n\r\n  return false\r\n}\r\n\r\nexport function tongleOnCondition(condition, node, array){\r\n  if(condition){\r\n    add(node, array)\r\n  }\r\n  else{\r\n    remove(node, array)\r\n  }\r\n}\r\n\r\nexport function clear(array){\r\n  array.length = 0\r\n}\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/basic/rxarray.js","import {contains, remove} from \"./rxarray\"\r\n\r\nexport class ObjectState{\r\n  constructor(){\r\n    this.envetHandlers = {}\r\n  }\r\n\r\n  watch(attribute, callbackFunction){\r\n    if(!this.envetHandlers[attribute]){\r\n      this.envetHandlers[attribute] = []\r\n    }\r\n    if(!contains(callbackFunction, this.envetHandlers[attribute])){\r\n      this.envetHandlers[attribute].push(callbackFunction)\r\n    }\r\n  }\r\n\r\n  cancelWatch(attribute, callbackFunction){\r\n    console.assert(this.envetHandlers[attribute], 'EditorState: did not register this event handler')\r\n    remove(callbackFunction, this.envetHandlers[attribute])\r\n  }\r\n\r\n  distributeEvent(attribute){\r\n    this.distributeEventWithoutGlobal(attribute)\r\n    this.distributeEventWithoutGlobal('changed')//全局事件\r\n  }\r\n\r\n  distributeEventWithoutGlobal(attribute){\r\n    let handlers = this.envetHandlers[attribute];\r\n    if(handlers){\r\n      handlers.forEach((handler)=>{\r\n        handler(this)\r\n      })\r\n    }\r\n  }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/basic/object-state.js"],"sourceRoot":""}